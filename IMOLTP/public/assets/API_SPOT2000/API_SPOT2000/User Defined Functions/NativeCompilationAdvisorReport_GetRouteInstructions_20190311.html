<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [API_SPOT2000].[GetRouteInstructions]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [API_SPOT2000].[GetRouteInstructions]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>3/11/2019 10:33 AM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE EntryTypeID WHEN 'CI' THEN EntryText END</td>
        <td>7</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'PL' THEN EntryText END</td>
        <td>8</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'PI' THEN EntryText END</td>
        <td>9</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'PA' THEN EntryText END</td>
        <td>10</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'DL' THEN EntryText END</td>
        <td>11</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'DI' THEN EntryText END</td>
        <td>12</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'DA' THEN EntryText END</td>
        <td>13</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'CI' THEN EntryText END</td>
        <td>22</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'PL' THEN EntryText END</td>
        <td>40</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'PI' THEN EntryText END</td>
        <td>41</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'PA' THEN EntryText END</td>
        <td>42</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'DL' THEN EntryText END</td>
        <td>43</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'DI' THEN EntryText END</td>
        <td>44</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'DA' THEN EntryText END</td>
        <td>45</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'PL' THEN EntryText END</td>
        <td>64</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'PI' THEN EntryText END</td>
        <td>65</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'PA' THEN EntryText END</td>
        <td>66</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'DL' THEN EntryText END</td>
        <td>67</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'DI' THEN EntryText END</td>
        <td>68</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE EntryTypeID WHEN 'DA' THEN EntryText END</td>
        <td>69</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN CA.UseRouteRules &lt;&gt; 0
          AND IsNull(CARI.PickupAddressType, 0) &lt;&gt; 0 THEN CARI.PickupAddressType ELSE 323 END</td>
        <td>97</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">ClientAccountRouteInstructions</td>
        <td>15</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountRouteInstructions</td>
        <td>23</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountAddress WITH (NOLOCK)</td>
        <td>29</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountAddress AS CAA WITH (NOLOCK)</td>
        <td>47</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountRouteInstructions AS CARI WITH (NOLOCK)</td>
        <td>48</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountRouteInstructions AS CARI WITH (NOLOCK)</td>
        <td>71</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RouteStopClientAccount AS RSCA WITH (NOLOCK)</td>
        <td>86</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount AS CA WITH (NOLOCK)</td>
        <td>99</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountRouteInfo AS CARI WITH (NOLOCK)</td>
        <td>100</td>
      </tr>
      <tr valign="top">
        <td colspan="1">Subquery</td>
        <td colspan="1">(SELECT *
 FROM   ClientAccountAddress WITH (NOLOCK)
 WHERE  ClientAccountID = @ClientAccountID
        AND AddressTypeID = @AddressTypeID
        AND IsNull(Address1, '') &lt;&gt; '')</td>
        <td>29</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">(SELECT Min(CASE EntryTypeID WHEN 'PL' THEN EntryText END) AS PickupLocation,
        Min(CASE EntryTypeID WHEN 'PI' THEN EntryText END) AS PickupInstructions,
        Min(CASE EntryTypeID WHEN 'PA' THEN EntryText END) AS PickupAdditionalInfo,
        Min(CASE EntryTypeID WHEN 'DL' THEN EntryText END) AS DeliveryLocation,
        Min(CASE EntryTypeID WHEN 'DI' THEN EntryText END) AS DeliveryInstructions,
        Min(CASE EntryTypeID WHEN 'DA' THEN EntryText END) AS DeliveryAdditionalInfo,
        @AddressTypeID AS AddressTypeID
 FROM   ClientAccountAddress AS CAA WITH (NOLOCK)
        INNER JOIN
        ClientAccountRouteInstructions AS CARI WITH (NOLOCK)
        ON CARI.ClientAccountID = CAA.ClientAccountID
           AND CARI.ClientAccountAddressID = CAA.InstanceID
 WHERE  CAA.ClientAccountID = @ClientAccountID
        AND CAA.AddressTypeID = @AddressTypeID) AS RI</td>
        <td>40</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">(SELECT Min(CASE EntryTypeID WHEN 'PL' THEN EntryText END) AS PickupLocation,
        Min(CASE EntryTypeID WHEN 'PI' THEN EntryText END) AS PickupInstructions,
        Min(CASE EntryTypeID WHEN 'PA' THEN EntryText END) AS PickupAdditionalInfo,
        Min(CASE EntryTypeID WHEN 'DL' THEN EntryText END) AS DeliveryLocation,
        Min(CASE EntryTypeID WHEN 'DI' THEN EntryText END) AS DeliveryInstructions,
        Min(CASE EntryTypeID WHEN 'DA' THEN EntryText END) AS DeliveryAdditionalInfo,
        323 AS AddressTypeID
 FROM   ClientAccountRouteInstructions AS CARI WITH (NOLOCK)
 WHERE  ClientAccountID = @ClientAccountID
        AND ClientAccountAddressID IS NULL) AS RI</td>
        <td>64</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">(SELECT *
 FROM   @Table
 WHERE  GeneralInstructions IS NULL
        AND PickupLocation IS NULL
        AND PickupInstructions IS NULL
        AND PickupAdditionalInfo IS NULL
        AND DeliveryLocation IS NULL
        AND DeliveryInstructions IS NULL
        AND DeliveryAdditionalInfo IS NULL)</td>
        <td>81</td>
      </tr>
      <tr valign="top">
        <td colspan="1">NOLOCK</td>
        <td colspan="1">NOLOCK</td>
        <td>29</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>47</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>48</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>71</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>86</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>99</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>100</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">UPDATE with FROM clause</td>
        <td colspan="1">
FROM @Table AS T
     INNER JOIN
     (SELECT Min(CASE EntryTypeID WHEN 'PL' THEN EntryText END) AS PickupLocation,
             Min(CASE EntryTypeID WHEN 'PI' THEN EntryText END) AS PickupInstructions,
             Min(CASE EntryTypeID WHEN 'PA' THEN EntryText END) AS PickupAdditionalInfo,
             Min(CASE EntryTypeID WHEN 'DL' THEN EntryText END) AS DeliveryLocation,
             Min(CASE EntryTypeID WHEN 'DI' THEN EntryText END) AS DeliveryInstructions,
             Min(CASE EntryTypeID WHEN 'DA' THEN EntryText END) AS DeliveryAdditionalInfo,
             @AddressTypeID AS AddressTypeID
      FROM   ClientAccountAddress AS CAA WITH (NOLOCK)
             INNER JOIN
             ClientAccountRouteInstructions AS CARI WITH (NOLOCK)
             ON CARI.ClientAccountID = CAA.ClientAccountID
                AND CARI.ClientAccountAddressID = CAA.InstanceID
      WHERE  CAA.ClientAccountID = @ClientAccountID
             AND CAA.AddressTypeID = @AddressTypeID) AS RI
     ON 1 = 1</td>
        <td>39</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">
FROM ClientAccountAddress AS CAA WITH (NOLOCK)
     INNER JOIN
     ClientAccountRouteInstructions AS CARI WITH (NOLOCK)
     ON CARI.ClientAccountID = CAA.ClientAccountID
        AND CARI.ClientAccountAddressID = CAA.InstanceID</td>
        <td>47</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">
FROM @Table AS T
     INNER JOIN
     (SELECT Min(CASE EntryTypeID WHEN 'PL' THEN EntryText END) AS PickupLocation,
             Min(CASE EntryTypeID WHEN 'PI' THEN EntryText END) AS PickupInstructions,
             Min(CASE EntryTypeID WHEN 'PA' THEN EntryText END) AS PickupAdditionalInfo,
             Min(CASE EntryTypeID WHEN 'DL' THEN EntryText END) AS DeliveryLocation,
             Min(CASE EntryTypeID WHEN 'DI' THEN EntryText END) AS DeliveryInstructions,
             Min(CASE EntryTypeID WHEN 'DA' THEN EntryText END) AS DeliveryAdditionalInfo,
             323 AS AddressTypeID
      FROM   ClientAccountRouteInstructions AS CARI WITH (NOLOCK)
      WHERE  ClientAccountID = @ClientAccountID
             AND ClientAccountAddressID IS NULL) AS RI
     ON 1 = 1</td>
        <td>63</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">
FROM ClientAccountRouteInstructions AS CARI WITH (NOLOCK)</td>
        <td>71</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">
FROM @Table AS T
     LEFT OUTER JOIN
     RouteStopClientAccount AS RSCA WITH (NOLOCK)
     ON RSCA.ClientAccountID = @ClientAccountID</td>
        <td>85</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">
FROM @Table AS T
     INNER JOIN
     ClientAccount AS CA WITH (NOLOCK)
     ON CA.InstanceID = @ClientAccountID
     LEFT OUTER JOIN
     ClientAccountRouteInfo AS CARI WITH (NOLOCK)
     ON CARI.ClientAccountID = CA.InstanceID</td>
        <td>98</td>
      </tr>
    </table>
  </body>
</html>