<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [API_SPOT2000].[SPRoute_01_MigrateRouteToServicePlan]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [API_SPOT2000].[SPRoute_01_MigrateRouteToServicePlan]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>3/11/2019 10:31 AM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Subquery</td>
        <td colspan="1">(SELECT *
 FROM   [Route] WITH (NOLOCK)
 WHERE  InstanceID = @RouteID
        AND Deleted = 0)</td>
        <td>33</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">(SELECT *
 FROM   [Route] WITH (NOLOCK)
 WHERE  InstanceID = @RouteID
        AND VersionID &lt;&gt; 0)</td>
        <td>42</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">(SELECT *
 FROM   [Route] AS R WITH (NOLOCK)
        INNER JOIN
        ESM_SPAccountNodeGroupAssignment AS A WITH (NOLOCK)
        ON A.SPAccountNodeID = R.SPAccountNodeID
           AND A.SPAccountNodeGroupID = @SPAccountNodeGroupID
 WHERE  R.InstanceID = @RouteID)</td>
        <td>53</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">(SELECT *
 FROM   MRSession AS MR WITH (NOLOCK)
        INNER JOIN
        ManifestHistory AS MH WITH (NOLOCK)
        ON MH.InstanceID = MR.ManifestID
        INNER JOIN
        ManifestHistoryStop AS MS WITH (NOLOCK)
        ON MS.ManifestID = MH.InstanceID
 WHERE  (MR.RouteID = @RouteID
         OR MS.RouteID = @RouteID)
        AND MR.StartDateTime &gt; @ThresholdDateTime
        AND MR.EndDateTime IS NULL)</td>
        <td>65</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">(SELECT *
 FROM   [Route] WITH (NOLOCK)
 WHERE  RouteName = @RouteName
        AND InstanceID &lt;&gt; @RouteID)</td>
        <td>106</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">(SELECT *
 FROM   [Route] WITH (NOLOCK)
 WHERE  InstanceID = @RouteID
        AND Active = 0)</td>
        <td>109</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">(SELECT *
 FROM   RouteDeliveryZone WITH (NOLOCK)
 WHERE  RouteID = @RouteID)</td>
        <td>113</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">(SELECT *
 FROM   RouteZone WITH (NOLOCK)
 WHERE  [Name] = @ZoneName)</td>
        <td>115</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">(SELECT *
 FROM   @Messages
 WHERE  MessageType = 'E')</td>
        <td>275</td>
      </tr>
      <tr valign="top">
        <td colspan="1">One-part names</td>
        <td colspan="1">[Route] WITH (NOLOCK)</td>
        <td>33</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">[Route] WITH (NOLOCK)</td>
        <td>42</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">[Route] AS R WITH (NOLOCK)</td>
        <td>53</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNodeGroupAssignment AS A WITH (NOLOCK)</td>
        <td>53</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">MRSession AS MR WITH (NOLOCK)</td>
        <td>67</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ManifestHistory AS MH WITH (NOLOCK)</td>
        <td>68</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ManifestHistoryStop AS MS WITH (NOLOCK)</td>
        <td>69</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">[Route] WITH (NOLOCK)</td>
        <td>103</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">[Route] WITH (NOLOCK)</td>
        <td>106</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">[Route] WITH (NOLOCK)</td>
        <td>109</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">RouteDeliveryZone WITH (NOLOCK)</td>
        <td>113</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RouteZone WITH (NOLOCK)</td>
        <td>115</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">RouteZone WITH (NOLOCK)</td>
        <td>118</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RouteZone</td>
        <td>124</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">RouteZonePoint</td>
        <td>129</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RouteDeliveryZone WITH (NOLOCK)</td>
        <td>134</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">RouteServiceZone</td>
        <td>140</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RouteServiceWindow</td>
        <td>183</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">[Route] AS R WITH (NOLOCK)</td>
        <td>208</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RouteStop AS RS WITH (NOLOCK)</td>
        <td>209</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">RouteStopClientAccount AS RSC WITH (NOLOCK)</td>
        <td>210</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">[Route]</td>
        <td>249</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">RouteDeliveryZone</td>
        <td>270</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">NOLOCK</td>
        <td colspan="1">NOLOCK</td>
        <td>33</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>42</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>53</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>53</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>67</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>68</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>69</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>103</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>106</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>109</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>113</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>115</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>118</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>134</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>208</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>209</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>210</td>
      </tr>
      <tr valign="top">
        <td colspan="1">BEGIN TRANSACTION</td>
        <td colspan="1">BEGIN TRANSACTION</td>
        <td>80</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">DISTINCT</td>
        <td colspan="1">Count(DISTINCT RSC.InstanceID)</td>
        <td>207</td>
      </tr>
      <tr valign="top">
        <td colspan="1">Cursors</td>
        <td colspan="1">CURSOR
    FOR SELECT RouteStopID,
               StopNumber,
               CustomerCount
        FROM   @Stops</td>
        <td>220</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">FETCH CURSOR</td>
        <td colspan="1">FETCH NEXT FROM StopCursor INTO @RouteStopID, @StopNumber, @CustomerCount</td>
        <td>224</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM StopCursor INTO @RouteStopID, @StopNumber, @CustomerCount</td>
        <td>242</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">@@fetch_status</td>
        <td colspan="1">@@FETCH_STATUS</td>
        <td>225</td>
      </tr>
      <tr valign="top">
        <td colspan="1">INSERT EXEC</td>
        <td colspan="1">INSERT @Messages (MessageType, MessageCategory, MessageText, CommitOption, RollbackOption)
EXECUTE SPRoute_01_MigrateSingleCustomerStop @RouteID, @RouteStopID, @Days, @RouteZoneID, @CurrentDateTime</td>
        <td>233</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">INSERT @Messages (MessageType, MessageCategory, MessageText, CommitOption, RollbackOption)
EXECUTE SPRoute_01_MigrateMultiCustomerStop @RouteID, @RouteStopID, @Days, @RouteZoneID, @CurrentDateTime</td>
        <td>238</td>
      </tr>
      <tr valign="top">
        <td colspan="1">ROLLBACK TRANSACTION</td>
        <td colspan="1">ROLLBACK</td>
        <td>297</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">COMMIT TRANSACTION</td>
        <td colspan="1">COMMIT TRANSACTION</td>
        <td>299</td>
      </tr>
    </table>
  </body>
</html>