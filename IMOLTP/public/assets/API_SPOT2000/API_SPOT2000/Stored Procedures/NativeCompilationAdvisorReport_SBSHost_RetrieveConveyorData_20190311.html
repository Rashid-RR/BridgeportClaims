<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [API_SPOT2000].[SBSHost_RetrieveConveyorData]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [API_SPOT2000].[SBSHost_RetrieveConveyorData]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>3/11/2019 10:32 AM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Subquery</td>
        <td colspan="1">(SELECT ConveyorPost.InstanceNumber
 FROM   ConveyorPost WITH (READPAST)
 WHERE  ConveyorPost.SentDateTime IS NULL
        AND ConveyorPost.ConveyorName = @ConveyorName
        AND ConveyorPost.PendingCache &lt;&gt; 1)</td>
        <td>4</td>
      </tr>
      <tr valign="top">
        <td colspan="1">One-part names</td>
        <td colspan="1">ConveyorPost WITH (READPAST)</td>
        <td>4</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ConveyorPost WITH (READPAST)</td>
        <td>80</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ConveyorPost WITH (READPAST)</td>
        <td>81</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ConveyorPostInvoice WITH (NOLOCK)</td>
        <td>82</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)</td>
        <td>83</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>84</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS Store WITH (NOLOCK)</td>
        <td>85</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNodeAddress AS StoreAddress WITH (NOLOCK)</td>
        <td>86</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Route WITH (NOLOCK)</td>
        <td>87</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RouteStopClientAccount WITH (NOLOCK)</td>
        <td>88</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">RouteStop WITH (NOLOCK)</td>
        <td>89</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Hotel WITH (NOLOCK)</td>
        <td>90</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ConveyorPostPrintCache WITH (NOLOCK)</td>
        <td>91</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ConveyorPostInvoiceItem WITH (NOLOCK)</td>
        <td>92</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">InvoiceRestorationInfo WITH (NOLOCK)</td>
        <td>93</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountRestorationInfo WITH (NOLOCK)</td>
        <td>94</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Locker WITH (NOLOCK)</td>
        <td>95</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">LockerAddress WITH (NOLOCK)</td>
        <td>96</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">InvoiceComment WITH (NOLOCK)</td>
        <td>97</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Invoice AS I WITH (NOLOCK)</td>
        <td>98</td>
      </tr>
      <tr valign="top">
        <td colspan="1">READPAST</td>
        <td colspan="1">READPAST</td>
        <td>4</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">READPAST</td>
        <td>80</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">READPAST</td>
        <td>81</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN IsNull(IC.Comment, '') = '' THEN '' ELSE SubString(IC.Comment, 13, 9) END</td>
        <td>32</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ConveyorPost.PostingType = 'O5'
          AND ConveyorPost.PostingContext = 'Extract_D' THEN DENSE_RANK() OVER (ORDER BY IsNull(RouteStop.StopNumber, 9999), IsNull(RouteStopClientAccount.Ordinal, 0)) ELSE IsNull(RouteStop.StopNumber, 9999) END</td>
        <td>39</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccount.AccountTypeID = 74
          AND Hotel.HotelName IS NULL THEN ClientAccount.Name ELSE IsNull(Hotel.HotelName, '') END</td>
        <td>40</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.HotelID IS NOT NULL
          AND Invoice.HotelPrintedPrice &lt;&gt; 0 THEN Invoice.HotelPrintedPrice ELSE Invoice.Price END</td>
        <td>51</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">DENSE_RANK</td>
        <td colspan="1">DENSE_RANK() OVER (ORDER BY IsNull(RouteStop.StopNumber, 9999), IsNull(RouteStopClientAccount.Ordinal, 0))</td>
        <td>39</td>
      </tr>
      <tr valign="top">
        <td colspan="1">OVER</td>
        <td colspan="1">OVER (ORDER BY IsNull(RouteStop.StopNumber, 9999), IsNull(RouteStopClientAccount.Ordinal, 0))</td>
        <td>39</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">REPLACE</td>
        <td colspan="1">Replace(Replace(Replace(ConveyorPostInvoice.Memos, char(13) + char(10), ' / '), char(13), ' / '), char(10), ' / ')</td>
        <td>66</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Replace(Replace(ConveyorPostInvoice.Memos, char(13) + char(10), ' / '), char(13), ' / ')</td>
        <td>66</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Replace(ConveyorPostInvoice.Memos, char(13) + char(10), ' / ')</td>
        <td>66</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Replace(Replace(Replace(ConveyorPostInvoice.Comments, char(13) + char(10), ' / '), char(13), ' / '), char(10), ' / ')</td>
        <td>67</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Replace(Replace(ConveyorPostInvoice.Comments, char(13) + char(10), ' / '), char(13), ' / ')</td>
        <td>67</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Replace(ConveyorPostInvoice.Comments, char(13) + char(10), ' / ')</td>
        <td>67</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Replace(Replace(Replace(ConveyorPostInvoiceItem.Comments, char(13) + char(10), ' / '), char(13), ' / '), char(10), ' / ')</td>
        <td>68</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Replace(Replace(ConveyorPostInvoiceItem.Comments, char(13) + char(10), ' / '), char(13), ' / ')</td>
        <td>68</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Replace(ConveyorPostInvoiceItem.Comments, char(13) + char(10), ' / ')</td>
        <td>68</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CHAR</td>
        <td colspan="1">char(13)</td>
        <td>66</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">char(10)</td>
        <td>66</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">char(13)</td>
        <td>66</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">char(10)</td>
        <td>66</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">char(13)</td>
        <td>67</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">char(10)</td>
        <td>67</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">char(13)</td>
        <td>67</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">char(10)</td>
        <td>67</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">char(13)</td>
        <td>68</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">char(10)</td>
        <td>68</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">char(13)</td>
        <td>68</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">char(10)</td>
        <td>68</td>
      </tr>
      <tr valign="top">
        <td colspan="1">APPLY</td>
        <td colspan="1">ConveyorPost WITH (READPAST)
INNER JOIN
(SELECT   TOP 25 ConveyorPost.InstanceNumber AS ID
 FROM     ConveyorPost WITH (READPAST)
 WHERE    ConveyorPost.SentDateTime IS NULL
          AND ConveyorPost.ConveyorName = @ConveyorName
          AND ConveyorPost.PendingCache &lt;&gt; 1
 ORDER BY ConveyorPost.Priority, ConveyorPost.InstanceNumber) AS Domain
ON Domain.ID = ConveyorPost.InstanceNumber
LEFT OUTER JOIN
ConveyorPostInvoice WITH (NOLOCK)
ON ConveyorPostInvoice.ConveyorPostID = ConveyorPost.InstanceNumber
LEFT OUTER JOIN
Invoice WITH (NOLOCK)
ON Invoice.InstanceID = ConveyorPostInvoice.InvoiceID
LEFT OUTER JOIN
ClientAccount WITH (NOLOCK)
ON ClientAccount.InstanceID = Invoice.ClientAccountID
LEFT OUTER JOIN
ESM_SPAccountNode AS Store WITH (NOLOCK)
ON Store.InstanceID = Invoice.SPAccountNodeID
LEFT OUTER JOIN
ESM_SPAccountNodeAddress AS StoreAddress WITH (NOLOCK)
ON StoreAddress.SPAccountNodeID = Store.InstanceID
   AND StoreAddress.AddressTypeID = 188
LEFT OUTER JOIN
Route WITH (NOLOCK)
ON Route.InstanceID = Invoice.RouteID
LEFT OUTER JOIN
RouteStopClientAccount WITH (NOLOCK)
ON RouteStopClientAccount.ClientAccountID = ClientAccount.InstanceID
LEFT OUTER JOIN
RouteStop WITH (NOLOCK)
ON RouteStop.InstanceID = RouteStopClientAccount.RouteStopID
   AND RouteStop.RouteID = Invoice.RouteID
LEFT OUTER JOIN
Hotel WITH (NOLOCK)
ON Hotel.InstanceID = Invoice.HotelID
LEFT OUTER JOIN
ConveyorPostPrintCache WITH (NOLOCK)
ON ConveyorPostPrintCache.InvoiceID = Invoice.InstanceID
   AND ConveyorPostInvoice.PrintToFile = 1
LEFT OUTER JOIN
ConveyorPostInvoiceItem WITH (NOLOCK)
ON ConveyorPostInvoiceItem.ConveyorPostInvoiceID = ConveyorPostInvoice.InstanceNumber
LEFT OUTER JOIN
InvoiceRestorationInfo WITH (NOLOCK)
ON InvoiceRestorationInfo.InvoiceID = Invoice.InstanceID
LEFT OUTER JOIN
ClientAccountRestorationInfo WITH (NOLOCK)
ON ClientAccountRestorationInfo.ClientAccountID = ClientAccount.InstanceID
LEFT OUTER JOIN
Locker WITH (NOLOCK)
ON Locker.InstanceID = Invoice.LockerID
LEFT OUTER JOIN
LockerAddress WITH (NOLOCK)
ON LockerAddress.LockerID = Locker.InstanceID OUTER APPLY (SELECT   TOP 1 *
                                                           FROM     InvoiceComment WITH (NOLOCK)
                                                           WHERE    InvoiceComment.InvoiceID = Invoice.InstanceID
                                                                    AND InvoiceComment.Comment LIKE 'SPLIT FROM %'
                                                           ORDER BY InvoiceComment.InstanceNumber DESC) AS IC OUTER APPLY (SELECT Sum(I.PieceCount) AS VisitPC,
                                                                                                                                  Sum(dbo.ConveyorHangingItemCount(I.InstanceID, @AcceptZeroPieceItems)) AS VisitConveyorPC
                                                                                                                           FROM   Invoice AS I WITH (NOLOCK)
                                                                                                                           WHERE  I.VisitID = Invoice.VisitID
                                                                                                                                  AND I.Voided = 0) AS VP</td>
        <td>80</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ConveyorPost WITH (READPAST)
INNER JOIN
(SELECT   TOP 25 ConveyorPost.InstanceNumber AS ID
 FROM     ConveyorPost WITH (READPAST)
 WHERE    ConveyorPost.SentDateTime IS NULL
          AND ConveyorPost.ConveyorName = @ConveyorName
          AND ConveyorPost.PendingCache &lt;&gt; 1
 ORDER BY ConveyorPost.Priority, ConveyorPost.InstanceNumber) AS Domain
ON Domain.ID = ConveyorPost.InstanceNumber
LEFT OUTER JOIN
ConveyorPostInvoice WITH (NOLOCK)
ON ConveyorPostInvoice.ConveyorPostID = ConveyorPost.InstanceNumber
LEFT OUTER JOIN
Invoice WITH (NOLOCK)
ON Invoice.InstanceID = ConveyorPostInvoice.InvoiceID
LEFT OUTER JOIN
ClientAccount WITH (NOLOCK)
ON ClientAccount.InstanceID = Invoice.ClientAccountID
LEFT OUTER JOIN
ESM_SPAccountNode AS Store WITH (NOLOCK)
ON Store.InstanceID = Invoice.SPAccountNodeID
LEFT OUTER JOIN
ESM_SPAccountNodeAddress AS StoreAddress WITH (NOLOCK)
ON StoreAddress.SPAccountNodeID = Store.InstanceID
   AND StoreAddress.AddressTypeID = 188
LEFT OUTER JOIN
Route WITH (NOLOCK)
ON Route.InstanceID = Invoice.RouteID
LEFT OUTER JOIN
RouteStopClientAccount WITH (NOLOCK)
ON RouteStopClientAccount.ClientAccountID = ClientAccount.InstanceID
LEFT OUTER JOIN
RouteStop WITH (NOLOCK)
ON RouteStop.InstanceID = RouteStopClientAccount.RouteStopID
   AND RouteStop.RouteID = Invoice.RouteID
LEFT OUTER JOIN
Hotel WITH (NOLOCK)
ON Hotel.InstanceID = Invoice.HotelID
LEFT OUTER JOIN
ConveyorPostPrintCache WITH (NOLOCK)
ON ConveyorPostPrintCache.InvoiceID = Invoice.InstanceID
   AND ConveyorPostInvoice.PrintToFile = 1
LEFT OUTER JOIN
ConveyorPostInvoiceItem WITH (NOLOCK)
ON ConveyorPostInvoiceItem.ConveyorPostInvoiceID = ConveyorPostInvoice.InstanceNumber
LEFT OUTER JOIN
InvoiceRestorationInfo WITH (NOLOCK)
ON InvoiceRestorationInfo.InvoiceID = Invoice.InstanceID
LEFT OUTER JOIN
ClientAccountRestorationInfo WITH (NOLOCK)
ON ClientAccountRestorationInfo.ClientAccountID = ClientAccount.InstanceID
LEFT OUTER JOIN
Locker WITH (NOLOCK)
ON Locker.InstanceID = Invoice.LockerID
LEFT OUTER JOIN
LockerAddress WITH (NOLOCK)
ON LockerAddress.LockerID = Locker.InstanceID OUTER APPLY (SELECT   TOP 1 *
                                                           FROM     InvoiceComment WITH (NOLOCK)
                                                           WHERE    InvoiceComment.InvoiceID = Invoice.InstanceID
                                                                    AND InvoiceComment.Comment LIKE 'SPLIT FROM %'
                                                           ORDER BY InvoiceComment.InstanceNumber DESC) AS IC</td>
        <td>80</td>
      </tr>
      <tr valign="top">
        <td colspan="1">NOLOCK</td>
        <td colspan="1">NOLOCK</td>
        <td>82</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>83</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>84</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>85</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>86</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>87</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>88</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>89</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>90</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>91</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>92</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>93</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>94</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>95</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>96</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>97</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>98</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">LIKE</td>
        <td colspan="1">InvoiceComment.Comment LIKE 'SPLIT FROM %'</td>
        <td>97</td>
      </tr>
    </table>
  </body>
</html>