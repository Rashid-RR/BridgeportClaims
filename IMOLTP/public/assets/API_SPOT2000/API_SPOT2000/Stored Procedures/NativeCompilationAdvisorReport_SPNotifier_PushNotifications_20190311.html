<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [API_SPOT2000].[SPNotifier_PushNotifications]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [API_SPOT2000].[SPNotifier_PushNotifications]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>3/11/2019 10:31 AM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN ARAccountTypeID = 293 THEN '' ELSE ClientAccount.ARAccountNumber END</td>
        <td>35</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ARAccountTypeID = 293 THEN '' ELSE ClientAccount.ARAccountNumber END</td>
        <td>86</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ARAccountTypeID = 293 THEN '' ELSE ClientAccount.ARAccountNumber END</td>
        <td>141</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ARAccountTypeID = 293 THEN '' ELSE ClientAccount.ARAccountNumber END</td>
        <td>192</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN VisitStatusID = 2 THEN ISNULL(MSS.VisitStatusReason, '') WHEN OrderStatusID = 2 THEN ISNULL(MIS.OrderStatusReason, '') ELSE '' END</td>
        <td>214</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ARAccountTypeID = 293 THEN '' ELSE ClientAccount.ARAccountNumber END</td>
        <td>247</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ARAccountTypeID = 293 THEN '' ELSE ClientAccount.ARAccountNumber END</td>
        <td>298</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @Day = 1 THEN 'M______' WHEN @Day = 2 THEN '_T_____' WHEN @Day = 3 THEN '__W____' WHEN @Day = 4 THEN '___T___' WHEN @Day = 5 THEN '____F__' WHEN @Day = 6 THEN '_____S_' WHEN @Day = 7 THEN '______S' END</td>
        <td>346</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ARAccountTypeID = 293 THEN '' ELSE ClientAccount.ARAccountNumber END</td>
        <td>381</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ARAccountTypeID = 293 THEN '' ELSE ClientAccount.ARAccountNumber END</td>
        <td>432</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">APPLY</td>
        <td colspan="1">Invoice WITH (NOLOCK)
INNER JOIN
fnGUIDListToTable(@SPAccountNodes) AS AN
ON AN.ID = Invoice.SPAccountNodeID
INNER JOIN
ClientAccount WITH (NOLOCK)
ON ClientAccount.InstanceID = Invoice.ClientAccountID
INNER JOIN
ESM_SPAccountNode AS Stores WITH (NOLOCK)
ON Stores.InstanceID = Invoice.SPAccountNodeID
LEFT OUTER JOIN
InvoiceNotification AS INF WITH (NOLOCK)
ON INF.InvoiceID = Invoice.InstanceID
   AND INF.Method = 'P'
   AND INF.MessageType = 'Orders Ready'
LEFT OUTER JOIN
ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)
ON PA.SPAccountNodeID = Stores.InstanceID
   AND PA.AddressTypeID = 188 OUTER APPLY (SELECT TOP 1 PushToken
                                           FROM   ClientAccountDevice WITH (NOLOCK)
                                           WHERE  ClientAccountID = Invoice.ClientAccountID
                                                  AND Enabled = 1
                                                  AND LastUsedDateTime IS NOT NULL
                                                  AND LastUsedDateTime &gt;= @LastUsedCutoffDate) AS CX</td>
        <td>58</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)
INNER JOIN
fnGUIDListToTable(@SPAccountNodes) AS AN
ON AN.ID = Invoice.SPAccountNodeID
INNER JOIN
ClientAccount WITH (NOLOCK)
ON ClientAccount.InstanceID = Invoice.ClientAccountID
INNER JOIN
ESM_SPAccountNode AS Stores WITH (NOLOCK)
ON Stores.InstanceID = Invoice.SPAccountNodeID
LEFT OUTER JOIN
ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)
ON PA.SPAccountNodeID = Stores.InstanceID
   AND PA.AddressTypeID = 188 OUTER APPLY (SELECT TOP 1 PushToken
                                           FROM   ClientAccountDevice WITH (NOLOCK)
                                           WHERE  ClientAccountID = Invoice.ClientAccountID
                                                  AND Enabled = 1
                                                  AND LastUsedDateTime IS NOT NULL
                                                  AND LastUsedDateTime &gt;= @LastUsedCutoffDate) AS CX OUTER APPLY (SELECT   TOP 1 InstanceNumber,
                                                                                                                                 SentDateTime
                                                                                                                  FROM     InvoiceNotification WITH (NOLOCK)
                                                                                                                  WHERE    InvoiceID = Invoice.InstanceID
                                                                                                                           AND Method = 'P'
                                                                                                                           AND MessageType = 'Late For Pickup'
                                                                                                                  ORDER BY SentDateTime DESC) AS INF</td>
        <td>109</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)
INNER JOIN
fnGUIDListToTable(@SPAccountNodes) AS AN
ON AN.ID = Invoice.SPAccountNodeID
INNER JOIN
ClientAccount WITH (NOLOCK)
ON ClientAccount.InstanceID = Invoice.ClientAccountID
INNER JOIN
ESM_SPAccountNode AS Stores WITH (NOLOCK)
ON Stores.InstanceID = Invoice.SPAccountNodeID
LEFT OUTER JOIN
ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)
ON PA.SPAccountNodeID = Stores.InstanceID
   AND PA.AddressTypeID = 188 OUTER APPLY (SELECT TOP 1 PushToken
                                           FROM   ClientAccountDevice WITH (NOLOCK)
                                           WHERE  ClientAccountID = Invoice.ClientAccountID
                                                  AND Enabled = 1
                                                  AND LastUsedDateTime IS NOT NULL
                                                  AND LastUsedDateTime &gt;= @LastUsedCutoffDate) AS CX</td>
        <td>109</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)
INNER JOIN
fnGUIDListToTable(@SPAccountNodes) AS AN
ON AN.ID = Invoice.SPAccountNodeID
INNER JOIN
ClientAccount WITH (NOLOCK)
ON ClientAccount.InstanceID = Invoice.ClientAccountID
INNER JOIN
ESM_SPAccountNode AS Stores WITH (NOLOCK)
ON Stores.InstanceID = Invoice.SPAccountNodeID
LEFT OUTER JOIN
InvoiceNotification AS INF WITH (NOLOCK)
ON INF.InvoiceID = Invoice.InstanceID
   AND INF.Method = 'P'
   AND INF.MessageType = 'Orders Delivered'
LEFT OUTER JOIN
ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)
ON PA.SPAccountNodeID = Stores.InstanceID
   AND PA.AddressTypeID = 188 OUTER APPLY (SELECT TOP 1 PushToken
                                           FROM   ClientAccountDevice WITH (NOLOCK)
                                           WHERE  ClientAccountID = Invoice.ClientAccountID
                                                  AND Enabled = 1
                                                  AND LastUsedDateTime IS NOT NULL
                                                  AND LastUsedDateTime &gt;= @LastUsedCutoffDate) AS CX</td>
        <td>165</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ManifestHistoryStop AS MS WITH (NOLOCK)
INNER JOIN
ClientAccount WITH (NOLOCK)
ON ClientAccount.InstanceID = MS.ClientAccountID
INNER JOIN
fnGUIDListToTable(@SPAccountNodes) AS AN
ON AN.ID = ClientAccount.SPAccountNodeID
INNER JOIN
ESM_SPAccountNode AS Stores WITH (NOLOCK)
ON Stores.InstanceID = ClientAccount.SPAccountNodeID
INNER JOIN
ManifestHistoryStopStatus AS MSS WITH (NOLOCK)
ON MSS.ManifestHistoryStopID = MS.InstanceID
INNER JOIN
ManifestHistoryInvoice AS MI WITH (NOLOCK)
ON MI.ManifestID = MS.ManifestID
   AND MS.ClientAccountID = dbo.RouteTrac_InvoiceClientAccountID(MI.InvoiceID)
INNER JOIN
ManifestHistoryInvoiceStatus AS MIS WITH (NOLOCK)
ON MIS.ManifestHistoryInvoiceID = MI.InstanceID
INNER JOIN
Invoice WITH (NOLOCK)
ON MI.InvoiceID = Invoice.InstanceID
LEFT OUTER JOIN
InvoiceNotification AS INF WITH (NOLOCK)
ON INF.InvoiceID = Invoice.InstanceID
   AND INF.Method = 'P'
   AND INF.MessageType = 'Orders Not Delivered'
   AND INF.SentDateTime BETWEEN @ReadyDateStart AND @ReadyDateEnd
LEFT OUTER JOIN
ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)
ON PA.SPAccountNodeID = Stores.InstanceID
   AND PA.AddressTypeID = 188 OUTER APPLY (SELECT TOP 1 PushToken
                                           FROM   ClientAccountDevice WITH (NOLOCK)
                                           WHERE  ClientAccountID = MS.ClientAccountID
                                                  AND Enabled = 1
                                                  AND LastUsedDateTime IS NOT NULL
                                                  AND LastUsedDateTime &gt;= @LastUsedCutoffDate) AS CX</td>
        <td>216</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)
INNER JOIN
fnGUIDListToTable(@SPAccountNodes) AS AN
ON AN.ID = Invoice.SPAccountNodeID
INNER JOIN
ClientAccount WITH (NOLOCK)
ON ClientAccount.InstanceID = Invoice.ClientAccountID
INNER JOIN
ESM_SPAccountNode AS Stores WITH (NOLOCK)
ON Stores.InstanceID = Invoice.SPAccountNodeID
LEFT OUTER JOIN
InvoiceNotification AS INF WITH (NOLOCK)
ON INF.InvoiceID = Invoice.InstanceID
   AND INF.Method = 'P'
   AND INF.MessageType = 'Orders Picked Up'
LEFT OUTER JOIN
ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)
ON PA.SPAccountNodeID = Stores.InstanceID
   AND PA.AddressTypeID = 188 OUTER APPLY (SELECT TOP 1 PushToken
                                           FROM   ClientAccountDevice WITH (NOLOCK)
                                           WHERE  ClientAccountID = Invoice.ClientAccountID
                                                  AND Enabled = 1
                                                  AND LastUsedDateTime IS NOT NULL
                                                  AND LastUsedDateTime &gt;= @LastUsedCutoffDate) AS CX</td>
        <td>271</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)
INNER JOIN
RouteStopClientAccount WITH (NOLOCK)
ON RouteStopClientAccount.ClientAccountID = ClientAccount.InstanceID
INNER JOIN
RouteStop WITH (NOLOCK)
ON RouteStopClientAccount.RouteStopID = RouteStop.InstanceID
INNER JOIN
Route WITH (NOLOCK)
ON RouteStop.RouteID = Route.InstanceID
INNER JOIN
fnGUIDListToTable(@SPAccountNodes) AS AN
ON AN.ID = Route.SPAccountNodeID
INNER JOIN
ESM_SPAccountNode AS Stores WITH (NOLOCK)
ON Stores.InstanceID = Route.SPAccountNodeID
LEFT OUTER JOIN
ClientAccountEvent WITH (NOLOCK)
ON ClientAccountEvent.ClientAccountID = ClientAccount.InstanceID
   AND ClientAccountEvent.EventType = 'Push to Device'
   AND ClientAccountEvent.Specifier2 = 'Notify Route Reminder'
   AND ClientAccountEvent.EventDateTime BETWEEN @ReadyDateStart AND @ReadyDateEnd
LEFT OUTER JOIN
ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)
ON PA.SPAccountNodeID = Stores.InstanceID
   AND PA.AddressTypeID = 188
LEFT OUTER JOIN
ClientAccountRouteInfo
ON ClientAccountRouteInfo.ClientAccountID = ClientAccount.InstanceID OUTER APPLY (SELECT AssignmentID
                                                                                  FROM   HolidayScheduleAssignment AS HSA WITH (NOLOCK)
                                                                                         INNER JOIN
                                                                                         HolidayScheduleDateRange AS HSDR WITH (NOLOCK)
                                                                                         ON HSA.HolidayScheduleProfileID = HSDR.HolidayScheduleProfileID
                                                                                            AND @ReadyDateEnd BETWEEN HSDR.StartDate AND HSDR.EndDate
                                                                                            AND DisableNotifications = 1
                                                                                            AND (HSA.AssignmentID = Route.InstanceID
                                                                                                 OR HSA.AssignmentID = Route.SPAccountNodeID)) AS Holiday OUTER APPLY (SELECT TOP 1 PushToken
                                                                                                                                                                       FROM   ClientAccountDevice WITH (NOLOCK)
                                                                                                                                                                       WHERE  ClientAccountID = ClientAccount.InstanceID
                                                                                                                                                                              AND Enabled = 1
                                                                                                                                                                              AND LastUsedDateTime IS NOT NULL
                                                                                                                                                                              AND LastUsedDateTime &gt;= @LastUsedCutoffDate) AS CX</td>
        <td>322</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)
INNER JOIN
RouteStopClientAccount WITH (NOLOCK)
ON RouteStopClientAccount.ClientAccountID = ClientAccount.InstanceID
INNER JOIN
RouteStop WITH (NOLOCK)
ON RouteStopClientAccount.RouteStopID = RouteStop.InstanceID
INNER JOIN
Route WITH (NOLOCK)
ON RouteStop.RouteID = Route.InstanceID
INNER JOIN
fnGUIDListToTable(@SPAccountNodes) AS AN
ON AN.ID = Route.SPAccountNodeID
INNER JOIN
ESM_SPAccountNode AS Stores WITH (NOLOCK)
ON Stores.InstanceID = Route.SPAccountNodeID
LEFT OUTER JOIN
ClientAccountEvent WITH (NOLOCK)
ON ClientAccountEvent.ClientAccountID = ClientAccount.InstanceID
   AND ClientAccountEvent.EventType = 'Push to Device'
   AND ClientAccountEvent.Specifier2 = 'Notify Route Reminder'
   AND ClientAccountEvent.EventDateTime BETWEEN @ReadyDateStart AND @ReadyDateEnd
LEFT OUTER JOIN
ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)
ON PA.SPAccountNodeID = Stores.InstanceID
   AND PA.AddressTypeID = 188
LEFT OUTER JOIN
ClientAccountRouteInfo
ON ClientAccountRouteInfo.ClientAccountID = ClientAccount.InstanceID OUTER APPLY (SELECT AssignmentID
                                                                                  FROM   HolidayScheduleAssignment AS HSA WITH (NOLOCK)
                                                                                         INNER JOIN
                                                                                         HolidayScheduleDateRange AS HSDR WITH (NOLOCK)
                                                                                         ON HSA.HolidayScheduleProfileID = HSDR.HolidayScheduleProfileID
                                                                                            AND @ReadyDateEnd BETWEEN HSDR.StartDate AND HSDR.EndDate
                                                                                            AND DisableNotifications = 1
                                                                                            AND (HSA.AssignmentID = Route.InstanceID
                                                                                                 OR HSA.AssignmentID = Route.SPAccountNodeID)) AS Holiday</td>
        <td>322</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Customer WITH (NOLOCK)
INNER JOIN
ClientAccount WITH (NOLOCK)
ON ClientAccount.InstanceID = Customer.ClientAccountID
INNER JOIN
fnGUIDListToTable(@SPAccountNodes) AS AN
ON AN.ID = ClientAccount.SPAccountNodeID
INNER JOIN
ESM_SPAccountNode AS Stores WITH (NOLOCK)
ON Stores.InstanceID = ClientAccount.SPAccountNodeID
LEFT OUTER JOIN
InvoiceNotification AS INF WITH (NOLOCK)
ON INF.CustomerID = Customer.ID
   AND INF.Method = 'P'
   AND INF.MessageType = 'Bags Picked Up'
LEFT OUTER JOIN
ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)
ON PA.SPAccountNodeID = Stores.InstanceID
   AND PA.AddressTypeID = 188
LEFT OUTER JOIN
Customer AS PrevPU WITH (NOLOCK)
ON PrevPU.ClientAccountID = Customer.ClientAccountID
   AND PrevPU.Action = 'Pick Up'
   AND Customer.Action = 'No Pick Up'
   AND PrevPU.ID &lt; Customer.ID
   AND PrevPU.MRSessionID = Customer.MRSessionID OUTER APPLY (SELECT TOP 1 PushToken
                                                              FROM   ClientAccountDevice WITH (NOLOCK)
                                                              WHERE  ClientAccountID = ClientAccount.InstanceID
                                                                     AND Enabled = 1
                                                                     AND LastUsedDateTime IS NOT NULL
                                                                     AND LastUsedDateTime &gt;= @LastUsedCutoffDate) AS CX</td>
        <td>405</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ManifestHistoryStop AS MS WITH (NOLOCK)
INNER JOIN
ClientAccount WITH (NOLOCK)
ON ClientAccount.InstanceID = MS.ClientAccountID
INNER JOIN
fnGUIDListToTable(@SPAccountNodes) AS AN
ON AN.ID = ClientAccount.SPAccountNodeID
INNER JOIN
ESM_SPAccountNode AS Stores WITH (NOLOCK)
ON Stores.InstanceID = ClientAccount.SPAccountNodeID
INNER JOIN
ManifestHistoryStopStatus AS MSS WITH (NOLOCK)
ON MSS.ManifestHistoryStopID = MS.InstanceID
LEFT OUTER JOIN
ManifestHistoryInvoice AS MI WITH (NOLOCK)
ON MI.ManifestID = MS.ManifestID
   AND MS.ClientAccountID = dbo.RouteTrac_InvoiceClientAccountID(MI.InvoiceID)
LEFT OUTER JOIN
InvoiceNotification AS INF WITH (NOLOCK)
ON INF.CustomerID = ClientAccount.InstanceNumber
   AND INF.Method = 'P'
   AND INF.MessageType = 'Route Did Not Visit'
   AND INF.SentDateTime BETWEEN @ReadyDateStart AND @ReadyDateEnd
LEFT OUTER JOIN
ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)
ON PA.SPAccountNodeID = Stores.InstanceID
   AND PA.AddressTypeID = 188 OUTER APPLY (SELECT TOP 1 PushToken
                                           FROM   ClientAccountDevice WITH (NOLOCK)
                                           WHERE  ClientAccountID = ClientAccount.InstanceID
                                                  AND Enabled = 1
                                                  AND LastUsedDateTime IS NOT NULL
                                                  AND LastUsedDateTime &gt;= @LastUsedCutoffDate) AS CX</td>
        <td>456</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">Invoice WITH (NOLOCK)</td>
        <td>58</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>60</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS Stores WITH (NOLOCK)</td>
        <td>61</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">InvoiceNotification AS INF WITH (NOLOCK)</td>
        <td>62</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)</td>
        <td>63</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountDevice WITH (NOLOCK)</td>
        <td>65</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Invoice AS Unracked WITH (NOLOCK)</td>
        <td>72</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)</td>
        <td>109</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>111</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS Stores WITH (NOLOCK)</td>
        <td>112</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)</td>
        <td>114</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountDevice WITH (NOLOCK)</td>
        <td>116</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoiceNotification WITH (NOLOCK)</td>
        <td>119</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)</td>
        <td>165</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>167</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS Stores WITH (NOLOCK)</td>
        <td>168</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoiceNotification AS INF WITH (NOLOCK)</td>
        <td>169</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)</td>
        <td>170</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountDevice WITH (NOLOCK)</td>
        <td>172</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ManifestHistoryStop AS MS WITH (NOLOCK)</td>
        <td>216</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>217</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS Stores WITH (NOLOCK)</td>
        <td>219</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ManifestHistoryStopStatus AS MSS WITH (NOLOCK)</td>
        <td>220</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ManifestHistoryInvoice AS MI WITH (NOLOCK)</td>
        <td>221</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ManifestHistoryInvoiceStatus AS MIS WITH (NOLOCK)</td>
        <td>222</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)</td>
        <td>223</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoiceNotification AS INF WITH (NOLOCK)</td>
        <td>224</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)</td>
        <td>226</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountDevice WITH (NOLOCK)</td>
        <td>228</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)</td>
        <td>271</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>273</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS Stores WITH (NOLOCK)</td>
        <td>274</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoiceNotification AS INF WITH (NOLOCK)</td>
        <td>275</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)</td>
        <td>276</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountDevice WITH (NOLOCK)</td>
        <td>278</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>322</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RouteStopClientAccount WITH (NOLOCK)</td>
        <td>323</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">RouteStop WITH (NOLOCK)</td>
        <td>324</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Route WITH (NOLOCK)</td>
        <td>325</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS Stores WITH (NOLOCK)</td>
        <td>327</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountEvent WITH (NOLOCK)</td>
        <td>328</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)</td>
        <td>331</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountRouteInfo</td>
        <td>332</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">HolidayScheduleAssignment AS HSA WITH (NOLOCK)</td>
        <td>334</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">HolidayScheduleDateRange AS HSDR WITH (NOLOCK)</td>
        <td>335</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountDevice WITH (NOLOCK)</td>
        <td>338</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountRouteInfoExceptions AS EX WITH (NOLOCK)</td>
        <td>358</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)</td>
        <td>365</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Customer WITH (NOLOCK)</td>
        <td>405</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>406</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS Stores WITH (NOLOCK)</td>
        <td>408</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">InvoiceNotification AS INF WITH (NOLOCK)</td>
        <td>409</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)</td>
        <td>410</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Customer AS PrevPU WITH (NOLOCK)</td>
        <td>411</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountDevice WITH (NOLOCK)</td>
        <td>413</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ManifestHistoryStop AS MS WITH (NOLOCK)</td>
        <td>456</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>457</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS Stores WITH (NOLOCK)</td>
        <td>459</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ManifestHistoryStopStatus AS MSS WITH (NOLOCK)</td>
        <td>460</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ManifestHistoryInvoice AS MI WITH (NOLOCK)</td>
        <td>461</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoiceNotification AS INF WITH (NOLOCK)</td>
        <td>462</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNodeAddress AS PA WITH (NOLOCK)</td>
        <td>464</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountDevice WITH (NOLOCK)</td>
        <td>466</td>
      </tr>
      <tr valign="top">
        <td colspan="1">NOLOCK</td>
        <td colspan="1">NOLOCK</td>
        <td>58</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>60</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>61</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>62</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>63</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>65</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>72</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>109</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>111</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>112</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>114</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>116</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>119</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>165</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>167</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>168</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>169</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>170</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>172</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>216</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>217</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>219</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>220</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>221</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>222</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>223</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>224</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>226</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>228</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>271</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>273</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>274</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>275</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>276</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>278</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>322</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>323</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>324</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>325</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>327</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>328</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>331</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>334</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>335</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>338</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>358</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>365</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>405</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>406</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>408</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>409</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>410</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>411</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>413</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>456</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>457</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>459</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>460</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>461</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>462</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>464</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>466</td>
      </tr>
      <tr valign="top">
        <td colspan="1">Table-valued functions</td>
        <td colspan="1">fnGUIDListToTable(@SPAccountNodes) AS AN</td>
        <td>59</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SPAccountNodes) AS AN</td>
        <td>110</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SPAccountNodes) AS AN</td>
        <td>166</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SPAccountNodes) AS AN</td>
        <td>218</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SPAccountNodes) AS AN</td>
        <td>272</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SPAccountNodes) AS AN</td>
        <td>326</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SPAccountNodes) AS AN</td>
        <td>407</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SPAccountNodes) AS AN</td>
        <td>458</td>
      </tr>
      <tr valign="top">
        <td colspan="1">LIKE</td>
        <td colspan="1">Invoice.RackLocation NOT LIKE '%STORAGE%'</td>
        <td>70</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Invoice.RackLocation NOT LIKE '%STORAGE%'</td>
        <td>126</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">DaysToVisit LIKE CASE WHEN @Day = 1 THEN 'M______' WHEN @Day = 2 THEN '_T_____' WHEN @Day = 3 THEN '__W____' WHEN @Day = 4 THEN '___T___' WHEN @Day = 5 THEN '____F__' WHEN @Day = 6 THEN '_____S_' WHEN @Day = 7 THEN '______S' END</td>
        <td>345</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Customer.Action LIKE 'Scan Bag%'</td>
        <td>417</td>
      </tr>
    </table>
  </body>
</html>