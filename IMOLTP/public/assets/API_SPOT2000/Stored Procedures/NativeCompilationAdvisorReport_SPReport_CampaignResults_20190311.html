<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [API_SPOT2000].[SPReport_CampaignResults]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [API_SPOT2000].[SPReport_CampaignResults]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>3/11/2019 10:32 AM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">ClientAccountAward WITH (NOLOCK)</td>
        <td>65</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">EMailTrackingGroup WITH (NOLOCK)</td>
        <td>66</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)</td>
        <td>104</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">InvoiceHistory WITH (NOLOCK)</td>
        <td>105</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS SPAccountNode WITH (NOLOCK)</td>
        <td>106</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">InvoiceCoupon WITH (NOLOCK)</td>
        <td>113</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)</td>
        <td>150</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">InvoiceHistory WITH (NOLOCK)</td>
        <td>151</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS SPAccountNode WITH (NOLOCK)</td>
        <td>152</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)</td>
        <td>188</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoiceHistory WITH (NOLOCK)</td>
        <td>189</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS SPAccountNode WITH (NOLOCK)</td>
        <td>190</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountAward WITH (NOLOCK)</td>
        <td>213</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>213</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS SPAccountNode WITH (NOLOCK)</td>
        <td>214</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountAward WITH (NOLOCK)</td>
        <td>219</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>219</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS SPAccountNode WITH (NOLOCK)</td>
        <td>220</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountAward WITH (NOLOCK)</td>
        <td>225</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>225</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS SPAccountNode WITH (NOLOCK)</td>
        <td>226</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)</td>
        <td>345</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoiceHistory WITH (NOLOCK)</td>
        <td>346</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS SPAccountNode WITH (NOLOCK)</td>
        <td>347</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoiceCoupon WITH (NOLOCK)</td>
        <td>355</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountAward WITH (NOLOCK)</td>
        <td>355</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">EMailTrackingGroup WITH (NOLOCK)</td>
        <td>356</td>
      </tr>
      <tr valign="top">
        <td colspan="1">NOLOCK</td>
        <td colspan="1">NOLOCK</td>
        <td>65</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>66</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>104</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>105</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>106</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>113</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>150</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>151</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>152</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>188</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>189</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>190</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>213</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>213</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>214</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>219</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>219</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>220</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>225</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>225</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>226</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>345</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>346</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>347</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>355</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>355</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>356</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Table-valued functions</td>
        <td colspan="1">fnGUIDListToTable(@SelectedCampaigns) AS SELECTED_CAMPAIGNS</td>
        <td>67</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SelectedCampaigns) AS SELECTED_CAMPAIGNS</td>
        <td>102</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SelectedSites) AS SELECTED_SITES</td>
        <td>107</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SelectedCampaigns) AS SELECTED_CAMPAIGNS</td>
        <td>148</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SelectedSites) AS SELECTED_SITES</td>
        <td>153</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SelectedCampaigns) AS SELECTED_CAMPAIGNS</td>
        <td>186</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SelectedSites) AS SELECTED_SITES</td>
        <td>191</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SelectedSites) AS SELECTED_SITES</td>
        <td>215</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SelectedSites) AS SELECTED_SITES</td>
        <td>221</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SelectedSites) AS SELECTED_SITES</td>
        <td>227</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">fnGUIDListToTable(@SelectedSites) AS SELECTED_SITES</td>
        <td>348</td>
      </tr>
      <tr valign="top">
        <td colspan="1">Cursors</td>
        <td colspan="1">CURSOR
    FOR SELECT ClientAccountAwardID
        FROM   @ValidCampaigns</td>
        <td>79</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR
    FOR SELECT   DISTINCT Campaign,
                          CampaignID,
                          MAX(AwardDateTime),
                          MAX(ClientAccountAwardNumber)
        FROM     @ValidCampaigns
        GROUP BY Campaign, CampaignID</td>
        <td>206</td>
      </tr>
      <tr valign="top">
        <td colspan="1">FETCH CURSOR</td>
        <td colspan="1">FETCH NEXT FROM InvoiceCursor INTO @AwardID</td>
        <td>81</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM InvoiceCursor INTO @AwardID</td>
        <td>119</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM InvoiceCursor INTO @Campaign, @CampaignID, @AwardDate, @ClientAccountAwardNumber</td>
        <td>208</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM InvoiceCursor INTO @Campaign, @CampaignID, @AwardDate, @ClientAccountAwardNumber</td>
        <td>364</td>
      </tr>
      <tr valign="top">
        <td colspan="1">@@fetch_status</td>
        <td colspan="1">@@FETCH_STATUS</td>
        <td>82</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@FETCH_STATUS</td>
        <td>209</td>
      </tr>
      <tr valign="top">
        <td colspan="1">DISTINCT</td>
        <td colspan="1">COUNT(DISTINCT Invoice.ClientAccountID)</td>
        <td>92</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT Invoice.ClientAccountID)</td>
        <td>135</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT Invoice.VisitID)</td>
        <td>135</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT Invoice.ClientAccountID)</td>
        <td>173</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT Invoice.VisitID)</td>
        <td>173</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT Invoice.ClientAccountID)</td>
        <td>329</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT Invoice.VisitID)</td>
        <td>329</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN Invoice.InitialVisitDateTime BETWEEN AwardDateTime - @SalesDays AND AwardDateTime THEN ' Pre-Campaign (' + CONVERT (VARCHAR (5), @SalesDays) + ' days)' ELSE 'Post-Campaign (' + CONVERT (VARCHAR (5), @SalesDays) + ' days)' END</td>
        <td>132</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.InitialVisitDateTime BETWEEN AwardDateTime - @SalesDays AND AwardDateTime THEN 2 ELSE 3 END</td>
        <td>133</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.InitialVisitDateTime BETWEEN AwardDateTime - @SalesDays AND AwardDateTime THEN ' Pre-Campaign (' + CONVERT (VARCHAR (5), @SalesDays) + ' days)' ELSE 'Post-Campaign (' + CONVERT (VARCHAR (5), @SalesDays) + ' days)' END</td>
        <td>158</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.InitialVisitDateTime BETWEEN AwardDateTime - @SalesDays AND AwardDateTime THEN 2 ELSE 3 END</td>
        <td>159</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.InitialVisitDateTime BETWEEN AwardDateTime - @SalesDays AND AwardDateTime THEN ' Pre-Campaign (' + CONVERT (VARCHAR (5), @SalesDays) + ' days)' ELSE 'Post-Campaign (' + CONVERT (VARCHAR (5), @SalesDays) + ' days)' END</td>
        <td>170</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.InitialVisitDateTime BETWEEN AwardDateTime - @SalesDays AND AwardDateTime THEN 2 ELSE 3 END</td>
        <td>171</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.InitialVisitDateTime BETWEEN AwardDateTime - @SalesDays AND AwardDateTime THEN ' Pre-Campaign (' + CONVERT (VARCHAR (5), @SalesDays) + ' days)' ELSE 'Post-Campaign (' + CONVERT (VARCHAR (5), @SalesDays) + ' days)' END</td>
        <td>196</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.InitialVisitDateTime BETWEEN AwardDateTime - @SalesDays AND AwardDateTime THEN 2 ELSE 3 END</td>
        <td>197</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.InitialVisitDateTime BETWEEN AwardDateTime - @SalesDays AND AwardDateTime THEN ' Pre-Campaign (' + CONVERT (VARCHAR (5), @SalesDays) + ' days)' ELSE 'Post-Campaign (' + CONVERT (VARCHAR (5), @SalesDays) + ' days)' END</td>
        <td>326</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.InitialVisitDateTime BETWEEN AwardDateTime - @SalesDays AND AwardDateTime THEN 2 ELSE 3 END</td>
        <td>327</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.InitialVisitDateTime BETWEEN AwardDateTime - @SalesDays AND AwardDateTime THEN ' Pre-Campaign (' + CONVERT (VARCHAR (5), @SalesDays) + ' days)' ELSE 'Post-Campaign (' + CONVERT (VARCHAR (5), @SalesDays) + ' days)' END</td>
        <td>360</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.InitialVisitDateTime BETWEEN AwardDateTime - @SalesDays AND AwardDateTime THEN 2 ELSE 3 END</td>
        <td>361</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SUM(Pieces) = 0 THEN 1 ELSE SUM(Pieces) END</td>
        <td>374</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SUM(NumCust) = 0 THEN 1 ELSE SUM(NumCust) END</td>
        <td>375</td>
      </tr>
    </table>
  </body>
</html>