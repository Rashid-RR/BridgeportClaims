<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [API_SPOT2000].[SPReport_MobileUsage]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [API_SPOT2000].[SPReport_MobileUsage]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>3/11/2019 10:31 AM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">APPLY</td>
        <td colspan="1">ClientAccount AS CA WITH (NOLOCK)
INNER JOIN
fnGUIDListToTable(@SelectedSites) AS SELECTED_SITES
ON CA.SPAccountNodeID = SELECTED_SITES.ID
INNER JOIN
ESM_SPAccountNode AS SPAccountNode WITH (NOLOCK)
ON SELECTED_SITES.ID = SPAccountNode.InstanceID CROSS APPLY (SELECT   TOP 1 EventDateTime,
                                                                            Comments
                                                             FROM     ClientAccountEvent AS CAE WITH (NOLOCK)
                                                             WHERE    CA.InstanceID = CAE.ClientAccountID
                                                                      AND CAE.Specifier1 = 'Customer Login'
                                                                      AND CAE.Specifier2 = 'System Event'
                                                                      AND CAE.Comments IS NOT NULL
                                                                      AND CAE.EventDateTime BETWEEN @StartDateTime AND @EndDateTime
                                                             ORDER BY InstanceNumber DESC) AS LASTTIME CROSS APPLY (SELECT DISTINCT dbo.dateNoTime(EventDateTime) AS LoginDate
                                                                                                                    FROM   ClientAccountEvent AS CAE2 WITH (NOLOCK)
                                                                                                                    WHERE  CA.InstanceID = CAE2.ClientAccountID
                                                                                                                           AND CAE2.Specifier1 = 'Customer Login'
                                                                                                                           AND CAE2.Specifier2 = 'System Event'
                                                                                                                           AND CAE2.Comments IS NOT NULL
                                                                                                                           AND CAE2.EventDateTime BETWEEN @StartDateTime AND @EndDateTime) AS ALLTIMES</td>
        <td>16</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount AS CA WITH (NOLOCK)
INNER JOIN
fnGUIDListToTable(@SelectedSites) AS SELECTED_SITES
ON CA.SPAccountNodeID = SELECTED_SITES.ID
INNER JOIN
ESM_SPAccountNode AS SPAccountNode WITH (NOLOCK)
ON SELECTED_SITES.ID = SPAccountNode.InstanceID CROSS APPLY (SELECT   TOP 1 EventDateTime,
                                                                            Comments
                                                             FROM     ClientAccountEvent AS CAE WITH (NOLOCK)
                                                             WHERE    CA.InstanceID = CAE.ClientAccountID
                                                                      AND CAE.Specifier1 = 'Customer Login'
                                                                      AND CAE.Specifier2 = 'System Event'
                                                                      AND CAE.Comments IS NOT NULL
                                                                      AND CAE.EventDateTime BETWEEN @StartDateTime AND @EndDateTime
                                                             ORDER BY InstanceNumber DESC) AS LASTTIME</td>
        <td>16</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">ClientAccount AS CA WITH (NOLOCK)</td>
        <td>16</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS SPAccountNode WITH (NOLOCK)</td>
        <td>18</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountEvent AS CAE WITH (NOLOCK)</td>
        <td>19</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountEvent AS CAE2 WITH (NOLOCK)</td>
        <td>26</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">NOLOCK</td>
        <td colspan="1">NOLOCK</td>
        <td>16</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>18</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>19</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>26</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Table-valued functions</td>
        <td colspan="1">fnGUIDListToTable(@SelectedSites) AS SELECTED_SITES</td>
        <td>17</td>
      </tr>
    </table>
  </body>
</html>