<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [API_SPOT2000].[SPBusiness_SellOrders]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [API_SPOT2000].[SPBusiness_SellOrders]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>3/11/2019 10:32 AM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>10</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">@@trancount</td>
        <td colspan="1">@@TRANCOUNT</td>
        <td>13</td>
      </tr>
      <tr valign="top">
        <td colspan="1">BEGIN TRANSACTION</td>
        <td colspan="1">BEGIN TRANSACTION</td>
        <td>16</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">BEGIN TRANSACTION</td>
        <td>493</td>
      </tr>
      <tr valign="top">
        <td colspan="1">One-part names</td>
        <td colspan="1">Setting WITH (NOLOCK)</td>
        <td>30</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>48</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">PaymentSessionPayment WITH (NOLOCK)</td>
        <td>133</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>148</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)</td>
        <td>209</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)</td>
        <td>227</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>227</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoicePayment</td>
        <td>229</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">PaymentSessionPayment AS PSP WITH (NOLOCK)</td>
        <td>232</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoiceHistory WITH (NOLOCK)</td>
        <td>246</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Invoice</td>
        <td>291</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoiceException</td>
        <td>304</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">InvoiceHistory</td>
        <td>327</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoiceHistory WITH (NOLOCK)</td>
        <td>357</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">InvoiceHistoryInventoryStatus</td>
        <td>365</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoiceHistoryTaxDetail WITH (NOLOCK)</td>
        <td>369</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">InvoiceHistory WITH (NOLOCK)</td>
        <td>369</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoiceHistoryTaxDetail WITH (NOLOCK)</td>
        <td>386</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">InvoiceHistory WITH (NOLOCK)</td>
        <td>386</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoiceHistoryTaxDetail</td>
        <td>394</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">InvoiceHistory WITH (NOLOCK)</td>
        <td>403</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoiceHistoryTaxDetail WITH (NOLOCK)</td>
        <td>403</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">InvoicePayment</td>
        <td>411</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">InvoicePayment</td>
        <td>415</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">PaymentSessionInvoice</td>
        <td>419</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">GLEntry</td>
        <td>423</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">PaymentSession</td>
        <td>454</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">PaymentSessionPayment</td>
        <td>459</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountCredit</td>
        <td>471</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount</td>
        <td>475</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">PaymentSessionPayment</td>
        <td>480</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CCTransSeq</td>
        <td>495</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CCTransSeq</td>
        <td>496</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">PaymentSessionPayment</td>
        <td>501</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">PaymentSessionPayment</td>
        <td>512</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountAccountsOnFile WITH (NOLOCK)</td>
        <td>519</td>
      </tr>
      <tr valign="top">
        <td colspan="1">NOLOCK</td>
        <td colspan="1">NOLOCK</td>
        <td>30</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>48</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>133</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>148</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>209</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>227</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>227</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>232</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>246</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>357</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>369</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>369</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>386</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>386</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>403</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>403</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>519</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">ROLLBACK TRANSACTION</td>
        <td colspan="1">ROLLBACK</td>
        <td>43</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ROLLBACK</td>
        <td>54</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ROLLBACK</td>
        <td>94</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ROLLBACK</td>
        <td>267</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ROLLBACK</td>
        <td>444</td>
      </tr>
      <tr valign="top">
        <td colspan="1">Subquery</td>
        <td colspan="1">(SELECT   TOP 1 InstanceID
 FROM     ClientAccount WITH (NOLOCK)
 WHERE    LexicalKey = @ClientID
 ORDER BY InstanceNumber DESC)</td>
        <td>48</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">(SELECT   TOP 1 TenderTypeID
 FROM     PaymentSessionPayment WITH (NOLOCK)
 WHERE    TenderTypeToken = @TenderTypeToken
 ORDER BY InstanceNumber DESC)</td>
        <td>133</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">(SELECT CashCreditBalance
 FROM   ClientAccount WITH (NOLOCK)
 WHERE  InstanceID = @ClientAccountID)</td>
        <td>148</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">ISNUMERIC</td>
        <td colspan="1">IsNumeric(RIGHT(@ExternalCCPaymentInfo, 4))</td>
        <td>71</td>
      </tr>
      <tr valign="top">
        <td colspan="1">RIGHT</td>
        <td colspan="1">RIGHT(@ExternalCCPaymentInfo, 4)</td>
        <td>71</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RIGHT(@ExternalCCPaymentInfo, 4)</td>
        <td>73</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">RIGHT(@ExternalCCPaymentInfo, 4)</td>
        <td>75</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RIGHT(@ExternalCCPaymentInfo, 4)</td>
        <td>77</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">RIGHT(@ExternalCCPaymentInfo, 4)</td>
        <td>79</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">LEFT</td>
        <td colspan="1">LEFT(@ExternalCCPaymentInfo, 1)</td>
        <td>72</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">LEFT(@ExternalCCPaymentInfo, 4)</td>
        <td>72</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">LEFT(@ExternalCCPaymentInfo, 1)</td>
        <td>74</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">LEFT(@ExternalCCPaymentInfo, 2)</td>
        <td>74</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">LEFT(@ExternalCCPaymentInfo, 1)</td>
        <td>76</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">LEFT(@ExternalCCPaymentInfo, 4)</td>
        <td>76</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">LEFT(@ExternalCCPaymentInfo, 1)</td>
        <td>78</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">LEFT(@ExternalCCPaymentInfo, 4)</td>
        <td>78</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">LEFT(@TenderInfo, CharIndex(' ', @TenderInfo) - 1)</td>
        <td>126</td>
      </tr>
      <tr valign="top">
        <td colspan="1">UPPER</td>
        <td colspan="1">UPPER(LEFT(@ExternalCCPaymentInfo, 4))</td>
        <td>72</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">UPPER(LEFT(@ExternalCCPaymentInfo, 2))</td>
        <td>74</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">UPPER(LEFT(@ExternalCCPaymentInfo, 4))</td>
        <td>76</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">UPPER(LEFT(@ExternalCCPaymentInfo, 4))</td>
        <td>78</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CHARINDEX</td>
        <td colspan="1">CharIndex('*', @TenderInfo)</td>
        <td>85</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CharIndex('*', @TenderInfo)</td>
        <td>120</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CharIndex(' ', @TenderInfo)</td>
        <td>126</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">LIKE</td>
        <td colspan="1">@TenderInfo LIKE 'ACCT %'</td>
        <td>106</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN @PaymentType = 'R' THEN 289 WHEN @PaymentType = 'P' THEN 286 ELSE 316 END</td>
        <td>196</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN PSP.StatusID = 117 THEN 1 ELSE 0 END</td>
        <td>226</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN DeclinedPayment = 1 THEN 0 ELSE Balance END</td>
        <td>252</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @RackLocation IS NOT NULL THEN IsNull(RackedDateTime, @SellDate) ELSE RackedDateTime END</td>
        <td>293</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @RackLocation IS NOT NULL THEN @SellDate ELSE ReadyDateTime END</td>
        <td>294</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @TenderInfo = '-'
          AND @ExternalCCPayment = 0 THEN Balance ELSE 0 END</td>
        <td>296</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ((@TenderInfo = '-'
            AND @ExternalCCPayment = 0
            AND @InvoiceBalance &gt; 0)
           OR (@DeclinedPayment = 1
               AND PaymentExceptionStatusID &gt; 0)) THEN 322 ELSE 0 END</td>
        <td>297</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @TenderTypeToken = 'ACCT'
          OR @ExternalCCPayment = 1
          OR (@CashCreditAmount = @InvoiceBalance
              AND @CashCreditAmount &lt;&gt; 0) THEN '' ELSE ' (Authorization pending)' END</td>
        <td>322</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @ExternalCCPayment = 1 THEN @InvoiceBalance ELSE 0 END</td>
        <td>345</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @TenderTypeToken = 'ACCT' THEN @InvoiceBalance - @CashCreditAmount ELSE 0 END</td>
        <td>345</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @TenderInfo = '-'
          AND @ExternalCCPayment = 0 THEN @InvoiceBalance ELSE 0 END</td>
        <td>345</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @TenderInfo = '-'
          AND @ExternalCCPayment = 0 THEN 0 ELSE -@InvoiceBalance END</td>
        <td>347</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @TenderTypeToken = 'ACCT'
          OR @TenderInfo = '-'
          OR @ExternalCCPayment = 1 THEN 0 ELSE @InvoiceBalance - @CashCreditAmount END</td>
        <td>347</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @TenderInfo = '-'
          AND @ExternalCCPayment = 0 THEN 0 ELSE 1 END</td>
        <td>348</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @TenderInfo = '-'
          AND @ExternalCCPayment = 0 THEN 1 ELSE 0 END</td>
        <td>348</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @TenderInfo = '-'
          AND @ExternalCCPayment = 0 THEN @InvoiceBalance ELSE 0 END</td>
        <td>348</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN NonenviroableTotal &gt; 0
          AND Balance &gt; 0
          AND (@TenderTypeToken = 'ACCT'
               OR @ExternalCCPayment = 1) THEN NonenviroableTotal - @NonenviroablePaidTotal ELSE 0 END</td>
        <td>350</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN EnviroableTotal &gt; 0
          AND Balance &gt; 0
          AND (@TenderTypeToken = 'ACCT'
               OR @ExternalCCPayment = 1) THEN EnviroableTotal - @EnviroablePaidTotal ELSE 0 END</td>
        <td>351</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN EnviroTotal &gt; 0
          AND Balance &gt; 0
          AND (@TenderTypeToken = 'ACCT'
               OR @ExternalCCPayment = 1) THEN EnviroTotal - @EnviroPaidTotal ELSE 0 END</td>
        <td>352</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN NontaxableTotal &gt; 0
          AND Balance &gt; 0
          AND (@TenderTypeToken = 'ACCT'
               OR @ExternalCCPayment = 1) THEN NontaxableTotal - @NontaxablePaidTotal ELSE 0 END</td>
        <td>353</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN TaxableTotal &gt; 0
          AND Balance &gt; 0
          AND (@TenderTypeToken = 'ACCT'
               OR @ExternalCCPayment = 1) THEN TaxableTotal - @TaxablePaidTotal ELSE 0 END</td>
        <td>354</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN TaxTotal &gt; 0
          AND Balance &gt; 0
          AND (@TenderTypeToken = 'ACCT'
               OR @ExternalCCPayment = 1) THEN TaxTotal - @TaxPaidTotal ELSE 0 END</td>
        <td>355</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN TaxablePaid &gt; 0
          AND (@TenderInfo &lt;&gt; '-'
               OR @ExternalCCPayment = 1) THEN TaxableTotal2 - @TaxablePaid2Total ELSE 0 END</td>
        <td>401</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN TaxPaid &gt; 0
          AND (@TenderInfo &lt;&gt; '-'
               OR @ExternalCCPayment = 1) THEN TaxTotal2 - @TaxPaid2Total ELSE 0 END</td>
        <td>402</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @TotalBalance = @InvoiceBalance THEN ' against invoice ' + @InvoiceKey ELSE '' END</td>
        <td>466</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @TotalBalance = @InvoiceBalance THEN ' against invoice ' + @InvoiceKey ELSE '' END</td>
        <td>487</td>
      </tr>
      <tr valign="top">
        <td colspan="1">Cursors</td>
        <td colspan="1">CURSOR
    FOR SELECT Val
        FROM   fnVarcharListToTable(@InvoiceList)</td>
        <td>203</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Table-valued functions</td>
        <td colspan="1">fnVarcharListToTable(@InvoiceList)</td>
        <td>203</td>
      </tr>
      <tr valign="top">
        <td colspan="1">FETCH CURSOR</td>
        <td colspan="1">FETCH NEXT FROM InvoiceCursor INTO @InvoiceKey</td>
        <td>205</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM InvoiceCursor INTO @InvoiceKey</td>
        <td>436</td>
      </tr>
      <tr valign="top">
        <td colspan="1">@@fetch_status</td>
        <td colspan="1">@@FETCH_STATUS</td>
        <td>206</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">APPLY</td>
        <td colspan="1">Invoice WITH (NOLOCK)
INNER JOIN
ClientAccount WITH (NOLOCK)
ON ClientAccountID = ClientAccount.InstanceID OUTER APPLY (SELECT   TOP 1 PaymentSessionPaymentID,
                                                                          AppliedAmount
                                                           FROM     InvoicePayment
                                                           WHERE    InvoiceID = Invoice.InstanceID
                                                                    AND AppliedAmount = Invoice.Price
                                                           ORDER BY InstanceNumber DESC) AS IP</td>
        <td>227</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CHAR</td>
        <td colspan="1">CHAR(13)</td>
        <td>320</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CHAR(10)</td>
        <td>320</td>
      </tr>
      <tr valign="top">
        <td colspan="1">COMMIT TRANSACTION</td>
        <td colspan="1">COMMIT TRANSACTION</td>
        <td>498</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COMMIT TRANSACTION</td>
        <td>532</td>
      </tr>
    </table>
  </body>
</html>