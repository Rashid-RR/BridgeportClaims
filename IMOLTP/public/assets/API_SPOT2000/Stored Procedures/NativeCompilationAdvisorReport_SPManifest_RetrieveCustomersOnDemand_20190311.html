<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [API_SPOT2000].[SPManifest_RetrieveCustomersOnDemand]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [API_SPOT2000].[SPManifest_RetrieveCustomersOnDemand]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>3/11/2019 10:30 AM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN RouteStop.RouteID IS NOT NULL
          AND RouteStop.RouteID = @RouteID THEN RouteStop.StopNumber ELSE 0 END</td>
        <td>27</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN RouteStop.RouteID IS NOT NULL
          AND RouteStop.RouteID = @RouteID THEN RouteStopClientAccount.Ordinal ELSE 0 END</td>
        <td>28</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN RouteStop.InstanceID IS NULL THEN 1 ELSE 0 END</td>
        <td>31</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN IsNull(RouteStop.ScanAtDelivery, '--') = '--'
          OR RouteStop.ScanAtDelivery = '' THEN CASE WHEN Route.DefaultScanAtDelivery = '' THEN 'RA' ELSE IsNull(Route.DefaultScanAtDelivery, 'RA') END ELSE RouteStop.ScanAtDelivery END</td>
        <td>48</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Route.DefaultScanAtDelivery = '' THEN 'RA' ELSE IsNull(Route.DefaultScanAtDelivery, 'RA') END</td>
        <td>49</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.AddressTypeID ELSE 304 END</td>
        <td>82</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.Address1 ELSE ClientAccountRouteInfoExceptions.Address1 END</td>
        <td>83</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.Address2 ELSE ClientAccountRouteInfoExceptions.Address2 END</td>
        <td>84</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.City ELSE ClientAccountRouteInfoExceptions.City END</td>
        <td>85</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.State ELSE ClientAccountRouteInfoExceptions.State END</td>
        <td>86</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN dbo.FormatStringWithMask(RouteAddress.PostalCode, RouteAddress.PostalCodeMask) ELSE dbo.FormatStringWithMask(ClientAccountRouteInfoExceptions.PostalCode, ClientAccountRouteInfoExceptions.PostalCodeMask) END</td>
        <td>87</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.AddressUpdateID ELSE -1 END</td>
        <td>88</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.GeoStatus ELSE 0 END</td>
        <td>89</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.Latitude ELSE 0 END</td>
        <td>90</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.Longitude ELSE 0 END</td>
        <td>91</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN IsNull(ClientAccount.Locker, '') IN ('Y', 'P') THEN 1 ELSE 0 END</td>
        <td>93</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.CurrentStatusID = 128 THEN 1 ELSE 0 END</td>
        <td>108</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.CurrentStatusID = 129 THEN 1 ELSE 0 END</td>
        <td>109</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN RouteStop.RouteID IS NOT NULL
          AND RouteStop.RouteID = @RouteID THEN RouteStop.StopNumber ELSE 0 END</td>
        <td>137</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN RouteStop.RouteID IS NOT NULL
          AND RouteStop.RouteID = @RouteID THEN RouteStopClientAccount.Ordinal ELSE 0 END</td>
        <td>138</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN RouteStop.InstanceID IS NULL THEN 1 ELSE 0 END</td>
        <td>141</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN IsNull(RouteStop.ScanAtDelivery, '--') = '--'
          OR RouteStop.ScanAtDelivery = '' THEN CASE WHEN Route.DefaultScanAtDelivery = '' THEN 'RA' ELSE IsNull(Route.DefaultScanAtDelivery, 'RA') END ELSE RouteStop.ScanAtDelivery END</td>
        <td>158</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Route.DefaultScanAtDelivery = '' THEN 'RA' ELSE IsNull(Route.DefaultScanAtDelivery, 'RA') END</td>
        <td>159</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN MH.ClientAccountID IS NULL THEN 'N' ELSE 'S' END</td>
        <td>180</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.AddressTypeID ELSE 304 END</td>
        <td>192</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.Address1 ELSE ClientAccountRouteInfoExceptions.Address1 END</td>
        <td>193</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.Address2 ELSE ClientAccountRouteInfoExceptions.Address2 END</td>
        <td>194</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.City ELSE ClientAccountRouteInfoExceptions.City END</td>
        <td>195</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.State ELSE ClientAccountRouteInfoExceptions.State END</td>
        <td>196</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN dbo.FormatStringWithMask(RouteAddress.PostalCode, RouteAddress.PostalCodeMask) ELSE dbo.FormatStringWithMask(ClientAccountRouteInfoExceptions.PostalCode, ClientAccountRouteInfoExceptions.PostalCodeMask) END</td>
        <td>197</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.AddressUpdateID ELSE -1 END</td>
        <td>198</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.GeoStatus ELSE 0 END</td>
        <td>199</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.Latitude ELSE 0 END</td>
        <td>200</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.Longitude ELSE 0 END</td>
        <td>201</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN IsNull(ClientAccount.Locker, '') IN ('Y', 'P') THEN 1 ELSE 0 END</td>
        <td>203</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.CurrentStatusID = 128 THEN 1 ELSE 0 END</td>
        <td>223</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.CurrentStatusID = 129 THEN 1 ELSE 0 END</td>
        <td>224</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN RouteStop.RouteID IS NOT NULL
          AND RouteStop.RouteID = @RouteID THEN RouteStop.StopNumber ELSE 0 END</td>
        <td>260</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN RouteStop.RouteID IS NOT NULL
          AND RouteStop.RouteID = @RouteID THEN RouteStopClientAccount.Ordinal ELSE 0 END</td>
        <td>261</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN RouteStop.InstanceID IS NULL THEN 1 ELSE 0 END</td>
        <td>264</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN IsNull(RouteStop.ScanAtDelivery, '--') = '--'
          OR RouteStop.ScanAtDelivery = '' THEN CASE WHEN Route.DefaultScanAtDelivery = '' THEN 'RA' ELSE IsNull(Route.DefaultScanAtDelivery, 'RA') END ELSE RouteStop.ScanAtDelivery END</td>
        <td>281</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Route.DefaultScanAtDelivery = '' THEN 'RA' ELSE IsNull(Route.DefaultScanAtDelivery, 'RA') END</td>
        <td>282</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.AddressTypeID ELSE 304 END</td>
        <td>315</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.Address1 ELSE ClientAccountRouteInfoExceptions.Address1 END</td>
        <td>316</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.Address2 ELSE ClientAccountRouteInfoExceptions.Address2 END</td>
        <td>317</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.City ELSE ClientAccountRouteInfoExceptions.City END</td>
        <td>318</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.State ELSE ClientAccountRouteInfoExceptions.State END</td>
        <td>319</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN dbo.FormatStringWithMask(RouteAddress.PostalCode, RouteAddress.PostalCodeMask) ELSE dbo.FormatStringWithMask(ClientAccountRouteInfoExceptions.PostalCode, ClientAccountRouteInfoExceptions.PostalCodeMask) END</td>
        <td>320</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.AddressUpdateID ELSE -1 END</td>
        <td>321</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.GeoStatus ELSE 0 END</td>
        <td>322</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.Latitude ELSE 0 END</td>
        <td>323</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ClientAccountRouteInfoExceptions.Address1 IS NULL THEN RouteAddress.Longitude ELSE 0 END</td>
        <td>324</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN IsNull(ClientAccount.Locker, '') IN ('Y', 'P') THEN 1 ELSE 0 END</td>
        <td>326</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.CurrentStatusID = 128 THEN 1 ELSE 0 END</td>
        <td>341</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Invoice.CurrentStatusID = 129 THEN 1 ELSE 0 END</td>
        <td>342</td>
      </tr>
      <tr valign="top">
        <td colspan="1">APPLY</td>
        <td colspan="1">ClientAccount WITH (NOLOCK)
INNER JOIN
ClientAccountRouteInfoExceptions WITH (NOLOCK)
ON ClientAccount.InstanceID = ClientAccountRouteInfoExceptions.ClientAccountID
   AND ClientAccountRouteInfoExceptions.RouteID = @RouteID
   AND ClientAccountRouteInfoExceptions.EntryType = 'Visit'
   AND ClientAccountRouteInfoExceptions.ExceptionDate BETWEEN @ManifestDate AND @ManifestDateEnd
   AND TimeRange LIKE @TimeRangeSpec
LEFT OUTER JOIN
RouteStopClientAccount
ON ClientAccount.InstanceID = RouteStopClientAccount.ClientAccountID
LEFT OUTER JOIN
RouteStop
ON RouteStopClientAccount.RouteStopID = RouteStop.InstanceID
LEFT OUTER JOIN
Route WITH (NOLOCK)
ON Route.InstanceID = RouteStop.RouteID
LEFT OUTER JOIN
RouteStop AS LinkedStop WITH (NOLOCK)
ON LinkedStop.InstanceID = RouteStop.LinkedInstanceID
   AND LinkedStop.RouteID = RouteStop.RouteID
   AND RouteStop.InstanceID &lt;&gt; LinkedStop.InstanceID
LEFT OUTER JOIN
ClientAccountRouteInfo WITH (NOLOCK)
ON ClientAccountRouteInfo.ClientAccountID = ClientAccount.InstanceID
LEFT OUTER JOIN
ClientAccountAccountsOnFile WITH (NOLOCK)
ON ClientAccountAccountsOnFile.ClientAccountID = ClientAccount.InstanceID
   AND ClientAccountAccountsOnFile.AccountType = 1
   AND ClientAccountAccountsOnFile.AccountOrdinal = 1
LEFT OUTER JOIN
ClientAccountAccountsOnFileTerm WITH (NOLOCK)
ON ClientAccountAccountsOnFileTerm.ClientAccountAccountsOnFileID = ClientAccountAccountsOnFile.InstanceID OUTER APPLY dbo.fnGetClientAccountAddress(ClientAccount.InstanceID, ClientAccountRouteInfoExceptions.Address) AS RouteAddress OUTER APPLY (SELECT Sum(CASE WHEN Invoice.CurrentStatusID = 128 THEN 1 ELSE 0 END) AS OrderCountInProcess,
                                                                                                                                                                                                                                                            Sum(CASE WHEN Invoice.CurrentStatusID = 129 THEN 1 ELSE 0 END) AS OrderCountReady
                                                                                                                                                                                                                                                     FROM   Invoice WITH (NOLOCK)
                                                                                                                                                                                                                                                     WHERE  Invoice.ClientAccountID = ClientAccount.InstanceID
                                                                                                                                                                                                                                                            AND Invoice.RouteID = @RouteID
                                                                                                                                                                                                                                                            AND (Invoice.InvoiceMode &lt;&gt; 'Storage'
                                                                                                                                                                                                                                                                 OR (@RackLocation &lt;&gt; ''
                                                                                                                                                                                                                                                                     AND Invoice.Racklocation = @RackLocation))
                                                                                                                                                                                                                                                            AND Invoice.Voided = 0
                                                                                                                                                                                                                                                            AND ((Invoice.CurrentStatusID = 129
                                                                                                                                                                                                                                                                  AND (@RackLocation = ''
                                                                                                                                                                                                                                                                       OR Invoice.Racklocation = @RackLocation))
                                                                                                                                                                                                                                                                 OR ((@ShowReadyOrdersOnly = 0
                                                                                                                                                                                                                                                                      OR @ShowDelayedOrders &lt;&gt; 0)
                                                                                                                                                                                                                                                                     AND Invoice.CurrentStatusID = 128
                                                                                                                                                                                                                                                                     AND Invoice.PromisedDate &lt;= @ManifestDateEnd))) AS OC</td>
        <td>98</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)
INNER JOIN
ClientAccountRouteInfoExceptions WITH (NOLOCK)
ON ClientAccount.InstanceID = ClientAccountRouteInfoExceptions.ClientAccountID
   AND ClientAccountRouteInfoExceptions.RouteID = @RouteID
   AND ClientAccountRouteInfoExceptions.EntryType = 'Visit'
   AND ClientAccountRouteInfoExceptions.ExceptionDate BETWEEN @ManifestDate AND @ManifestDateEnd
   AND TimeRange LIKE @TimeRangeSpec
LEFT OUTER JOIN
RouteStopClientAccount
ON ClientAccount.InstanceID = RouteStopClientAccount.ClientAccountID
LEFT OUTER JOIN
RouteStop
ON RouteStopClientAccount.RouteStopID = RouteStop.InstanceID
LEFT OUTER JOIN
Route WITH (NOLOCK)
ON Route.InstanceID = RouteStop.RouteID
LEFT OUTER JOIN
RouteStop AS LinkedStop WITH (NOLOCK)
ON LinkedStop.InstanceID = RouteStop.LinkedInstanceID
   AND LinkedStop.RouteID = RouteStop.RouteID
   AND RouteStop.InstanceID &lt;&gt; LinkedStop.InstanceID
LEFT OUTER JOIN
ClientAccountRouteInfo WITH (NOLOCK)
ON ClientAccountRouteInfo.ClientAccountID = ClientAccount.InstanceID
LEFT OUTER JOIN
ClientAccountAccountsOnFile WITH (NOLOCK)
ON ClientAccountAccountsOnFile.ClientAccountID = ClientAccount.InstanceID
   AND ClientAccountAccountsOnFile.AccountType = 1
   AND ClientAccountAccountsOnFile.AccountOrdinal = 1
LEFT OUTER JOIN
ClientAccountAccountsOnFileTerm WITH (NOLOCK)
ON ClientAccountAccountsOnFileTerm.ClientAccountAccountsOnFileID = ClientAccountAccountsOnFile.InstanceID OUTER APPLY dbo.fnGetClientAccountAddress(ClientAccount.InstanceID, ClientAccountRouteInfoExceptions.Address) AS RouteAddress</td>
        <td>98</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)
INNER JOIN
ClientAccountRouteInfoExceptions WITH (NOLOCK)
ON ClientAccount.InstanceID = ClientAccountRouteInfoExceptions.ClientAccountID
   AND ClientAccountRouteInfoExceptions.RouteID = @RouteID
   AND ClientAccountRouteInfoExceptions.EntryType = 'Visit'
   AND ClientAccountRouteInfoExceptions.ExceptionDate BETWEEN @ManifestDate AND @ManifestDateEnd
LEFT OUTER JOIN
RouteStopClientAccount
ON ClientAccount.InstanceID = RouteStopClientAccount.ClientAccountID
LEFT OUTER JOIN
RouteStop
ON RouteStopClientAccount.RouteStopID = RouteStop.InstanceID
LEFT OUTER JOIN
Route WITH (NOLOCK)
ON Route.InstanceID = RouteStop.RouteID
LEFT OUTER JOIN
RouteStop AS LinkedStop WITH (NOLOCK)
ON LinkedStop.InstanceID = RouteStop.LinkedInstanceID
   AND LinkedStop.RouteID = RouteStop.RouteID
   AND RouteStop.InstanceID &lt;&gt; LinkedStop.InstanceID
LEFT OUTER JOIN
ClientAccountRouteInfo WITH (NOLOCK)
ON ClientAccountRouteInfo.ClientAccountID = ClientAccount.InstanceID
LEFT OUTER JOIN
ClientAccountAccountsOnFile WITH (NOLOCK)
ON ClientAccountAccountsOnFile.ClientAccountID = ClientAccount.InstanceID
   AND ClientAccountAccountsOnFile.AccountType = 1
   AND ClientAccountAccountsOnFile.AccountOrdinal = 1
LEFT OUTER JOIN
ClientAccountAccountsOnFileTerm WITH (NOLOCK)
ON ClientAccountAccountsOnFileTerm.ClientAccountAccountsOnFileID = ClientAccountAccountsOnFile.InstanceID
LEFT OUTER JOIN
(SELECT DISTINCT ManifestHistoryStop.ClientAccountID
 FROM   ManifestHistoryStop WITH (NOLOCK)
        INNER JOIN
        ManifestHistory WITH (NOLOCK)
        ON ManifestHistory.InstanceID = ManifestHistoryStop.ManifestID
           AND ManifestHistory.ManifestDateTime = @ManifestDate
           AND ManifestHistory.InstanceNumber &gt;= @BaselineManifestID
           AND IsNull(ManifestHistory.Aborted, 0) = 0
        INNER JOIN
        Route WITH (NOLOCK)
        ON Route.Routename = ManifestHistory.RouteName
           AND Route.InstanceID = @RouteID) AS MH
ON MH.ClientAccountID = ClientAccount.InstanceID OUTER APPLY dbo.fnGetClientAccountAddress(ClientAccount.InstanceID, ClientAccountRouteInfoExceptions.Address) AS RouteAddress OUTER APPLY (SELECT Sum(CASE WHEN Invoice.CurrentStatusID = 128 THEN 1 ELSE 0 END) AS OrderCountInProcess,
                                                                                                                                                                                                   Sum(CASE WHEN Invoice.CurrentStatusID = 129 THEN 1 ELSE 0 END) AS OrderCountReady
                                                                                                                                                                                            FROM   Invoice WITH (NOLOCK)
                                                                                                                                                                                                   LEFT OUTER JOIN
                                                                                                                                                                                                   (SELECT ManifestHistoryInvoice.InvoiceID
                                                                                                                                                                                                    FROM   ManifestHistoryInvoice WITH (NOLOCK)
                                                                                                                                                                                                           INNER JOIN
                                                                                                                                                                                                           ManifestHistory WITH (NOLOCK)
                                                                                                                                                                                                           ON ManifestHistory.InstanceID = ManifestHistoryInvoice.ManifestID
                                                                                                                                                                                                              AND ManifestHistory.ManifestDateTime = @ManifestDate
                                                                                                                                                                                                              AND ManifestHistory.InstanceNumber &gt;= @BaselineManifestID
                                                                                                                                                                                                              AND IsNull(ManifestHistory.Aborted, 0) = 0
                                                                                                                                                                                                           INNER JOIN
                                                                                                                                                                                                           Route WITH (NOLOCK)
                                                                                                                                                                                                           ON Route.Routename = ManifestHistory.RouteName
                                                                                                                                                                                                              AND Route.InstanceID = @RouteID
                                                                                                                                                                                                    WHERE  ManifestHistoryInvoice.ManifestExclusionReasonID IS NULL
                                                                                                                                                                                                           AND ManifestHistoryInvoice.DelayedFlag IS NULL) AS MHI
                                                                                                                                                                                                   ON MHI.InvoiceID = Invoice.InstanceID
                                                                                                                                                                                            WHERE  MHI.InvoiceID IS NULL
                                                                                                                                                                                                   AND Invoice.ClientAccountID = ClientAccount.InstanceID
                                                                                                                                                                                                   AND Invoice.RouteID = @RouteID
                                                                                                                                                                                                   AND (Invoice.InvoiceMode &lt;&gt; 'Storage'
                                                                                                                                                                                                        OR (@RackLocation &lt;&gt; ''
                                                                                                                                                                                                            AND Invoice.Racklocation = @RackLocation))
                                                                                                                                                                                                   AND Invoice.Voided = 0
                                                                                                                                                                                                   AND ((Invoice.CurrentStatusID = 129
                                                                                                                                                                                                         AND (@RackLocation = ''
                                                                                                                                                                                                              OR Invoice.Racklocation = @RackLocation))
                                                                                                                                                                                                        OR ((@ShowReadyOrdersOnly = 0
                                                                                                                                                                                                             OR @ShowDelayedOrders &lt;&gt; 0)
                                                                                                                                                                                                            AND Invoice.CurrentStatusID = 128
                                                                                                                                                                                                            AND Invoice.PromisedDate &lt;= @ManifestDateEnd))) AS OC</td>
        <td>208</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)
INNER JOIN
ClientAccountRouteInfoExceptions WITH (NOLOCK)
ON ClientAccount.InstanceID = ClientAccountRouteInfoExceptions.ClientAccountID
   AND ClientAccountRouteInfoExceptions.RouteID = @RouteID
   AND ClientAccountRouteInfoExceptions.EntryType = 'Visit'
   AND ClientAccountRouteInfoExceptions.ExceptionDate BETWEEN @ManifestDate AND @ManifestDateEnd
LEFT OUTER JOIN
RouteStopClientAccount
ON ClientAccount.InstanceID = RouteStopClientAccount.ClientAccountID
LEFT OUTER JOIN
RouteStop
ON RouteStopClientAccount.RouteStopID = RouteStop.InstanceID
LEFT OUTER JOIN
Route WITH (NOLOCK)
ON Route.InstanceID = RouteStop.RouteID
LEFT OUTER JOIN
RouteStop AS LinkedStop WITH (NOLOCK)
ON LinkedStop.InstanceID = RouteStop.LinkedInstanceID
   AND LinkedStop.RouteID = RouteStop.RouteID
   AND RouteStop.InstanceID &lt;&gt; LinkedStop.InstanceID
LEFT OUTER JOIN
ClientAccountRouteInfo WITH (NOLOCK)
ON ClientAccountRouteInfo.ClientAccountID = ClientAccount.InstanceID
LEFT OUTER JOIN
ClientAccountAccountsOnFile WITH (NOLOCK)
ON ClientAccountAccountsOnFile.ClientAccountID = ClientAccount.InstanceID
   AND ClientAccountAccountsOnFile.AccountType = 1
   AND ClientAccountAccountsOnFile.AccountOrdinal = 1
LEFT OUTER JOIN
ClientAccountAccountsOnFileTerm WITH (NOLOCK)
ON ClientAccountAccountsOnFileTerm.ClientAccountAccountsOnFileID = ClientAccountAccountsOnFile.InstanceID
LEFT OUTER JOIN
(SELECT DISTINCT ManifestHistoryStop.ClientAccountID
 FROM   ManifestHistoryStop WITH (NOLOCK)
        INNER JOIN
        ManifestHistory WITH (NOLOCK)
        ON ManifestHistory.InstanceID = ManifestHistoryStop.ManifestID
           AND ManifestHistory.ManifestDateTime = @ManifestDate
           AND ManifestHistory.InstanceNumber &gt;= @BaselineManifestID
           AND IsNull(ManifestHistory.Aborted, 0) = 0
        INNER JOIN
        Route WITH (NOLOCK)
        ON Route.Routename = ManifestHistory.RouteName
           AND Route.InstanceID = @RouteID) AS MH
ON MH.ClientAccountID = ClientAccount.InstanceID OUTER APPLY dbo.fnGetClientAccountAddress(ClientAccount.InstanceID, ClientAccountRouteInfoExceptions.Address) AS RouteAddress</td>
        <td>208</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)
INNER JOIN
ClientAccountRouteInfoExceptions WITH (NOLOCK)
ON ClientAccount.InstanceID = ClientAccountRouteInfoExceptions.ClientAccountID
   AND ClientAccountRouteInfoExceptions.RouteID = @RouteID
   AND ClientAccountRouteInfoExceptions.EntryType = 'Visit'
   AND ClientAccountRouteInfoExceptions.ExceptionDate BETWEEN @ManifestDate AND @ManifestDateEnd
LEFT OUTER JOIN
RouteStopClientAccount
ON ClientAccount.InstanceID = RouteStopClientAccount.ClientAccountID
LEFT OUTER JOIN
RouteStop
ON RouteStopClientAccount.RouteStopID = RouteStop.InstanceID
LEFT OUTER JOIN
Route WITH (NOLOCK)
ON Route.InstanceID = RouteStop.RouteID
LEFT OUTER JOIN
RouteStop AS LinkedStop WITH (NOLOCK)
ON LinkedStop.InstanceID = RouteStop.LinkedInstanceID
   AND LinkedStop.RouteID = RouteStop.RouteID
   AND RouteStop.InstanceID &lt;&gt; LinkedStop.InstanceID
LEFT OUTER JOIN
ClientAccountRouteInfo WITH (NOLOCK)
ON ClientAccountRouteInfo.ClientAccountID = ClientAccount.InstanceID
LEFT OUTER JOIN
ClientAccountAccountsOnFile WITH (NOLOCK)
ON ClientAccountAccountsOnFile.ClientAccountID = ClientAccount.InstanceID
   AND ClientAccountAccountsOnFile.AccountType = 1
   AND ClientAccountAccountsOnFile.AccountOrdinal = 1
LEFT OUTER JOIN
ClientAccountAccountsOnFileTerm WITH (NOLOCK)
ON ClientAccountAccountsOnFileTerm.ClientAccountAccountsOnFileID = ClientAccountAccountsOnFile.InstanceID OUTER APPLY dbo.fnGetClientAccountAddress(ClientAccount.InstanceID, ClientAccountRouteInfoExceptions.Address) AS RouteAddress OUTER APPLY (SELECT Sum(CASE WHEN Invoice.CurrentStatusID = 128 THEN 1 ELSE 0 END) AS OrderCountInProcess,
                                                                                                                                                                                                                                                            Sum(CASE WHEN Invoice.CurrentStatusID = 129 THEN 1 ELSE 0 END) AS OrderCountReady
                                                                                                                                                                                                                                                     FROM   Invoice WITH (NOLOCK)
                                                                                                                                                                                                                                                     WHERE  Invoice.ClientAccountID = ClientAccount.InstanceID
                                                                                                                                                                                                                                                            AND Invoice.RouteID = @RouteID
                                                                                                                                                                                                                                                            AND (Invoice.InvoiceMode &lt;&gt; 'Storage'
                                                                                                                                                                                                                                                                 OR (@RackLocation &lt;&gt; ''
                                                                                                                                                                                                                                                                     AND Invoice.Racklocation = @RackLocation))
                                                                                                                                                                                                                                                            AND Invoice.Voided = 0
                                                                                                                                                                                                                                                            AND ((Invoice.CurrentStatusID = 129
                                                                                                                                                                                                                                                                  AND (@RackLocation = ''
                                                                                                                                                                                                                                                                       OR Invoice.Racklocation = @RackLocation))
                                                                                                                                                                                                                                                                 OR ((@ShowReadyOrdersOnly = 0
                                                                                                                                                                                                                                                                      OR @ShowDelayedOrders &lt;&gt; 0)
                                                                                                                                                                                                                                                                     AND Invoice.CurrentStatusID = 128
                                                                                                                                                                                                                                                                     AND Invoice.PromisedDate &lt;= @ManifestDateEnd))) AS OC</td>
        <td>331</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)
INNER JOIN
ClientAccountRouteInfoExceptions WITH (NOLOCK)
ON ClientAccount.InstanceID = ClientAccountRouteInfoExceptions.ClientAccountID
   AND ClientAccountRouteInfoExceptions.RouteID = @RouteID
   AND ClientAccountRouteInfoExceptions.EntryType = 'Visit'
   AND ClientAccountRouteInfoExceptions.ExceptionDate BETWEEN @ManifestDate AND @ManifestDateEnd
LEFT OUTER JOIN
RouteStopClientAccount
ON ClientAccount.InstanceID = RouteStopClientAccount.ClientAccountID
LEFT OUTER JOIN
RouteStop
ON RouteStopClientAccount.RouteStopID = RouteStop.InstanceID
LEFT OUTER JOIN
Route WITH (NOLOCK)
ON Route.InstanceID = RouteStop.RouteID
LEFT OUTER JOIN
RouteStop AS LinkedStop WITH (NOLOCK)
ON LinkedStop.InstanceID = RouteStop.LinkedInstanceID
   AND LinkedStop.RouteID = RouteStop.RouteID
   AND RouteStop.InstanceID &lt;&gt; LinkedStop.InstanceID
LEFT OUTER JOIN
ClientAccountRouteInfo WITH (NOLOCK)
ON ClientAccountRouteInfo.ClientAccountID = ClientAccount.InstanceID
LEFT OUTER JOIN
ClientAccountAccountsOnFile WITH (NOLOCK)
ON ClientAccountAccountsOnFile.ClientAccountID = ClientAccount.InstanceID
   AND ClientAccountAccountsOnFile.AccountType = 1
   AND ClientAccountAccountsOnFile.AccountOrdinal = 1
LEFT OUTER JOIN
ClientAccountAccountsOnFileTerm WITH (NOLOCK)
ON ClientAccountAccountsOnFileTerm.ClientAccountAccountsOnFileID = ClientAccountAccountsOnFile.InstanceID OUTER APPLY dbo.fnGetClientAccountAddress(ClientAccount.InstanceID, ClientAccountRouteInfoExceptions.Address) AS RouteAddress</td>
        <td>331</td>
      </tr>
      <tr valign="top">
        <td colspan="1">One-part names</td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>98</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountRouteInfoExceptions WITH (NOLOCK)</td>
        <td>99</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">RouteStopClientAccount</td>
        <td>100</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RouteStop</td>
        <td>101</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Route WITH (NOLOCK)</td>
        <td>102</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RouteStop AS LinkedStop WITH (NOLOCK)</td>
        <td>103</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountRouteInfo WITH (NOLOCK)</td>
        <td>104</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountAccountsOnFile WITH (NOLOCK)</td>
        <td>105</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountAccountsOnFileTerm WITH (NOLOCK)</td>
        <td>106</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)</td>
        <td>110</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>208</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountRouteInfoExceptions WITH (NOLOCK)</td>
        <td>209</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">RouteStopClientAccount</td>
        <td>210</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RouteStop</td>
        <td>211</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Route WITH (NOLOCK)</td>
        <td>212</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RouteStop AS LinkedStop WITH (NOLOCK)</td>
        <td>213</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountRouteInfo WITH (NOLOCK)</td>
        <td>214</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountAccountsOnFile WITH (NOLOCK)</td>
        <td>215</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountAccountsOnFileTerm WITH (NOLOCK)</td>
        <td>216</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ManifestHistoryStop WITH (NOLOCK)</td>
        <td>218</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ManifestHistory WITH (NOLOCK)</td>
        <td>219</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Route WITH (NOLOCK)</td>
        <td>220</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)</td>
        <td>225</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ManifestHistoryInvoice WITH (NOLOCK)</td>
        <td>227</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ManifestHistory WITH (NOLOCK)</td>
        <td>228</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Route WITH (NOLOCK)</td>
        <td>229</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccount WITH (NOLOCK)</td>
        <td>331</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountRouteInfoExceptions WITH (NOLOCK)</td>
        <td>332</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">RouteStopClientAccount</td>
        <td>333</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RouteStop</td>
        <td>334</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Route WITH (NOLOCK)</td>
        <td>335</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RouteStop AS LinkedStop WITH (NOLOCK)</td>
        <td>336</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountRouteInfo WITH (NOLOCK)</td>
        <td>337</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountAccountsOnFile WITH (NOLOCK)</td>
        <td>338</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ClientAccountAccountsOnFileTerm WITH (NOLOCK)</td>
        <td>339</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Invoice WITH (NOLOCK)</td>
        <td>343</td>
      </tr>
      <tr valign="top">
        <td colspan="1">NOLOCK</td>
        <td colspan="1">NOLOCK</td>
        <td>98</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>99</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>102</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>103</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>104</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>105</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>106</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>110</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>208</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>209</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>212</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>213</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>214</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>215</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>216</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>218</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>219</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>220</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>225</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>227</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>228</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>229</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>331</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>332</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>335</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>336</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>337</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>338</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>339</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>343</td>
      </tr>
      <tr valign="top">
        <td colspan="1">LIKE</td>
        <td colspan="1">TimeRange LIKE @TimeRangeSpec</td>
        <td>99</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Table-valued functions</td>
        <td colspan="1">dbo.fnGetClientAccountAddress(ClientAccount.InstanceID, ClientAccountRouteInfoExceptions.Address) AS RouteAddress</td>
        <td>107</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">dbo.fnGetClientAccountAddress(ClientAccount.InstanceID, ClientAccountRouteInfoExceptions.Address) AS RouteAddress</td>
        <td>222</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">dbo.fnGetClientAccountAddress(ClientAccount.InstanceID, ClientAccountRouteInfoExceptions.Address) AS RouteAddress</td>
        <td>340</td>
      </tr>
    </table>
  </body>
</html>