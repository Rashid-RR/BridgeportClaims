<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [API_SPOT2000].[SPReport_TimeClockByLaborCategory]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [API_SPOT2000].[SPReport_TimeClockByLaborCategory]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>3/11/2019 10:32 AM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>1</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">TimeClock AS TC WITH (NOLOCK)</td>
        <td>21</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPWorkstation AS SPW WITH (NOLOCK)</td>
        <td>22</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPAccountNode AS SPAN WITH (NOLOCK)</td>
        <td>24</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ESM_SPUser AS SPU WITH (NOLOCK)</td>
        <td>25</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">NOLOCK</td>
        <td colspan="1">NOLOCK</td>
        <td>21</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>22</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>24</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">NOLOCK</td>
        <td>25</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Table-valued functions</td>
        <td colspan="1">dbo.FNGuidListToTable(@SelectedSites) AS SITES</td>
        <td>23</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN (SELECT   SUM(Duration)
           FROM     @ByCat AS X
           WHERE    x.UserName = C.UserName
                    AND X.EntryDate &lt; C.EntryDate
                    AND X.Week1Date = C.Week1Date
           GROUP BY Username) &gt; 40 THEN 0.00 WHEN (SELECT   SUM(Duration)
                                                   FROM     @ByCat AS X
                                                   WHERE    x.UserName = C.UserName
                                                            AND X.EntryDate &lt;= C.EntryDate
                                                            AND X.Week1Date = C.Week1Date
                                                   GROUP BY Username) &gt; 40 THEN CASE WHEN Duration &gt;= 40 THEN 40.00 ELSE (40 - (SELECT   SUM(Duration)
                                                                                                                                FROM     @ByCat AS X
                                                                                                                                WHERE    x.UserName = C.UserName
                                                                                                                                         AND X.EntryDate &lt; C.EntryDate
                                                                                                                                         AND X.Week1Date = C.Week1Date
                                                                                                                                GROUP BY Username)) END ELSE C.Duration END</td>
        <td>68</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Duration &gt;= 40 THEN 40.00 ELSE (40 - (SELECT   SUM(Duration)
                                                FROM     @ByCat AS X
                                                WHERE    x.UserName = C.UserName
                                                         AND X.EntryDate &lt; C.EntryDate
                                                         AND X.Week1Date = C.Week1Date
                                                GROUP BY Username)) END</td>
        <td>72</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (SELECT   SUM(Duration)
           FROM     @ByCat AS X
           WHERE    x.UserName = C.UserName
                    AND X.EntryDate &lt; C.EntryDate
                    AND X.Week1Date = C.Week1Date
           GROUP BY Username) &gt; 40 THEN C.Duration WHEN (SELECT   SUM(Duration)
                                                         FROM     @ByCat AS X
                                                         WHERE    x.UserName = C.UserName
                                                                  AND X.EntryDate &lt;= C.EntryDate
                                                                  AND X.Week1Date = C.Week1Date
                                                         GROUP BY Username) &gt; 40 THEN (SELECT   SUM(Duration)
                                                                                       FROM     @ByCat AS X
                                                                                       WHERE    x.UserName = C.UserName
                                                                                                AND X.EntryDate &lt;= C.EntryDate
                                                                                                AND X.Week1Date = C.Week1Date
                                                                                       GROUP BY Username) - 40 ELSE 0.00 END</td>
        <td>79</td>
      </tr>
    </table>
  </body>
</html>