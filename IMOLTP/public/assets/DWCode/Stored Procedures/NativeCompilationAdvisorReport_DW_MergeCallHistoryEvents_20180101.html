<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeCallHistoryEvents]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeCallHistoryEvents]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:10 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO [dbo].[CallHistoryEvents]
 AS target
USING [ETL].[CallHistoryEvents] AS source ON (target.CallHistoryEventID = source.CallHistoryEventID)
WHEN MATCHED AND source.ActionID IN (1, 2, 3)
                 AND source.lastTouched &gt; target.lastTouched THEN UPDATE 
SET TimeStamp              = source.TimeStamp,
    CallHistoryEventTypeID = source.CallHistoryEventTypeID,
    MediaServer            = source.MediaServer,
    CallHandle             = source.CallHandle,
    RemoteDevice           = source.RemoteDevice,
    CauseCode              = source.CauseCode,
    ContactID              = source.ContactID,
    PeerContactID          = source.PeerContactID,
    ContextID              = source.ContextID,
    bus_no                 = source.bus_no,
    lastTouched            = source.lastTouched,
    ContactEndReasonID     = source.ContactEndReasonID
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (CallHistoryEventID, TimeStamp, CallHistoryEventTypeID, MediaServer, CallHandle, RemoteDevice, CauseCode, ContactID, PeerContactID, ContextID, bus_no, lastTouched, ContactEndReasonID) VALUES (source.CallHistoryEventID, source.TimeStamp, source.CallHistoryEventTypeID, source.MediaServer, source.CallHandle, source.RemoteDevice, source.CauseCode, source.ContactID, source.PeerContactID, source.ContextID, source.bus_no, source.lastTouched, source.ContactEndReasonID)</td>
        <td>5</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [dbo].[CallHistoryEvents]
 AS target
USING [ETL].[CallHistoryEvents] AS source ON (target.CallHistoryEventID = source.CallHistoryEventID)
WHEN MATCHED AND source.ActionID IN (1, 2, 3)
                 AND source.lastTouched &gt; target.lastTouched THEN UPDATE 
SET TimeStamp              = source.TimeStamp,
    CallHistoryEventTypeID = source.CallHistoryEventTypeID,
    MediaServer            = source.MediaServer,
    CallHandle             = source.CallHandle,
    RemoteDevice           = source.RemoteDevice,
    CauseCode              = source.CauseCode,
    ContactID              = source.ContactID,
    PeerContactID          = source.PeerContactID,
    ContextID              = source.ContextID,
    bus_no                 = source.bus_no,
    lastTouched            = source.lastTouched,
    ContactEndReasonID     = source.ContactEndReasonID
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (CallHistoryEventID, TimeStamp, CallHistoryEventTypeID, MediaServer, CallHandle, RemoteDevice, CauseCode, ContactID, PeerContactID, ContextID, bus_no, lastTouched, ContactEndReasonID) VALUES (source.CallHistoryEventID, source.TimeStamp, source.CallHistoryEventTypeID, source.MediaServer, source.CallHandle, source.RemoteDevice, source.CauseCode, source.ContactID, source.PeerContactID, source.ContextID, source.bus_no, source.lastTouched, source.ContactEndReasonID)</td>
        <td>5</td>
      </tr>
    </table>
  </body>
</html>