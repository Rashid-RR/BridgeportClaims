<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[API_GetSkillCallData]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[API_GetSkillCallData]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:10 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Subquery</td>
        <td colspan="1">(SELECT *
 FROM   [dbo].[Skills]
 WHERE  Skill_No = @skillNo
        AND Bus_No = @busNo)</td>
        <td>14</td>
      </tr>
      <tr valign="top">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT DISTINCT s.Skill_No,
                Skill_Name,
                s.Bus_No,
                WFOCountReskills
INTO   #FilteredSkillTable
FROM   [dbo].[Skills] AS s
       INNER JOIN
       dbo.fn_GetDataRoleFilterItems(@profileId, 'campaigns') AS v
       ON v.intValue = s.Campaign_no
          OR v.intValue = 0
WHERE  (@skillNo IS NULL
        OR s.Skill_No = @skillNo)
       AND s.Bus_No = @busNo</td>
        <td>21</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT DISTINCT clf.Bus_No,
                clf.Skill_No,
                dbo.fn_CalcQtrHourDateTime(clf.Header_Start_Date) AS QtrStartTime
INTO   #EndedContacts
FROM   [dbo].[Contact_Log_Footer] AS clf
       INNER JOIN
       #FilteredSkillTable AS fst
       ON (clf.Skill_No = fst.Skill_No)
WHERE  clf.Bus_No = @BusNo
       AND clf.Header_Start_Date &gt; DATEADD(hh, -8, @startDate)
       AND clf.Header_Start_Date &lt; @startDate
       AND clf.End_Date &gt;= @startDate
       AND clf.End_Date &lt; @endDate</td>
        <td>36</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT   tt.skill_no,
         SUM(CallCount) AS CallCount,
         SUM(InqueueTime) AS InqueueTime,
         SUM(InqueueCount) AS InqueueCount
INTO     #SkillData_EnteredQueue
FROM     (SELECT   s.skill_no,
                   dq.start_date,
                   SUM(ISNULL(dq.InQueue_Cnt, 0)) - CASE WHEN (s.WFOCountReskills = 1) THEN 0 ELSE SUM(ISNULL(dq.ReSkill_Cnt, 0)) END AS CallCount,
                   SUM(ISNULL(dq.InQueue_Cnt, 0)) AS InqueueCount,
                   SUM(ISNULL(dq.InQueue_time, 0)) AS InqueueTime
          FROM     [dbo].[dw_POC_ByQtrHour] AS dq
                   INNER JOIN
                   #FilteredSkillTable AS s
                   ON (dq.Skill_No = s.Skill_No)
          WHERE    dq.Bus_No = @BusNo
                   AND dq.start_date &gt;= @startDate
                   AND dq.start_date &lt; @endDate
          GROUP BY dq.start_date, s.skill_no, s.WFOCountReskills
          UNION
          SELECT   s.skill_no,
                   dq.start_date,
                   SUM(ISNULL(dq.InQueue_Cnt, 0)) - CASE WHEN (s.WFOCountReskills = 1) THEN 0 ELSE SUM(ISNULL(dq.ReSkill_Cnt, 0)) END AS CallCount,
                   SUM(ISNULL(dq.InQueue_Cnt, 0)) AS InqueueCount,
                   SUM(ISNULL(dq.InQueue_time, 0)) AS InqueueTime
          FROM     [dbo].[dw_POC_ByQtrHour] AS dq
                   INNER JOIN
                   #EndedContacts AS ec
                   ON ec.Skill_No = dq.skill_no
                      AND ec.bus_no = dq.bus_no
                      AND ec.QtrStartTime = dq.start_date
                   INNER JOIN
                   #FilteredSkillTable AS s
                   ON (dq.Skill_No = s.Skill_No)
          GROUP BY dq.start_date, s.skill_no, s.WFOCountReskills) AS tt
GROUP BY tt.skill_no
ORDER BY tt.skill_no</td>
        <td>51</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT cldqv.Skill_No,
       cldqv.contact_id,
       cldqv.Contact_State AS contact_state,
       cldqv.direction,
       cldqv.Bus_No,
       cldqv.StartDate,
       DurationInterval AS Duration,
       cldqv.HeaderStartDate,
       cldqv.ReskillIndicator,
       cldqv.Contact_Code
INTO   #ContactLogDetail
FROM   [dbo].[Contact_Log_DetailQV] AS cldqv CROSS APPLY dbo.SplitToIntervals(cldqv.StartDate, cldqv.Duration, DEFAULT, DEFAULT) AS cldqh
       INNER JOIN
       #FilteredSkillTable AS s
       ON (cldqv.Skill_No = s.Skill_No)
WHERE  cldqv.Skill_No IS NOT NULL
       AND cldqh.StartDateInterval &gt;= @startDate
       AND cldqh.StartDateInterval &lt; @endDate
       AND cldqv.Bus_No = @busNo
       AND cldqv.StartDate &gt;= @startDate
       AND cldqv.StartDate &lt; @endDate</td>
        <td>100</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT aldqv.Bus_No,
       aldqv.StartDate,
       aldqv.Skill_No AS skill_no,
       DurationInterval AS Duration,
       aldqv.Outstate_Code
INTO   #AgentLogDetail
FROM   [dbo].[Agent_Log_DetailQV] AS aldqv CROSS APPLY dbo.SplitToIntervals(aldqv.StartDate, aldqv.Duration, DEFAULT, DEFAULT) AS aldqh
WHERE  aldqv.Skill_No IS NOT NULL
       AND aldqh.StartDateInterval &gt;= @startDate
       AND aldqh.StartDateInterval &lt; @endDate
       AND aldqv.Bus_No = @busNo
       AND aldqv.StartDate &gt;= @startDate
       AND aldqv.StartDate &lt; @endDate</td>
        <td>122</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT   cld.skill_no,
         cld.bus_no,
         COUNT(DISTINCT CASE WHEN cld.contact_state IN (2, 10, 15, 24)
                                  AND cld.direction = 1 THEN contact_id END) AS QueuedContacts,
         COUNT(DISTINCT CASE WHEN cld.contact_state = 4
                                  AND cld.HeaderStartDate BETWEEN @startDate AND @endDate THEN contact_id END) AS Answered,
         COUNT(DISTINCT CASE WHEN cld.contact_state = 1
                                  AND cld.direction = 1 THEN contact_id END) AS Abandons,
         COUNT(DISTINCT CASE WHEN cld.contact_state = 4
                                  AND cld.direction = 1 THEN contact_id END) AS Handled,
         SUM(CASE WHEN cld.contact_state = 4 THEN CAST (Duration AS BIGINT) END) AS ActiveTalkTime,
         SUM(CASE WHEN cld.contact_state = 14 THEN CAST (Duration AS BIGINT) END) AS ConferenceTime,
         SUM(CASE WHEN cld.contact_state = 8 THEN CAST (Duration AS BIGINT) END) AS HoldTime
INTO     #SkillData_Contacts
FROM     #ContactLogDetail AS cld
GROUP BY cld.skill_no, cld.bus_no
ORDER BY cld.skill_no, cld.bus_no</td>
        <td>138</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT   ald.skill_no,
         SUM(CAST (Duration AS BIGINT)) AS ACWTime
INTO     #SkillData_Agents
FROM     #AgentLogDetail AS ald
         INNER JOIN
         dbo.Outstates AS os
         ON os.outstate_code = ald.outstate_code
WHERE    os.IsACW = 'T'
         AND os.IsSystemOutstate = 0
GROUP BY ald.skill_no</td>
        <td>158</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT   cld.Contact_Id,
         cld.Skill_No,
         SUM(CAST (Duration AS BIGINT)) AS InQueueTime
INTO     #InQueueTimeSkill
FROM     #ContactLogDetail AS cld
WHERE    cld.Contact_State IN (2, 10, 15, 24)
GROUP BY cld.Contact_Id, cld.Skill_No</td>
        <td>170</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT DISTINCT cld.Contact_ID,
                cld.Skill_No,
                cld.Direction,
                cld.ReskillIndicator
INTO   #ContactLogHeader
FROM   #ContactLogDetail AS cld
       INNER JOIN
       dbo.fn_SplitOptionalInt(NULL) AS POCList
       ON cld.Contact_Code BETWEEN POCList.IDMin AND POCList.IDMax</td>
        <td>186</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT DISTINCT cld.Contact_ID,
                cld.Skill_No,
                1 AS IsAbandon
INTO   #AbandonContacts
FROM   #ContactLogDetail AS cld
WHERE  cld.Contact_State = 1</td>
        <td>199</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT DISTINCT cld.Contact_ID,
                cld.Skill_No,
                1 AS IsActive
INTO   #ActiveContacts
FROM   #ContactLogDetail AS cld
WHERE  cld.Contact_State = 4</td>
        <td>212</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT   sla.Skill_No,
         sla.skill_name AS SkillName,
         SUM(CAST (sla.SLABeforeObjective AS BIGINT)) AS InSLA,
         SUM(CASE WHEN sla.IsAbandon = 1 THEN CAST (sla.InqueueTime AS BIGINT) ELSE 0 END) AS AbandonTime,
         SUM(CASE WHEN sla.IsActive = 1 THEN CAST (sla.InqueueTime AS BIGINT) ELSE 0 END) AS SpeedAnswerTime
INTO     #SkillData_InnerMetrics
FROM     (SELECT clh.Skill_No,
                 skl.skill_name,
                 skl.includeOtherAbandons,
                 clh.Contact_ID,
                 clh.Direction,
                 clh.ReskillIndicator,
                 CASE WHEN ab.IsAbandon IS NULL
                           AND clh.Direction = 1
                           AND skl.Outbound_Skill = 0
                           AND clh.ReskillIndicator &lt;= 1
                           AND iq.InQueueTime &lt; (CAST (skl.sla_seconds AS BIGINT) * 1000) THEN 1 ELSE 0 END AS SLABeforeObjective,
                 CASE WHEN clh.Direction = 1
                           AND skl.Outbound_Skill = 0
                           AND ISNULL(ab.IsAbandon, 0) = 1 THEN 1 ELSE 0 END AS IsAbandon,
                 ISNULL(iq.InQueueTime, 0) AS InQueueTime,
                 CASE WHEN ac.IsActive IS NULL THEN 0 ELSE 1 END AS IsActive
          FROM   (SELECT   Skill_No,
                           Contact_ID,
                           Direction,
                           MIN(ReskillIndicator) AS ReskillIndicator
                  FROM     #ContactLogHeader
                  GROUP BY Skill_No, Contact_ID, Direction) AS clh
                 INNER JOIN
                 [dbo].[Skills] AS skl
                 ON clh.Skill_No = skl.Skill_No
                 LEFT OUTER JOIN
                 #AbandonContacts AS ab
                 ON ab.Skill_No = clh.Skill_No
                    AND ab.Contact_ID = clh.Contact_ID
                 LEFT OUTER JOIN
                 #ActiveContacts AS ac
                 ON ac.Skill_No = clh.Skill_No
                    AND ac.Contact_ID = clh.Contact_ID
                 LEFT OUTER JOIN
                 #InQueueTimeSkill AS iq
                 ON iq.Skill_No = clh.Skill_No
                    AND iq.Contact_ID = clh.Contact_ID) AS sla
GROUP BY sla.Skill_No, sla.skill_name, sla.includeOtherAbandons</td>
        <td>225</td>
      </tr>
      <tr valign="top">
        <td colspan="1">Table-valued functions</td>
        <td colspan="1">dbo.fn_GetDataRoleFilterItems(@profileId, 'campaigns') AS v</td>
        <td>28</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">dbo.SplitToIntervals(cldqv.StartDate, cldqv.Duration, DEFAULT, DEFAULT) AS cldqh</td>
        <td>113</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">dbo.SplitToIntervals(aldqv.StartDate, aldqv.Duration, DEFAULT, DEFAULT) AS aldqh</td>
        <td>130</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">dbo.fn_SplitOptionalInt(NULL) AS POCList</td>
        <td>194</td>
      </tr>
      <tr valign="top">
        <td colspan="1">One-part names</td>
        <td colspan="1">#FilteredSkillTable AS fst</td>
        <td>42</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#FilteredSkillTable AS s</td>
        <td>66</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#EndedContacts AS ec</td>
        <td>84</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#FilteredSkillTable AS s</td>
        <td>87</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#FilteredSkillTable AS s</td>
        <td>114</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#ContactLogDetail AS cld</td>
        <td>149</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#AgentLogDetail AS ald</td>
        <td>162</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#ContactLogDetail AS cld</td>
        <td>176</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#ContactLogDetail AS cld</td>
        <td>193</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#ContactLogDetail AS cld</td>
        <td>205</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#ContactLogDetail AS cld</td>
        <td>218</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#ContactLogHeader</td>
        <td>261</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#AbandonContacts AS ab</td>
        <td>268</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#ActiveContacts AS ac</td>
        <td>269</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#InQueueTimeSkill AS iq</td>
        <td>270</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#FilteredSkillTable AS s</td>
        <td>308</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#SkillData_Contacts AS csdr</td>
        <td>309</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#SkillData_Agents AS asdr</td>
        <td>310</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#SkillData_EnteredQueue AS eq</td>
        <td>311</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#SkillData_InnerMetrics AS at</td>
        <td>312</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN (s.WFOCountReskills = 1) THEN 0 ELSE SUM(ISNULL(dq.ReSkill_Cnt, 0)) END</td>
        <td>61</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.WFOCountReskills = 1) THEN 0 ELSE SUM(ISNULL(dq.ReSkill_Cnt, 0)) END</td>
        <td>79</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN cld.contact_state IN (2, 10, 15, 24)
          AND cld.direction = 1 THEN contact_id END</td>
        <td>141</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN cld.contact_state = 4
          AND cld.HeaderStartDate BETWEEN @startDate AND @endDate THEN contact_id END</td>
        <td>142</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN cld.contact_state = 1
          AND cld.direction = 1 THEN contact_id END</td>
        <td>143</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN cld.contact_state = 4
          AND cld.direction = 1 THEN contact_id END</td>
        <td>144</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN cld.contact_state = 4 THEN CAST (Duration AS BIGINT) END</td>
        <td>145</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN cld.contact_state = 14 THEN CAST (Duration AS BIGINT) END</td>
        <td>146</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN cld.contact_state = 8 THEN CAST (Duration AS BIGINT) END</td>
        <td>147</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN sla.IsAbandon = 1 THEN CAST (sla.InqueueTime AS BIGINT) ELSE 0 END</td>
        <td>229</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN sla.IsActive = 1 THEN CAST (sla.InqueueTime AS BIGINT) ELSE 0 END</td>
        <td>230</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ab.IsAbandon IS NULL
          AND clh.Direction = 1
          AND skl.Outbound_Skill = 0
          AND clh.ReskillIndicator &lt;= 1
          AND iq.InQueueTime &lt; (CAST (skl.sla_seconds AS BIGINT) * 1000) THEN 1 ELSE 0 END</td>
        <td>240</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN clh.Direction = 1
          AND skl.Outbound_Skill = 0
          AND ISNULL(ab.IsAbandon, 0) = 1 THEN 1 ELSE 0 END</td>
        <td>246</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ac.IsActive IS NULL THEN 0 ELSE 1 END</td>
        <td>251</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ISNULL(eq.InqueueCount, 0) = 0 THEN 0 ELSE CAST (ROUND((ISNULL(eq.InqueueTime, 0) / eq.InqueueCount), 2) AS DECIMAL (18, 2)) END</td>
        <td>288</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ISNULL(csdr.Abandons, 0) = 0 THEN 0 ELSE CAST (ROUND((ISNULL(at.AbandonTime, 0) / csdr.Abandons) / 1000.0, 2) AS DECIMAL (18, 2)) END</td>
        <td>293</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ISNULL(csdr.Handled, 0) = 0 THEN 0 ELSE CAST (ROUND(((ISNULL(csdr.ActiveTalkTime, 0) + ISNULL(csdr.HoldTime, 0) + ISNULL(csdr.ConferenceTime, 0) + ISNULL(asdr.ACWTime, 0)) / csdr.Handled) / 1000.0, 2) AS DECIMAL (18, 2)) END</td>
        <td>298</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ISNULL(csdr.Handled, 0) = 0 THEN 0 ELSE CAST (ROUND((ISNULL(at.SpeedAnswerTime, 2) / csdr.Handled) / 1000.0, 2) AS DECIMAL (18, 2)) END</td>
        <td>303</td>
      </tr>
      <tr valign="top">
        <td colspan="1">APPLY</td>
        <td colspan="1">[dbo].[Contact_Log_DetailQV] AS cldqv CROSS APPLY dbo.SplitToIntervals(cldqv.StartDate, cldqv.Duration, DEFAULT, DEFAULT) AS cldqh</td>
        <td>112</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">[dbo].[Agent_Log_DetailQV] AS aldqv CROSS APPLY dbo.SplitToIntervals(aldqv.StartDate, aldqv.Duration, DEFAULT, DEFAULT) AS aldqh</td>
        <td>129</td>
      </tr>
      <tr valign="top">
        <td colspan="1">DISTINCT</td>
        <td colspan="1">COUNT(DISTINCT CASE WHEN cld.contact_state IN (2, 10, 15, 24)
                         AND cld.direction = 1 THEN contact_id END)</td>
        <td>141</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT CASE WHEN cld.contact_state = 4
                         AND cld.HeaderStartDate BETWEEN @startDate AND @endDate THEN contact_id END)</td>
        <td>142</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT CASE WHEN cld.contact_state = 1
                         AND cld.direction = 1 THEN contact_id END)</td>
        <td>143</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT CASE WHEN cld.contact_state = 4
                         AND cld.direction = 1 THEN contact_id END)</td>
        <td>144</td>
      </tr>
    </table>
  </body>
</html>