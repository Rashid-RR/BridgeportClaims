<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeSupervisorConfig]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeSupervisorConfig]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:09 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO [dbo].[Supervisor_Config]
 AS target
USING (SELECT config_ID,
              config_name,
              owner,
              scroll_time,
              Window_State,
              WindowTop,
              WindowLeft,
              WindowHeight,
              WindowWidth,
              bus_no
       FROM   (SELECT config_ID,
                      config_name,
                      owner,
                      scroll_time,
                      Window_State,
                      WindowTop,
                      WindowLeft,
                      WindowHeight,
                      WindowWidth,
                      bus_no,
                      ROW_NUMBER() OVER (PARTITION BY config_ID ORDER BY config_ID) AS RowNum
               FROM   [ETL].[Supervisor_Config]) AS dup
       WHERE  dup.RowNum = 1) AS source ON (target.config_ID = source.config_ID)
WHEN MATCHED AND (target.config_name != source.config_name
                  OR target.owner != source.owner
                  OR target.scroll_time != source.scroll_time
                  OR target.Window_State != source.Window_State
                  OR target.WindowTop != source.WindowTop
                  OR target.WindowLeft != source.WindowLeft
                  OR target.WindowHeight != source.WindowHeight
                  OR target.WindowWidth != source.WindowWidth
                  OR CASE WHEN target.bus_no = source.bus_no
                               OR target.bus_no IS NULL
                                  AND source.bus_no IS NULL THEN 0 END IS NULL) THEN UPDATE 
SET config_name  = source.config_name,
    owner        = source.owner,
    scroll_time  = source.scroll_time,
    Window_State = source.Window_State,
    WindowTop    = source.WindowTop,
    WindowLeft   = source.WindowLeft,
    WindowHeight = source.WindowHeight,
    WindowWidth  = source.WindowWidth,
    bus_no       = source.bus_no
WHEN NOT MATCHED THEN INSERT (config_ID, config_name, owner, scroll_time, Window_State, WindowTop, WindowLeft, WindowHeight, WindowWidth, bus_no) VALUES (source.config_ID, source.config_name, source.owner, source.scroll_time, source.Window_State, source.WindowTop, source.WindowLeft, source.WindowHeight, source.WindowWidth, source.bus_no)
WHEN NOT MATCHED BY SOURCE THEN DELETE</td>
        <td>5</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [dbo].[Supervisor_Config]
 AS target
USING (SELECT config_ID,
              config_name,
              owner,
              scroll_time,
              Window_State,
              WindowTop,
              WindowLeft,
              WindowHeight,
              WindowWidth,
              bus_no
       FROM   (SELECT config_ID,
                      config_name,
                      owner,
                      scroll_time,
                      Window_State,
                      WindowTop,
                      WindowLeft,
                      WindowHeight,
                      WindowWidth,
                      bus_no,
                      ROW_NUMBER() OVER (PARTITION BY config_ID ORDER BY config_ID) AS RowNum
               FROM   [ETL].[Supervisor_Config]) AS dup
       WHERE  dup.RowNum = 1) AS source ON (target.config_ID = source.config_ID)
WHEN MATCHED AND (target.config_name != source.config_name
                  OR target.owner != source.owner
                  OR target.scroll_time != source.scroll_time
                  OR target.Window_State != source.Window_State
                  OR target.WindowTop != source.WindowTop
                  OR target.WindowLeft != source.WindowLeft
                  OR target.WindowHeight != source.WindowHeight
                  OR target.WindowWidth != source.WindowWidth
                  OR CASE WHEN target.bus_no = source.bus_no
                               OR target.bus_no IS NULL
                                  AND source.bus_no IS NULL THEN 0 END IS NULL) THEN UPDATE 
SET config_name  = source.config_name,
    owner        = source.owner,
    scroll_time  = source.scroll_time,
    Window_State = source.Window_State,
    WindowTop    = source.WindowTop,
    WindowLeft   = source.WindowLeft,
    WindowHeight = source.WindowHeight,
    WindowWidth  = source.WindowWidth,
    bus_no       = source.bus_no
WHEN NOT MATCHED THEN INSERT (config_ID, config_name, owner, scroll_time, Window_State, WindowTop, WindowLeft, WindowHeight, WindowWidth, bus_no) VALUES (source.config_ID, source.config_name, source.owner, source.scroll_time, source.Window_State, source.WindowTop, source.WindowLeft, source.WindowHeight, source.WindowWidth, source.bus_no)
WHEN NOT MATCHED BY SOURCE THEN DELETE</td>
        <td>5</td>
      </tr>
      <tr valign="top">
        <td colspan="1">ROW_NUMBER</td>
        <td colspan="1">ROW_NUMBER() OVER (PARTITION BY config_ID ORDER BY config_ID)</td>
        <td>32</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">OVER</td>
        <td colspan="1">OVER (PARTITION BY config_ID ORDER BY config_ID)</td>
        <td>32</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN target.bus_no = source.bus_no
          OR target.bus_no IS NULL
             AND source.bus_no IS NULL THEN 0 END</td>
        <td>53</td>
      </tr>
    </table>
  </body>
</html>