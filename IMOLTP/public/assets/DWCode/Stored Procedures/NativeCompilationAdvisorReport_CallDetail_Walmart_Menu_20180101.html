<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_Walmart_Menu]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_Walmart_Menu]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:09 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>17</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>18</td>
      </tr>
      <tr valign="top">
        <td colspan="1">BEGIN TRANSACTION</td>
        <td colspan="1">BEGIN TRANSACTION</td>
        <td>20</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">EXECUTE LockCriticalSection @LockCritical</td>
        <td>23</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">contact_log_header</td>
        <td>42</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">IVR_Source AS s</td>
        <td>53</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">IVR_Header AS h</td>
        <td>54</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ivrhistory AS h</td>
        <td>67</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#WMIVRTempContacts AS wc</td>
        <td>68</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#WMIVRTempMenus AS wm</td>
        <td>69</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#final AS f</td>
        <td>83</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT contact_id,
       master_contact_id
INTO   #WMIVRTempContacts
FROM   contact_log_header
WHERE  bus_no = @_bus_no
       AND start_date BETWEEN @_UTCStart_Date AND @_UTCEnd_Date</td>
        <td>39</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT s.Master_ID,
       s.Action_ID,
       script_name,
       s.label
INTO   #WMIVRTempMenus
FROM   IVR_Source AS s
       INNER JOIN
       IVR_Header AS h
       ON s.master_id = h.master_id
WHERE  s.bus_no = @_bus_no
       AND s.action = 'MENU'</td>
        <td>47</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT wc.master_contact_id,
       h.Contact_Id,
       h.CaptureDate,
       h.Master_Id AS 'script_id',
       h.Action_Id,
       wm.label,
       wm.script_name,
       h.Result
INTO   #final
FROM   ivrhistory AS h
       INNER JOIN
       #WMIVRTempContacts AS wc
       ON h.Contact_Id = wc.Contact_Id
       INNER JOIN
       #WMIVRTempMenus AS wm
       ON h.Master_Id = wm.master_id
          AND h.Action_Id = wm.Action_ID
WHERE  h.Bus_No = @_bus_no</td>
        <td>58</td>
      </tr>
      <tr valign="top">
        <td colspan="1">LAG</td>
        <td colspan="1">LAG(CaptureDate, 1, NULL) OVER (PARTITION BY Contact_Id ORDER BY CaptureDate)</td>
        <td>78</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">LAG(CaptureDate, 1, NULL) OVER (PARTITION BY Contact_Id ORDER BY CaptureDate)</td>
        <td>79</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">LAG(CaptureDate, 1, NULL) OVER (PARTITION BY Contact_Id ORDER BY CaptureDate)</td>
        <td>81</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">OVER</td>
        <td colspan="1">OVER (PARTITION BY Contact_Id ORDER BY CaptureDate)</td>
        <td>78</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">OVER (PARTITION BY Contact_Id ORDER BY CaptureDate)</td>
        <td>79</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">OVER (PARTITION BY Contact_Id ORDER BY CaptureDate)</td>
        <td>81</td>
      </tr>
      <tr valign="top">
        <td colspan="1">COMMIT TRANSACTION</td>
        <td colspan="1">COMMIT TRANSACTION</td>
        <td>86</td>
      </tr>
    </table>
  </body>
</html>