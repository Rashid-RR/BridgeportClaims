<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeRTContactLog]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeRTContactLog]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:09 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO [dbo].[RT_Contact_Log]
 AS target
USING (SELECT Contact_Id,
              Master_Contact_Id,
              Bus_no,
              Skill_No,
              Campaign_no,
              Agent_No,
              Team_No,
              start_date,
              Media_Type,
              to_addr,
              from_addr,
              current_contact_state,
              current_contact_date,
              ReskillIndicator,
              CustomPortIndicator,
              InitialPriority,
              Acceleration,
              MaxPriority,
              LastInQueueStartTime,
              TargetAgent_no,
              InDeliveryProcess,
              DeliverScript,
              Direction,
              ApplicationName,
              Contact_Code
       FROM   (SELECT Contact_Id,
                      Master_Contact_Id,
                      Bus_no,
                      Skill_No,
                      Campaign_no,
                      Agent_No,
                      Team_No,
                      start_date,
                      Media_Type,
                      to_addr,
                      from_addr,
                      current_contact_state,
                      current_contact_date,
                      ReskillIndicator,
                      CustomPortIndicator,
                      InitialPriority,
                      Acceleration,
                      MaxPriority,
                      LastInQueueStartTime,
                      TargetAgent_no,
                      InDeliveryProcess,
                      DeliverScript,
                      Direction,
                      ApplicationName,
                      Contact_Code,
                      ROW_NUMBER() OVER (PARTITION BY Contact_Id ORDER BY Contact_Id) AS RowNum
               FROM   [ETL].[RT_Contact_Log]) AS dup
       WHERE  dup.RowNum = 1) AS source ON (target.Contact_Id = source.Contact_Id)
WHEN MATCHED AND (CASE WHEN target.Master_Contact_Id = source.Master_Contact_Id
                            OR target.Master_Contact_Id IS NULL
                               AND source.Master_Contact_Id IS NULL THEN 0 END IS NULL
                  OR target.Bus_no != source.Bus_no
                  OR CASE WHEN target.Skill_No = source.Skill_No
                               OR target.Skill_No IS NULL
                                  AND source.Skill_No IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.Campaign_no = source.Campaign_no
                               OR target.Campaign_no IS NULL
                                  AND source.Campaign_no IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.Agent_No = source.Agent_No
                               OR target.Agent_No IS NULL
                                  AND source.Agent_No IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.Team_No = source.Team_No
                               OR target.Team_No IS NULL
                                  AND source.Team_No IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.start_date = source.start_date
                               OR target.start_date IS NULL
                                  AND source.start_date IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.Media_Type = source.Media_Type
                               OR target.Media_Type IS NULL
                                  AND source.Media_Type IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.to_addr = source.to_addr
                               OR target.to_addr IS NULL
                                  AND source.to_addr IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.from_addr = source.from_addr
                               OR target.from_addr IS NULL
                                  AND source.from_addr IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.current_contact_state = source.current_contact_state
                               OR target.current_contact_state IS NULL
                                  AND source.current_contact_state IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.current_contact_date = source.current_contact_date
                               OR target.current_contact_date IS NULL
                                  AND source.current_contact_date IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.ReskillIndicator = source.ReskillIndicator
                               OR target.ReskillIndicator IS NULL
                                  AND source.ReskillIndicator IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.CustomPortIndicator = source.CustomPortIndicator
                               OR target.CustomPortIndicator IS NULL
                                  AND source.CustomPortIndicator IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.InitialPriority = source.InitialPriority
                               OR target.InitialPriority IS NULL
                                  AND source.InitialPriority IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.Acceleration = source.Acceleration
                               OR target.Acceleration IS NULL
                                  AND source.Acceleration IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.MaxPriority = source.MaxPriority
                               OR target.MaxPriority IS NULL
                                  AND source.MaxPriority IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.LastInQueueStartTime = source.LastInQueueStartTime
                               OR target.LastInQueueStartTime IS NULL
                                  AND source.LastInQueueStartTime IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.TargetAgent_no = source.TargetAgent_no
                               OR target.TargetAgent_no IS NULL
                                  AND source.TargetAgent_no IS NULL THEN 0 END IS NULL
                  OR target.InDeliveryProcess != source.InDeliveryProcess
                  OR CASE WHEN target.DeliverScript = source.DeliverScript
                               OR target.DeliverScript IS NULL
                                  AND source.DeliverScript IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.Direction = source.Direction
                               OR target.Direction IS NULL
                                  AND source.Direction IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.ApplicationName = source.ApplicationName
                               OR target.ApplicationName IS NULL
                                  AND source.ApplicationName IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.Contact_Code = source.Contact_Code
                               OR target.Contact_Code IS NULL
                                  AND source.Contact_Code IS NULL THEN 0 END IS NULL) THEN UPDATE 
SET Master_Contact_Id     = source.Master_Contact_Id,
    Bus_no                = source.Bus_no,
    Skill_No              = source.Skill_No,
    Campaign_no           = source.Campaign_no,
    Agent_No              = source.Agent_No,
    Team_No               = source.Team_No,
    start_date            = source.start_date,
    Media_Type            = source.Media_Type,
    to_addr               = source.to_addr,
    from_addr             = source.from_addr,
    current_contact_state = source.current_contact_state,
    current_contact_date  = source.current_contact_date,
    ReskillIndicator      = source.ReskillIndicator,
    CustomPortIndicator   = source.CustomPortIndicator,
    InitialPriority       = source.InitialPriority,
    Acceleration          = source.Acceleration,
    MaxPriority           = source.MaxPriority,
    LastInQueueStartTime  = source.LastInQueueStartTime,
    TargetAgent_no        = source.TargetAgent_no,
    InDeliveryProcess     = source.InDeliveryProcess,
    DeliverScript         = source.DeliverScript,
    Direction             = source.Direction,
    ApplicationName       = source.ApplicationName,
    Contact_Code          = source.Contact_Code
WHEN NOT MATCHED THEN INSERT (Contact_Id, Master_Contact_Id, Bus_no, Skill_No, Campaign_no, Agent_No, Team_No, start_date, Media_Type, to_addr, from_addr, current_contact_state, current_contact_date, ReskillIndicator, CustomPortIndicator, InitialPriority, Acceleration, MaxPriority, LastInQueueStartTime, TargetAgent_no, InDeliveryProcess, DeliverScript, Direction, ApplicationName, Contact_Code) VALUES (source.Contact_Id, source.Master_Contact_Id, source.Bus_no, source.Skill_No, source.Campaign_no, source.Agent_No, source.Team_No, source.start_date, source.Media_Type, source.to_addr, source.from_addr, source.current_contact_state, source.current_contact_date, source.ReskillIndicator, source.CustomPortIndicator, source.InitialPriority, source.Acceleration, source.MaxPriority, source.LastInQueueStartTime, source.TargetAgent_no, source.InDeliveryProcess, source.DeliverScript, source.Direction, source.ApplicationName, source.Contact_Code)
WHEN NOT MATCHED BY SOURCE THEN DELETE</td>
        <td>5</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [dbo].[RT_Contact_Log]
 AS target
USING (SELECT Contact_Id,
              Master_Contact_Id,
              Bus_no,
              Skill_No,
              Campaign_no,
              Agent_No,
              Team_No,
              start_date,
              Media_Type,
              to_addr,
              from_addr,
              current_contact_state,
              current_contact_date,
              ReskillIndicator,
              CustomPortIndicator,
              InitialPriority,
              Acceleration,
              MaxPriority,
              LastInQueueStartTime,
              TargetAgent_no,
              InDeliveryProcess,
              DeliverScript,
              Direction,
              ApplicationName,
              Contact_Code
       FROM   (SELECT Contact_Id,
                      Master_Contact_Id,
                      Bus_no,
                      Skill_No,
                      Campaign_no,
                      Agent_No,
                      Team_No,
                      start_date,
                      Media_Type,
                      to_addr,
                      from_addr,
                      current_contact_state,
                      current_contact_date,
                      ReskillIndicator,
                      CustomPortIndicator,
                      InitialPriority,
                      Acceleration,
                      MaxPriority,
                      LastInQueueStartTime,
                      TargetAgent_no,
                      InDeliveryProcess,
                      DeliverScript,
                      Direction,
                      ApplicationName,
                      Contact_Code,
                      ROW_NUMBER() OVER (PARTITION BY Contact_Id ORDER BY Contact_Id) AS RowNum
               FROM   [ETL].[RT_Contact_Log]) AS dup
       WHERE  dup.RowNum = 1) AS source ON (target.Contact_Id = source.Contact_Id)
WHEN MATCHED AND (CASE WHEN target.Master_Contact_Id = source.Master_Contact_Id
                            OR target.Master_Contact_Id IS NULL
                               AND source.Master_Contact_Id IS NULL THEN 0 END IS NULL
                  OR target.Bus_no != source.Bus_no
                  OR CASE WHEN target.Skill_No = source.Skill_No
                               OR target.Skill_No IS NULL
                                  AND source.Skill_No IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.Campaign_no = source.Campaign_no
                               OR target.Campaign_no IS NULL
                                  AND source.Campaign_no IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.Agent_No = source.Agent_No
                               OR target.Agent_No IS NULL
                                  AND source.Agent_No IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.Team_No = source.Team_No
                               OR target.Team_No IS NULL
                                  AND source.Team_No IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.start_date = source.start_date
                               OR target.start_date IS NULL
                                  AND source.start_date IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.Media_Type = source.Media_Type
                               OR target.Media_Type IS NULL
                                  AND source.Media_Type IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.to_addr = source.to_addr
                               OR target.to_addr IS NULL
                                  AND source.to_addr IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.from_addr = source.from_addr
                               OR target.from_addr IS NULL
                                  AND source.from_addr IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.current_contact_state = source.current_contact_state
                               OR target.current_contact_state IS NULL
                                  AND source.current_contact_state IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.current_contact_date = source.current_contact_date
                               OR target.current_contact_date IS NULL
                                  AND source.current_contact_date IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.ReskillIndicator = source.ReskillIndicator
                               OR target.ReskillIndicator IS NULL
                                  AND source.ReskillIndicator IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.CustomPortIndicator = source.CustomPortIndicator
                               OR target.CustomPortIndicator IS NULL
                                  AND source.CustomPortIndicator IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.InitialPriority = source.InitialPriority
                               OR target.InitialPriority IS NULL
                                  AND source.InitialPriority IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.Acceleration = source.Acceleration
                               OR target.Acceleration IS NULL
                                  AND source.Acceleration IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.MaxPriority = source.MaxPriority
                               OR target.MaxPriority IS NULL
                                  AND source.MaxPriority IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.LastInQueueStartTime = source.LastInQueueStartTime
                               OR target.LastInQueueStartTime IS NULL
                                  AND source.LastInQueueStartTime IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.TargetAgent_no = source.TargetAgent_no
                               OR target.TargetAgent_no IS NULL
                                  AND source.TargetAgent_no IS NULL THEN 0 END IS NULL
                  OR target.InDeliveryProcess != source.InDeliveryProcess
                  OR CASE WHEN target.DeliverScript = source.DeliverScript
                               OR target.DeliverScript IS NULL
                                  AND source.DeliverScript IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.Direction = source.Direction
                               OR target.Direction IS NULL
                                  AND source.Direction IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.ApplicationName = source.ApplicationName
                               OR target.ApplicationName IS NULL
                                  AND source.ApplicationName IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.Contact_Code = source.Contact_Code
                               OR target.Contact_Code IS NULL
                                  AND source.Contact_Code IS NULL THEN 0 END IS NULL) THEN UPDATE 
SET Master_Contact_Id     = source.Master_Contact_Id,
    Bus_no                = source.Bus_no,
    Skill_No              = source.Skill_No,
    Campaign_no           = source.Campaign_no,
    Agent_No              = source.Agent_No,
    Team_No               = source.Team_No,
    start_date            = source.start_date,
    Media_Type            = source.Media_Type,
    to_addr               = source.to_addr,
    from_addr             = source.from_addr,
    current_contact_state = source.current_contact_state,
    current_contact_date  = source.current_contact_date,
    ReskillIndicator      = source.ReskillIndicator,
    CustomPortIndicator   = source.CustomPortIndicator,
    InitialPriority       = source.InitialPriority,
    Acceleration          = source.Acceleration,
    MaxPriority           = source.MaxPriority,
    LastInQueueStartTime  = source.LastInQueueStartTime,
    TargetAgent_no        = source.TargetAgent_no,
    InDeliveryProcess     = source.InDeliveryProcess,
    DeliverScript         = source.DeliverScript,
    Direction             = source.Direction,
    ApplicationName       = source.ApplicationName,
    Contact_Code          = source.Contact_Code
WHEN NOT MATCHED THEN INSERT (Contact_Id, Master_Contact_Id, Bus_no, Skill_No, Campaign_no, Agent_No, Team_No, start_date, Media_Type, to_addr, from_addr, current_contact_state, current_contact_date, ReskillIndicator, CustomPortIndicator, InitialPriority, Acceleration, MaxPriority, LastInQueueStartTime, TargetAgent_no, InDeliveryProcess, DeliverScript, Direction, ApplicationName, Contact_Code) VALUES (source.Contact_Id, source.Master_Contact_Id, source.Bus_no, source.Skill_No, source.Campaign_no, source.Agent_No, source.Team_No, source.start_date, source.Media_Type, source.to_addr, source.from_addr, source.current_contact_state, source.current_contact_date, source.ReskillIndicator, source.CustomPortIndicator, source.InitialPriority, source.Acceleration, source.MaxPriority, source.LastInQueueStartTime, source.TargetAgent_no, source.InDeliveryProcess, source.DeliverScript, source.Direction, source.ApplicationName, source.Contact_Code)
WHEN NOT MATCHED BY SOURCE THEN DELETE</td>
        <td>5</td>
      </tr>
      <tr valign="top">
        <td colspan="1">ROW_NUMBER</td>
        <td colspan="1">ROW_NUMBER() OVER (PARTITION BY Contact_Id ORDER BY Contact_Id)</td>
        <td>62</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">OVER</td>
        <td colspan="1">OVER (PARTITION BY Contact_Id ORDER BY Contact_Id)</td>
        <td>62</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN target.Master_Contact_Id = source.Master_Contact_Id
          OR target.Master_Contact_Id IS NULL
             AND source.Master_Contact_Id IS NULL THEN 0 END</td>
        <td>75</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.Skill_No = source.Skill_No
          OR target.Skill_No IS NULL
             AND source.Skill_No IS NULL THEN 0 END</td>
        <td>77</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.Campaign_no = source.Campaign_no
          OR target.Campaign_no IS NULL
             AND source.Campaign_no IS NULL THEN 0 END</td>
        <td>78</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.Agent_No = source.Agent_No
          OR target.Agent_No IS NULL
             AND source.Agent_No IS NULL THEN 0 END</td>
        <td>79</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.Team_No = source.Team_No
          OR target.Team_No IS NULL
             AND source.Team_No IS NULL THEN 0 END</td>
        <td>80</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.start_date = source.start_date
          OR target.start_date IS NULL
             AND source.start_date IS NULL THEN 0 END</td>
        <td>81</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.Media_Type = source.Media_Type
          OR target.Media_Type IS NULL
             AND source.Media_Type IS NULL THEN 0 END</td>
        <td>82</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.to_addr = source.to_addr
          OR target.to_addr IS NULL
             AND source.to_addr IS NULL THEN 0 END</td>
        <td>83</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.from_addr = source.from_addr
          OR target.from_addr IS NULL
             AND source.from_addr IS NULL THEN 0 END</td>
        <td>84</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.current_contact_state = source.current_contact_state
          OR target.current_contact_state IS NULL
             AND source.current_contact_state IS NULL THEN 0 END</td>
        <td>85</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.current_contact_date = source.current_contact_date
          OR target.current_contact_date IS NULL
             AND source.current_contact_date IS NULL THEN 0 END</td>
        <td>86</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.ReskillIndicator = source.ReskillIndicator
          OR target.ReskillIndicator IS NULL
             AND source.ReskillIndicator IS NULL THEN 0 END</td>
        <td>87</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.CustomPortIndicator = source.CustomPortIndicator
          OR target.CustomPortIndicator IS NULL
             AND source.CustomPortIndicator IS NULL THEN 0 END</td>
        <td>88</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.InitialPriority = source.InitialPriority
          OR target.InitialPriority IS NULL
             AND source.InitialPriority IS NULL THEN 0 END</td>
        <td>89</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.Acceleration = source.Acceleration
          OR target.Acceleration IS NULL
             AND source.Acceleration IS NULL THEN 0 END</td>
        <td>90</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.MaxPriority = source.MaxPriority
          OR target.MaxPriority IS NULL
             AND source.MaxPriority IS NULL THEN 0 END</td>
        <td>91</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.LastInQueueStartTime = source.LastInQueueStartTime
          OR target.LastInQueueStartTime IS NULL
             AND source.LastInQueueStartTime IS NULL THEN 0 END</td>
        <td>92</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.TargetAgent_no = source.TargetAgent_no
          OR target.TargetAgent_no IS NULL
             AND source.TargetAgent_no IS NULL THEN 0 END</td>
        <td>93</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.DeliverScript = source.DeliverScript
          OR target.DeliverScript IS NULL
             AND source.DeliverScript IS NULL THEN 0 END</td>
        <td>95</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.Direction = source.Direction
          OR target.Direction IS NULL
             AND source.Direction IS NULL THEN 0 END</td>
        <td>96</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.ApplicationName = source.ApplicationName
          OR target.ApplicationName IS NULL
             AND source.ApplicationName IS NULL THEN 0 END</td>
        <td>97</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.Contact_Code = source.Contact_Code
          OR target.Contact_Code IS NULL
             AND source.Contact_Code IS NULL THEN 0 END</td>
        <td>98</td>
      </tr>
    </table>
  </body>
</html>