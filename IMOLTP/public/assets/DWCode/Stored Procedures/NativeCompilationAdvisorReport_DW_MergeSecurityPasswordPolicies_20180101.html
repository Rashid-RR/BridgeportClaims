<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeSecurityPasswordPolicies]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeSecurityPasswordPolicies]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:09 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO [dbo].[Security_PasswordPolicies]
 AS target
USING [ETL].[Security_PasswordPolicies] AS source ON (target.PasswordPolicyID = source.PasswordPolicyID)
WHEN MATCHED AND source.ActionID = 0 THEN DELETE
WHEN MATCHED AND source.ActionID IN (1, 2, 3) THEN UPDATE 
SET SecurityProfileID            = source.SecurityProfileID,
    Bus_No                       = source.Bus_No,
    RememberPasswordCount        = source.RememberPasswordCount,
    MinimumLength                = source.MinimumLength,
    MaximumAgeDays               = source.MaximumAgeDays,
    RandomPasswordLife           = source.RandomPasswordLife,
    MinimumLowerCase             = source.MinimumLowerCase,
    MinimumUpperCase             = source.MinimumUpperCase,
    MinimumNumeric               = source.MinimumNumeric,
    MinimumNonAlphaNumeric       = source.MinimumNonAlphaNumeric,
    LockoutAttemptCount          = source.LockoutAttemptCount,
    ForceRandomForNewUsers       = source.ForceRandomForNewUsers,
    PreventPasswordSimilarToName = source.PreventPasswordSimilarToName,
    CreatedBy                    = source.CreatedBy,
    CreateDate                   = source.CreateDate,
    ModifiedBy                   = source.ModifiedBy,
    ModifiedDate                 = source.ModifiedDate,
    MFAEnabled                   = source.MFAEnabled
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (PasswordPolicyID, SecurityProfileID, Bus_No, RememberPasswordCount, MinimumLength, MaximumAgeDays, RandomPasswordLife, MinimumLowerCase, MinimumUpperCase, MinimumNumeric, MinimumNonAlphaNumeric, LockoutAttemptCount, ForceRandomForNewUsers, PreventPasswordSimilarToName, CreatedBy, CreateDate, ModifiedBy, ModifiedDate, MFAEnabled) VALUES (source.PasswordPolicyID, source.SecurityProfileID, source.Bus_No, source.RememberPasswordCount, source.MinimumLength, source.MaximumAgeDays, source.RandomPasswordLife, source.MinimumLowerCase, source.MinimumUpperCase, source.MinimumNumeric, source.MinimumNonAlphaNumeric, source.LockoutAttemptCount, source.ForceRandomForNewUsers, source.PreventPasswordSimilarToName, source.CreatedBy, source.CreateDate, source.ModifiedBy, source.ModifiedDate, source.MFAEnabled)</td>
        <td>5</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [dbo].[Security_PasswordPolicies]
 AS target
USING [ETL].[Security_PasswordPolicies] AS source ON (target.PasswordPolicyID = source.PasswordPolicyID)
WHEN MATCHED AND source.ActionID = 0 THEN DELETE
WHEN MATCHED AND source.ActionID IN (1, 2, 3) THEN UPDATE 
SET SecurityProfileID            = source.SecurityProfileID,
    Bus_No                       = source.Bus_No,
    RememberPasswordCount        = source.RememberPasswordCount,
    MinimumLength                = source.MinimumLength,
    MaximumAgeDays               = source.MaximumAgeDays,
    RandomPasswordLife           = source.RandomPasswordLife,
    MinimumLowerCase             = source.MinimumLowerCase,
    MinimumUpperCase             = source.MinimumUpperCase,
    MinimumNumeric               = source.MinimumNumeric,
    MinimumNonAlphaNumeric       = source.MinimumNonAlphaNumeric,
    LockoutAttemptCount          = source.LockoutAttemptCount,
    ForceRandomForNewUsers       = source.ForceRandomForNewUsers,
    PreventPasswordSimilarToName = source.PreventPasswordSimilarToName,
    CreatedBy                    = source.CreatedBy,
    CreateDate                   = source.CreateDate,
    ModifiedBy                   = source.ModifiedBy,
    ModifiedDate                 = source.ModifiedDate,
    MFAEnabled                   = source.MFAEnabled
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (PasswordPolicyID, SecurityProfileID, Bus_No, RememberPasswordCount, MinimumLength, MaximumAgeDays, RandomPasswordLife, MinimumLowerCase, MinimumUpperCase, MinimumNumeric, MinimumNonAlphaNumeric, LockoutAttemptCount, ForceRandomForNewUsers, PreventPasswordSimilarToName, CreatedBy, CreateDate, ModifiedBy, ModifiedDate, MFAEnabled) VALUES (source.PasswordPolicyID, source.SecurityProfileID, source.Bus_No, source.RememberPasswordCount, source.MinimumLength, source.MaximumAgeDays, source.RandomPasswordLife, source.MinimumLowerCase, source.MinimumUpperCase, source.MinimumNumeric, source.MinimumNonAlphaNumeric, source.LockoutAttemptCount, source.ForceRandomForNewUsers, source.PreventPasswordSimilarToName, source.CreatedBy, source.CreateDate, source.ModifiedBy, source.ModifiedDate, source.MFAEnabled)</td>
        <td>5</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [Staging].[Security_PasswordPolicies]
 AS target
USING [ETL].[Security_PasswordPolicies] AS source ON (target.PasswordPolicyID = source.PasswordPolicyID)
WHEN MATCHED THEN UPDATE 
SET ActionID                     = source.ActionID,
    SecurityProfileID            = CASE WHEN source.ActionID = 0 THEN target.SecurityProfileID ELSE source.SecurityProfileID END,
    Bus_No                       = CASE WHEN source.ActionID = 0 THEN target.Bus_No ELSE source.Bus_No END,
    RememberPasswordCount        = CASE WHEN source.ActionID = 0 THEN target.RememberPasswordCount ELSE source.RememberPasswordCount END,
    MinimumLength                = CASE WHEN source.ActionID = 0 THEN target.MinimumLength ELSE source.MinimumLength END,
    MaximumAgeDays               = CASE WHEN source.ActionID = 0 THEN target.MaximumAgeDays ELSE source.MaximumAgeDays END,
    RandomPasswordLife           = CASE WHEN source.ActionID = 0 THEN target.RandomPasswordLife ELSE source.RandomPasswordLife END,
    MinimumLowerCase             = CASE WHEN source.ActionID = 0 THEN target.MinimumLowerCase ELSE source.MinimumLowerCase END,
    MinimumUpperCase             = CASE WHEN source.ActionID = 0 THEN target.MinimumUpperCase ELSE source.MinimumUpperCase END,
    MinimumNumeric               = CASE WHEN source.ActionID = 0 THEN target.MinimumNumeric ELSE source.MinimumNumeric END,
    MinimumNonAlphaNumeric       = CASE WHEN source.ActionID = 0 THEN target.MinimumNonAlphaNumeric ELSE source.MinimumNonAlphaNumeric END,
    LockoutAttemptCount          = CASE WHEN source.ActionID = 0 THEN target.LockoutAttemptCount ELSE source.LockoutAttemptCount END,
    ForceRandomForNewUsers       = CASE WHEN source.ActionID = 0 THEN target.ForceRandomForNewUsers ELSE source.ForceRandomForNewUsers END,
    PreventPasswordSimilarToName = CASE WHEN source.ActionID = 0 THEN target.PreventPasswordSimilarToName ELSE source.PreventPasswordSimilarToName END,
    CreatedBy                    = CASE WHEN source.ActionID = 0 THEN target.CreatedBy ELSE source.CreatedBy END,
    CreateDate                   = CASE WHEN source.ActionID = 0 THEN target.CreateDate ELSE source.CreateDate END,
    ModifiedBy                   = CASE WHEN source.ActionID = 0 THEN target.ModifiedBy ELSE source.ModifiedBy END,
    ModifiedDate                 = CASE WHEN source.ActionID = 0 THEN target.ModifiedDate ELSE source.ModifiedDate END,
    MFAEnabled                   = CASE WHEN source.ActionID = 0 THEN target.MFAEnabled ELSE source.MFAEnabled END
WHEN NOT MATCHED THEN INSERT (ActionID, PasswordPolicyID, SecurityProfileID, Bus_No, RememberPasswordCount, MinimumLength, MaximumAgeDays, RandomPasswordLife, MinimumLowerCase, MinimumUpperCase, MinimumNumeric, MinimumNonAlphaNumeric, LockoutAttemptCount, ForceRandomForNewUsers, PreventPasswordSimilarToName, CreatedBy, CreateDate, ModifiedBy, ModifiedDate, MFAEnabled) VALUES (source.ActionID, source.PasswordPolicyID, source.SecurityProfileID, source.Bus_No, source.RememberPasswordCount, source.MinimumLength, source.MaximumAgeDays, source.RandomPasswordLife, source.MinimumLowerCase, source.MinimumUpperCase, source.MinimumNumeric, source.MinimumNonAlphaNumeric, source.LockoutAttemptCount, source.ForceRandomForNewUsers, source.PreventPasswordSimilarToName, source.CreatedBy, source.CreateDate, source.ModifiedBy, source.ModifiedDate, source.MFAEnabled)</td>
        <td>92</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [Staging].[Security_PasswordPolicies]
 AS target
USING [ETL].[Security_PasswordPolicies] AS source ON (target.PasswordPolicyID = source.PasswordPolicyID)
WHEN MATCHED THEN UPDATE 
SET ActionID                     = source.ActionID,
    SecurityProfileID            = CASE WHEN source.ActionID = 0 THEN target.SecurityProfileID ELSE source.SecurityProfileID END,
    Bus_No                       = CASE WHEN source.ActionID = 0 THEN target.Bus_No ELSE source.Bus_No END,
    RememberPasswordCount        = CASE WHEN source.ActionID = 0 THEN target.RememberPasswordCount ELSE source.RememberPasswordCount END,
    MinimumLength                = CASE WHEN source.ActionID = 0 THEN target.MinimumLength ELSE source.MinimumLength END,
    MaximumAgeDays               = CASE WHEN source.ActionID = 0 THEN target.MaximumAgeDays ELSE source.MaximumAgeDays END,
    RandomPasswordLife           = CASE WHEN source.ActionID = 0 THEN target.RandomPasswordLife ELSE source.RandomPasswordLife END,
    MinimumLowerCase             = CASE WHEN source.ActionID = 0 THEN target.MinimumLowerCase ELSE source.MinimumLowerCase END,
    MinimumUpperCase             = CASE WHEN source.ActionID = 0 THEN target.MinimumUpperCase ELSE source.MinimumUpperCase END,
    MinimumNumeric               = CASE WHEN source.ActionID = 0 THEN target.MinimumNumeric ELSE source.MinimumNumeric END,
    MinimumNonAlphaNumeric       = CASE WHEN source.ActionID = 0 THEN target.MinimumNonAlphaNumeric ELSE source.MinimumNonAlphaNumeric END,
    LockoutAttemptCount          = CASE WHEN source.ActionID = 0 THEN target.LockoutAttemptCount ELSE source.LockoutAttemptCount END,
    ForceRandomForNewUsers       = CASE WHEN source.ActionID = 0 THEN target.ForceRandomForNewUsers ELSE source.ForceRandomForNewUsers END,
    PreventPasswordSimilarToName = CASE WHEN source.ActionID = 0 THEN target.PreventPasswordSimilarToName ELSE source.PreventPasswordSimilarToName END,
    CreatedBy                    = CASE WHEN source.ActionID = 0 THEN target.CreatedBy ELSE source.CreatedBy END,
    CreateDate                   = CASE WHEN source.ActionID = 0 THEN target.CreateDate ELSE source.CreateDate END,
    ModifiedBy                   = CASE WHEN source.ActionID = 0 THEN target.ModifiedBy ELSE source.ModifiedBy END,
    ModifiedDate                 = CASE WHEN source.ActionID = 0 THEN target.ModifiedDate ELSE source.ModifiedDate END,
    MFAEnabled                   = CASE WHEN source.ActionID = 0 THEN target.MFAEnabled ELSE source.MFAEnabled END
WHEN NOT MATCHED THEN INSERT (ActionID, PasswordPolicyID, SecurityProfileID, Bus_No, RememberPasswordCount, MinimumLength, MaximumAgeDays, RandomPasswordLife, MinimumLowerCase, MinimumUpperCase, MinimumNumeric, MinimumNonAlphaNumeric, LockoutAttemptCount, ForceRandomForNewUsers, PreventPasswordSimilarToName, CreatedBy, CreateDate, ModifiedBy, ModifiedDate, MFAEnabled) VALUES (source.ActionID, source.PasswordPolicyID, source.SecurityProfileID, source.Bus_No, source.RememberPasswordCount, source.MinimumLength, source.MaximumAgeDays, source.RandomPasswordLife, source.MinimumLowerCase, source.MinimumUpperCase, source.MinimumNumeric, source.MinimumNonAlphaNumeric, source.LockoutAttemptCount, source.ForceRandomForNewUsers, source.PreventPasswordSimilarToName, source.CreatedBy, source.CreateDate, source.ModifiedBy, source.ModifiedDate, source.MFAEnabled)</td>
        <td>92</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.SecurityProfileID ELSE source.SecurityProfileID END</td>
        <td>104</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Bus_No ELSE source.Bus_No END</td>
        <td>105</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.RememberPasswordCount ELSE source.RememberPasswordCount END</td>
        <td>106</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.MinimumLength ELSE source.MinimumLength END</td>
        <td>107</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.MaximumAgeDays ELSE source.MaximumAgeDays END</td>
        <td>108</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.RandomPasswordLife ELSE source.RandomPasswordLife END</td>
        <td>109</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.MinimumLowerCase ELSE source.MinimumLowerCase END</td>
        <td>110</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.MinimumUpperCase ELSE source.MinimumUpperCase END</td>
        <td>111</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.MinimumNumeric ELSE source.MinimumNumeric END</td>
        <td>112</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.MinimumNonAlphaNumeric ELSE source.MinimumNonAlphaNumeric END</td>
        <td>113</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.LockoutAttemptCount ELSE source.LockoutAttemptCount END</td>
        <td>114</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.ForceRandomForNewUsers ELSE source.ForceRandomForNewUsers END</td>
        <td>115</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.PreventPasswordSimilarToName ELSE source.PreventPasswordSimilarToName END</td>
        <td>116</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.CreatedBy ELSE source.CreatedBy END</td>
        <td>117</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.CreateDate ELSE source.CreateDate END</td>
        <td>118</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.ModifiedBy ELSE source.ModifiedBy END</td>
        <td>119</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.ModifiedDate ELSE source.ModifiedDate END</td>
        <td>120</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.MFAEnabled ELSE source.MFAEnabled END</td>
        <td>121</td>
      </tr>
    </table>
  </body>
</html>