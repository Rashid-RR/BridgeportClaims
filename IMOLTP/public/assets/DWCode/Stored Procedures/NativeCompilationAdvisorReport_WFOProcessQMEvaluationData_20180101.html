<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[WFOProcessQMEvaluationData]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[WFOProcessQMEvaluationData]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:12 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">Subquery</td>
        <td colspan="1">(SELECT object_id('tempdb..#UnProcessedRecords'))</td>
        <td>6</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">(SELECT object_id('tempdb..#UnProcessedRecordsWithAgentDetails '))</td>
        <td>15</td>
      </tr>
      <tr valign="top">
        <td colspan="1">OBJECT_ID</td>
        <td colspan="1">object_id('tempdb..#UnProcessedRecords')</td>
        <td>6</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">object_id('tempdb..#UnProcessedRecordsWithAgentDetails ')</td>
        <td>15</td>
      </tr>
      <tr valign="top">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT *
INTO   #UnProcessedRecords
FROM   [STAGING].[WFOQMEvaluationData]
WHERE  [PROCESSED] = 0</td>
        <td>11</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT T.[eval_key],
       T.[group_name],
       T.[eval_local_datetime],
       T.[eval_system_datetime],
       T.Score,
       T.[pass_fail],
       T.[sum_attained_scores],
       T.[sum_possible_scores],
       T.[max_possible_score],
       T.Notes,
       T.Comments,
       T.[is_screen],
       T.[SCD1],
       T.[SCD2],
       T.[SCD3],
       T.[SCD4],
       T.[SCD5],
       T.[SCD6],
       A.[AGENT_NO],
       B.[BUS_NO]
INTO   #UnProcessedRecordsWithAgentDetails
FROM   #UnProcessedRecords AS T
       INNER JOIN
       AGENTS AS A
       ON A.AGENT_NO = T.[evaluatee_key]
       INNER JOIN
       BUSINESS_UNIT AS B
       ON A.BUS_NO = B.BUS_NO</td>
        <td>21</td>
      </tr>
      <tr valign="top">
        <td colspan="1">*</td>
        <td colspan="1">SELECT *
INTO   #UnProcessedRecords
FROM   [STAGING].[WFOQMEvaluationData]
WHERE  [PROCESSED] = 0</td>
        <td>11</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">#UnProcessedRecords AS T</td>
        <td>42</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">AGENTS AS A</td>
        <td>43</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">BUSINESS_UNIT AS B</td>
        <td>44</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#UnProcessedRecordsWithAgentDetails AS Source</td>
        <td>48</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#UnProcessedRecordsWithAgentDetails AS UP</td>
        <td>95</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">STAGE</td>
        <td>98</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#UnProcessedRecords AS UP</td>
        <td>100</td>
      </tr>
      <tr valign="top">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO [DBO].[WFOQMEvaluationData]
 AS Dest
USING #UnProcessedRecordsWithAgentDetails AS Source ON Dest.[Evalkey] = Source.[eval_key]
                                                       AND Dest.[GroupName] = Source.[group_name]
WHEN MATCHED THEN DELETE</td>
        <td>47</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [DBO].[WFOQMEvaluationData]
 AS Dest
USING #UnProcessedRecordsWithAgentDetails AS Source ON Dest.[Evalkey] = Source.[eval_key]
                                                       AND Dest.[GroupName] = Source.[group_name]
WHEN MATCHED THEN DELETE</td>
        <td>47</td>
      </tr>
      <tr valign="top">
        <td colspan="1">UPDATE with FROM clause</td>
        <td colspan="1">
FROM [STAGING].[WFOQMEvaluationData] AS STAGE
     INNER JOIN
     #UnProcessedRecords AS UP
     ON UP.EVAL_KEY = STAGE.EVAL_KEY
        AND UP.group_name = STAGE.group_name</td>
        <td>99</td>
      </tr>
    </table>
  </body>
</html>