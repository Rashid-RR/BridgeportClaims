<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeFactResult]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeFactResult]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:11 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO dbo.FactResult
 AS target
USING #DWETLTable AS source ON (target.BusNo = source.BusNo
                                AND target.ResultID = source.ResultID)
WHEN MATCHED AND (target.IsInferred = 1
                  OR Target.SurveyCompleteDate != source.SurveyCompleteDate
                  OR Target.IsControllable != source.IsControllable) THEN UPDATE 
SET BusNo              = source.BusNo,
    ResultID           = source.ResultID,
    SurveyKey          = source.SurveyKey,
    InvitationKey      = source.InvitationKey,
    AgentKey           = source.AgentKey,
    ScoringAgentNo     = source.ScoringAgentNo,
    IsControllable     = source.IsControllable,
    SurveyStartDate    = source.SurveyStartDate,
    SurveyCompleteDate = source.SurveyCompleteDate,
    Score              = source.Score,
    AwardedPoints      = source.AwardedPoints,
    MaxPossiblePoints  = source.MaxPossiblePoints,
    IsInferred         = 0,
    SurveyID           = source.SurveyID,
    InvitationID       = source.InvitationID,
    AgentNo            = source.AgentNo,
    StatusTypeID       = source.StatusTypeID
WHEN NOT MATCHED THEN INSERT (BusNo, ResultID, SurveyKey, InvitationKey, AgentKey, ScoringAgentNo, IsControllable, SurveyStartDate, SurveyCompleteDate, Score, AwardedPoints, MaxPossiblePoints, SurveyID, InvitationID, AgentNo, StatusTypeID) VALUES (BusNo, ResultID, SurveyKey, InvitationKey, AgentKey, ScoringAgentNo, IsControllable, SurveyStartDate, SurveyCompleteDate, Score, AwardedPoints, MaxPossiblePoints, SurveyID, InvitationID, AgentNo, StatusTypeID)</td>
        <td>4</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO dbo.FactResult
 AS target
USING #DWETLTable AS source ON (target.BusNo = source.BusNo
                                AND target.ResultID = source.ResultID)
WHEN MATCHED AND (target.IsInferred = 1
                  OR Target.SurveyCompleteDate != source.SurveyCompleteDate
                  OR Target.IsControllable != source.IsControllable) THEN UPDATE 
SET BusNo              = source.BusNo,
    ResultID           = source.ResultID,
    SurveyKey          = source.SurveyKey,
    InvitationKey      = source.InvitationKey,
    AgentKey           = source.AgentKey,
    ScoringAgentNo     = source.ScoringAgentNo,
    IsControllable     = source.IsControllable,
    SurveyStartDate    = source.SurveyStartDate,
    SurveyCompleteDate = source.SurveyCompleteDate,
    Score              = source.Score,
    AwardedPoints      = source.AwardedPoints,
    MaxPossiblePoints  = source.MaxPossiblePoints,
    IsInferred         = 0,
    SurveyID           = source.SurveyID,
    InvitationID       = source.InvitationID,
    AgentNo            = source.AgentNo,
    StatusTypeID       = source.StatusTypeID
WHEN NOT MATCHED THEN INSERT (BusNo, ResultID, SurveyKey, InvitationKey, AgentKey, ScoringAgentNo, IsControllable, SurveyStartDate, SurveyCompleteDate, Score, AwardedPoints, MaxPossiblePoints, SurveyID, InvitationID, AgentNo, StatusTypeID) VALUES (BusNo, ResultID, SurveyKey, InvitationKey, AgentKey, ScoringAgentNo, IsControllable, SurveyStartDate, SurveyCompleteDate, Score, AwardedPoints, MaxPossiblePoints, SurveyID, InvitationID, AgentNo, StatusTypeID)</td>
        <td>4</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">#DWETLTable AS source</td>
        <td>5</td>
      </tr>
    </table>
  </body>
</html>