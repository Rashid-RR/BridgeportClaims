<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeExtensibleReportPermissions]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeExtensibleReportPermissions]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:11 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO [dbo].[ExtensibleReportPermissions]
 AS target
USING (SELECT ExtensibleReportPermissionID,
              ExtensibleReportID,
              Bus_No,
              CreatedBy,
              CreatedDate,
              ModifiedBy,
              ModifiedDate
       FROM   (SELECT ExtensibleReportPermissionID,
                      ExtensibleReportID,
                      Bus_No,
                      CreatedBy,
                      CreatedDate,
                      ModifiedBy,
                      ModifiedDate,
                      ROW_NUMBER() OVER (PARTITION BY ExtensibleReportPermissionID ORDER BY ExtensibleReportPermissionID) AS RowNum
               FROM   [ETL].[ExtensibleReportPermissions]) AS dup
       WHERE  dup.RowNum = 1) AS source ON (target.ExtensibleReportPermissionID = source.ExtensibleReportPermissionID)
WHEN MATCHED AND (target.ExtensibleReportID != source.ExtensibleReportID
                  OR target.Bus_No != source.Bus_No
                  OR CASE WHEN target.CreatedBy = source.CreatedBy
                               OR target.CreatedBy IS NULL
                                  AND source.CreatedBy IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.CreatedDate = source.CreatedDate
                               OR target.CreatedDate IS NULL
                                  AND source.CreatedDate IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.ModifiedBy = source.ModifiedBy
                               OR target.ModifiedBy IS NULL
                                  AND source.ModifiedBy IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.ModifiedDate = source.ModifiedDate
                               OR target.ModifiedDate IS NULL
                                  AND source.ModifiedDate IS NULL THEN 0 END IS NULL) THEN UPDATE 
SET ExtensibleReportID = source.ExtensibleReportID,
    Bus_No             = source.Bus_No,
    CreatedBy          = source.CreatedBy,
    CreatedDate        = source.CreatedDate,
    ModifiedBy         = source.ModifiedBy,
    ModifiedDate       = source.ModifiedDate
WHEN NOT MATCHED THEN INSERT (ExtensibleReportPermissionID, ExtensibleReportID, Bus_No, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) VALUES (source.ExtensibleReportPermissionID, source.ExtensibleReportID, source.Bus_No, source.CreatedBy, source.CreatedDate, source.ModifiedBy, source.ModifiedDate)
WHEN NOT MATCHED BY SOURCE THEN DELETE</td>
        <td>5</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [dbo].[ExtensibleReportPermissions]
 AS target
USING (SELECT ExtensibleReportPermissionID,
              ExtensibleReportID,
              Bus_No,
              CreatedBy,
              CreatedDate,
              ModifiedBy,
              ModifiedDate
       FROM   (SELECT ExtensibleReportPermissionID,
                      ExtensibleReportID,
                      Bus_No,
                      CreatedBy,
                      CreatedDate,
                      ModifiedBy,
                      ModifiedDate,
                      ROW_NUMBER() OVER (PARTITION BY ExtensibleReportPermissionID ORDER BY ExtensibleReportPermissionID) AS RowNum
               FROM   [ETL].[ExtensibleReportPermissions]) AS dup
       WHERE  dup.RowNum = 1) AS source ON (target.ExtensibleReportPermissionID = source.ExtensibleReportPermissionID)
WHEN MATCHED AND (target.ExtensibleReportID != source.ExtensibleReportID
                  OR target.Bus_No != source.Bus_No
                  OR CASE WHEN target.CreatedBy = source.CreatedBy
                               OR target.CreatedBy IS NULL
                                  AND source.CreatedBy IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.CreatedDate = source.CreatedDate
                               OR target.CreatedDate IS NULL
                                  AND source.CreatedDate IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.ModifiedBy = source.ModifiedBy
                               OR target.ModifiedBy IS NULL
                                  AND source.ModifiedBy IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.ModifiedDate = source.ModifiedDate
                               OR target.ModifiedDate IS NULL
                                  AND source.ModifiedDate IS NULL THEN 0 END IS NULL) THEN UPDATE 
SET ExtensibleReportID = source.ExtensibleReportID,
    Bus_No             = source.Bus_No,
    CreatedBy          = source.CreatedBy,
    CreatedDate        = source.CreatedDate,
    ModifiedBy         = source.ModifiedBy,
    ModifiedDate       = source.ModifiedDate
WHEN NOT MATCHED THEN INSERT (ExtensibleReportPermissionID, ExtensibleReportID, Bus_No, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) VALUES (source.ExtensibleReportPermissionID, source.ExtensibleReportID, source.Bus_No, source.CreatedBy, source.CreatedDate, source.ModifiedBy, source.ModifiedDate)
WHEN NOT MATCHED BY SOURCE THEN DELETE</td>
        <td>5</td>
      </tr>
      <tr valign="top">
        <td colspan="1">ROW_NUMBER</td>
        <td colspan="1">ROW_NUMBER() OVER (PARTITION BY ExtensibleReportPermissionID ORDER BY ExtensibleReportPermissionID)</td>
        <td>26</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">OVER</td>
        <td colspan="1">OVER (PARTITION BY ExtensibleReportPermissionID ORDER BY ExtensibleReportPermissionID)</td>
        <td>26</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN target.CreatedBy = source.CreatedBy
          OR target.CreatedBy IS NULL
             AND source.CreatedBy IS NULL THEN 0 END</td>
        <td>41</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.CreatedDate = source.CreatedDate
          OR target.CreatedDate IS NULL
             AND source.CreatedDate IS NULL THEN 0 END</td>
        <td>42</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.ModifiedBy = source.ModifiedBy
          OR target.ModifiedBy IS NULL
             AND source.ModifiedBy IS NULL THEN 0 END</td>
        <td>43</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.ModifiedDate = source.ModifiedDate
          OR target.ModifiedDate IS NULL
             AND source.ModifiedDate IS NULL THEN 0 END</td>
        <td>44</td>
      </tr>
    </table>
  </body>
</html>