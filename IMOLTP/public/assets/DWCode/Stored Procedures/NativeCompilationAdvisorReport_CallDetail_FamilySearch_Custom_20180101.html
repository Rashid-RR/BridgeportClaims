<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_FamilySearch_Custom]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_FamilySearch_Custom]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:09 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">BEGIN TRANSACTION</td>
        <td colspan="1">BEGIN TRANSACTION</td>
        <td>1</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">EXECUTE LockCriticalSection '[dbo].[CallDetail_FamilySearch_Custom]'</td>
        <td>5</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#Contact_Log_Header AS l</td>
        <td>109</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#CallBackTemp AS CBT</td>
        <td>111</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#FSScript_values AS FSS</td>
        <td>117</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">OBJECT_ID</td>
        <td colspan="1">OBJECT_ID('tempdb..#CallBackTemp')</td>
        <td>9</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">OBJECT_ID('tempdb..#FSScript_Values')</td>
        <td>11</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">OBJECT_ID('tempdb..#Contact_Log_Header')</td>
        <td>13</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">OBJECT_ID('tempdb..#CallBackTemp')</td>
        <td>120</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">OBJECT_ID('tempdb..#FSScript_Values')</td>
        <td>122</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">OBJECT_ID('tempdb..#Contact_Log_Header')</td>
        <td>124</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT   D.Contact_ID,
         SUM(duration) AS CallBackTime
INTO     #CallBackTemp
FROM     dbo.contact_log_detail AS d
         INNER JOIN
         dbo.contact_log_detail_summary AS s
         ON s.Contact_ID = d.Contact_ID
            AND s.StateIndex = d.StateIndex
WHERE    d.contact_ID IN (SELECT contact_id
                          FROM   dbo.Contact_Log_Header)
         AND d.contact_state = 15
         AND d.bus_no = @p_Bus_no
         AND d.start_date BETWEEN @p_UTCStart_Date AND @p_UTCEnd_Date
GROUP BY D.contact_ID</td>
        <td>17</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT contact_id,
       [ANICountry],
       [ANIState],
       [ANICity],
       [SFCaseNum],
       [ScriptXferYN],
       [ScriptXferFrom],
       [RunScript]
INTO   #FSScript_Values
FROM   (SELECT contact_ID,
               data_name,
               data_value
        FROM   dbo.custom_contact_log
        WHERE  bus_no = @p_Bus_no
               AND start_Date BETWEEN @p_UTCStart_Date AND @p_UTCEnd_Date) AS FSSourceTable PIVOT (MAX (data_value) FOR data_name IN (ANICountry, ANIState, ANICity, SFCaseNum, ScriptXferYN, ScriptXferFrom, RunScript)) AS FSPivotTable</td>
        <td>27</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT l.contact_id,
       l.master_contact_id,
       m.media_name,
       CONVERT (NVARCHAR (12), dbo.fn_ConvertUTCToTargetTimeZone(l.start_date, @p_TimeZone), 101) AS start_date,
       CONVERT (NVARCHAR (8), dbo.fn_ConvertUTCToTargetTimeZone(l.start_date, @p_TimeZone), 114) AS start_time,
       ReskillIndicator
INTO   #Contact_Log_Header
FROM   dbo.Contact_Log_Header AS l
       INNER JOIN
       dbo.media AS m
       ON l.media_type = m.media_type
WHERE  l.bus_no = @p_Bus_no
       AND l.start_date BETWEEN @p_UTCStart_Date AND @p_UTCEnd_Date</td>
        <td>44</td>
      </tr>
      <tr valign="top">
        <td colspan="1">PIVOT</td>
        <td colspan="1">(SELECT contact_ID,
        data_name,
        data_value
 FROM   dbo.custom_contact_log
 WHERE  bus_no = @p_Bus_no
        AND start_Date BETWEEN @p_UTCStart_Date AND @p_UTCEnd_Date) AS FSSourceTable PIVOT (MAX (data_value) FOR data_name IN (ANICountry, ANIState, ANICity, SFCaseNum, ScriptXferYN, ScriptXferFrom, RunScript)) AS FSPivotTable</td>
        <td>31</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN (s.abandon_time &gt; 0
           AND s.isShortAbandon = 0) THEN 'Y' ELSE 'N' END</td>
        <td>96</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (CBT.CallBackTime &gt; 0) THEN 'Y' ELSE 'N' END</td>
        <td>100</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (l.ReskillIndicator IN (1, 2)
           OR FSS.ScriptXferYN = 'True') THEN 'Y' ELSE 'N' END</td>
        <td>104</td>
      </tr>
      <tr valign="top">
        <td colspan="1">COMMIT TRANSACTION</td>
        <td colspan="1">COMMIT TRANSACTION</td>
        <td>127</td>
      </tr>
    </table>
  </body>
</html>