<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeSecuritySecurityProfiles]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeSecuritySecurityProfiles]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:09 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO [dbo].[Security_SecurityProfiles]
 AS target
USING [ETL].[Security_SecurityProfiles] AS source ON (target.SecurityProfileID = source.SecurityProfileID)
WHEN MATCHED AND source.ActionID = 0 THEN DELETE
WHEN MATCHED AND source.ActionID IN (1, 2, 3) THEN UPDATE 
SET ProfileName             = source.ProfileName,
    Description             = source.Description,
    Bus_No                  = source.Bus_No,
    SecurityProfileStatusID = source.SecurityProfileStatusID,
    IsDefault               = source.IsDefault,
    IsSupport               = source.IsSupport,
    IsInternal              = source.IsInternal,
    CreatedBy               = source.CreatedBy,
    CreateDate              = source.CreateDate,
    ModifiedBy              = source.ModifiedBy,
    ModifiedDate            = source.ModifiedDate
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (SecurityProfileID, ProfileName, Description, Bus_No, SecurityProfileStatusID, IsDefault, IsSupport, IsInternal, CreatedBy, CreateDate, ModifiedBy, ModifiedDate) VALUES (source.SecurityProfileID, source.ProfileName, source.Description, source.Bus_No, source.SecurityProfileStatusID, source.IsDefault, source.IsSupport, source.IsInternal, source.CreatedBy, source.CreateDate, source.ModifiedBy, source.ModifiedDate)</td>
        <td>5</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [dbo].[Security_SecurityProfiles]
 AS target
USING [ETL].[Security_SecurityProfiles] AS source ON (target.SecurityProfileID = source.SecurityProfileID)
WHEN MATCHED AND source.ActionID = 0 THEN DELETE
WHEN MATCHED AND source.ActionID IN (1, 2, 3) THEN UPDATE 
SET ProfileName             = source.ProfileName,
    Description             = source.Description,
    Bus_No                  = source.Bus_No,
    SecurityProfileStatusID = source.SecurityProfileStatusID,
    IsDefault               = source.IsDefault,
    IsSupport               = source.IsSupport,
    IsInternal              = source.IsInternal,
    CreatedBy               = source.CreatedBy,
    CreateDate              = source.CreateDate,
    ModifiedBy              = source.ModifiedBy,
    ModifiedDate            = source.ModifiedDate
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (SecurityProfileID, ProfileName, Description, Bus_No, SecurityProfileStatusID, IsDefault, IsSupport, IsInternal, CreatedBy, CreateDate, ModifiedBy, ModifiedDate) VALUES (source.SecurityProfileID, source.ProfileName, source.Description, source.Bus_No, source.SecurityProfileStatusID, source.IsDefault, source.IsSupport, source.IsInternal, source.CreatedBy, source.CreateDate, source.ModifiedBy, source.ModifiedDate)</td>
        <td>5</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [Staging].[Security_SecurityProfiles]
 AS target
USING [ETL].[Security_SecurityProfiles] AS source ON (target.SecurityProfileID = source.SecurityProfileID)
WHEN MATCHED THEN UPDATE 
SET ActionID                = source.ActionID,
    ProfileName             = CASE WHEN source.ActionID = 0 THEN target.ProfileName ELSE source.ProfileName END,
    Description             = CASE WHEN source.ActionID = 0 THEN target.Description ELSE source.Description END,
    Bus_No                  = CASE WHEN source.ActionID = 0 THEN target.Bus_No ELSE source.Bus_No END,
    SecurityProfileStatusID = CASE WHEN source.ActionID = 0 THEN target.SecurityProfileStatusID ELSE source.SecurityProfileStatusID END,
    IsDefault               = CASE WHEN source.ActionID = 0 THEN target.IsDefault ELSE source.IsDefault END,
    IsSupport               = CASE WHEN source.ActionID = 0 THEN target.IsSupport ELSE source.IsSupport END,
    IsInternal              = CASE WHEN source.ActionID = 0 THEN target.IsInternal ELSE source.IsInternal END,
    CreatedBy               = CASE WHEN source.ActionID = 0 THEN target.CreatedBy ELSE source.CreatedBy END,
    CreateDate              = CASE WHEN source.ActionID = 0 THEN target.CreateDate ELSE source.CreateDate END,
    ModifiedBy              = CASE WHEN source.ActionID = 0 THEN target.ModifiedBy ELSE source.ModifiedBy END,
    ModifiedDate            = CASE WHEN source.ActionID = 0 THEN target.ModifiedDate ELSE source.ModifiedDate END
WHEN NOT MATCHED THEN INSERT (ActionID, SecurityProfileID, ProfileName, Description, Bus_No, SecurityProfileStatusID, IsDefault, IsSupport, IsInternal, CreatedBy, CreateDate, ModifiedBy, ModifiedDate) VALUES (source.ActionID, source.SecurityProfileID, source.ProfileName, source.Description, source.Bus_No, source.SecurityProfileStatusID, source.IsDefault, source.IsSupport, source.IsInternal, source.CreatedBy, source.CreateDate, source.ModifiedBy, source.ModifiedDate)</td>
        <td>71</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [Staging].[Security_SecurityProfiles]
 AS target
USING [ETL].[Security_SecurityProfiles] AS source ON (target.SecurityProfileID = source.SecurityProfileID)
WHEN MATCHED THEN UPDATE 
SET ActionID                = source.ActionID,
    ProfileName             = CASE WHEN source.ActionID = 0 THEN target.ProfileName ELSE source.ProfileName END,
    Description             = CASE WHEN source.ActionID = 0 THEN target.Description ELSE source.Description END,
    Bus_No                  = CASE WHEN source.ActionID = 0 THEN target.Bus_No ELSE source.Bus_No END,
    SecurityProfileStatusID = CASE WHEN source.ActionID = 0 THEN target.SecurityProfileStatusID ELSE source.SecurityProfileStatusID END,
    IsDefault               = CASE WHEN source.ActionID = 0 THEN target.IsDefault ELSE source.IsDefault END,
    IsSupport               = CASE WHEN source.ActionID = 0 THEN target.IsSupport ELSE source.IsSupport END,
    IsInternal              = CASE WHEN source.ActionID = 0 THEN target.IsInternal ELSE source.IsInternal END,
    CreatedBy               = CASE WHEN source.ActionID = 0 THEN target.CreatedBy ELSE source.CreatedBy END,
    CreateDate              = CASE WHEN source.ActionID = 0 THEN target.CreateDate ELSE source.CreateDate END,
    ModifiedBy              = CASE WHEN source.ActionID = 0 THEN target.ModifiedBy ELSE source.ModifiedBy END,
    ModifiedDate            = CASE WHEN source.ActionID = 0 THEN target.ModifiedDate ELSE source.ModifiedDate END
WHEN NOT MATCHED THEN INSERT (ActionID, SecurityProfileID, ProfileName, Description, Bus_No, SecurityProfileStatusID, IsDefault, IsSupport, IsInternal, CreatedBy, CreateDate, ModifiedBy, ModifiedDate) VALUES (source.ActionID, source.SecurityProfileID, source.ProfileName, source.Description, source.Bus_No, source.SecurityProfileStatusID, source.IsDefault, source.IsSupport, source.IsInternal, source.CreatedBy, source.CreateDate, source.ModifiedBy, source.ModifiedDate)</td>
        <td>71</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.ProfileName ELSE source.ProfileName END</td>
        <td>83</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Description ELSE source.Description END</td>
        <td>84</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Bus_No ELSE source.Bus_No END</td>
        <td>85</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.SecurityProfileStatusID ELSE source.SecurityProfileStatusID END</td>
        <td>86</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.IsDefault ELSE source.IsDefault END</td>
        <td>87</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.IsSupport ELSE source.IsSupport END</td>
        <td>88</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.IsInternal ELSE source.IsInternal END</td>
        <td>89</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.CreatedBy ELSE source.CreatedBy END</td>
        <td>90</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.CreateDate ELSE source.CreateDate END</td>
        <td>91</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.ModifiedBy ELSE source.ModifiedBy END</td>
        <td>92</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.ModifiedDate ELSE source.ModifiedDate END</td>
        <td>93</td>
      </tr>
    </table>
  </body>
</html>