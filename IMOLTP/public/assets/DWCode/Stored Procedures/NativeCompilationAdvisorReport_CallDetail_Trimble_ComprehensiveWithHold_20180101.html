<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_Trimble_ComprehensiveWithHold]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_Trimble_ComprehensiveWithHold]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:11 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">BEGIN TRANSACTION</td>
        <td colspan="1">BEGIN TRANSACTION</td>
        <td>1</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">EXECUTE LockCriticalSection '[dbo].[CallDetail_Trimble_ComprehensiveWithHold]'</td>
        <td>5</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dw_contact_log</td>
        <td>69</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dw_contact_log</td>
        <td>77</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dw_contact_log</td>
        <td>83</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dw_contact_log AS l</td>
        <td>120</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#RoutingTemp AS RT</td>
        <td>121</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#CallBackTemp AS CBT</td>
        <td>122</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#DispoTemp AS DSC</td>
        <td>123</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dw_LSE AS LSE_alias</td>
        <td>130</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dw_ORF AS ORF_alias</td>
        <td>131</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dw_ND AS ND_alias</td>
        <td>132</td>
      </tr>
      <tr valign="top">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT l.contact_id,
       l.master_contact_id,
       l.bus_no,
       l.contact_code,
       r.skill_no,
       r.campaign_no,
       IsNull(r.agent_no, 0) AS agent_no,
       IsNull(r.team_no, 0) AS team_no,
       NULL AS archived,
       IsNull(s.sla, 0) AS sla,
       l.Start_Date,
       s.prequeue_time,
       s.inqueue_time,
       s.agent_time,
       s.postqueue_time,
       s.abandon_time,
       r.abandon,
       r.from_addr,
       r.to_addr,
       s.Hold_time,
       s.Release_time
INTO   #dw_contact_log
FROM   dbo.Contact_Log_Header AS l
       LEFT OUTER JOIN
       dbo.Contact_Log_Footer AS r
       ON r.Contact_ID = l.Contact_ID
       LEFT OUTER JOIN
       dbo.Contact_Log_Summary AS s
       ON s.Contact_ID = l.Contact_ID
WHERE  l.bus_no = @p_Bus_no
       AND l.lasttouched BETWEEN @p_UTCStart_Date AND @p_UTCEnd_Date</td>
        <td>21</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT Contact_ID,
       Data_Value
INTO   #dw_LSE
FROM   dbo.Custom_Contact_Log
WHERE  Data_Name = 'LastScriptEntered'</td>
        <td>49</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT Contact_Id,
       Data_Value
INTO   #dw_ORF
FROM   dbo.Custom_Contact_Log
WHERE  Data_Name = 'OnReleaseFired'</td>
        <td>54</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT Contact_Id,
       Data_Value
INTO   #dw_ND
FROM   dbo.Custom_Contact_Log
WHERE  Data_Name = 'NumberDialed'</td>
        <td>59</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT   d.Contact_id,
         SUM(duration) AS RoutingTime
INTO     #RoutingTemp
FROM     dbo.contact_log_detail AS d
         INNER JOIN
         dbo.contact_log_detail_summary AS s
         ON s.Contact_ID = d.Contact_ID
            AND s.StateIndex = d.StateIndex
WHERE    d.Contact_ID IN (SELECT contact_id
                          FROM   #dw_contact_log)
         AND d.contact_state = 2
GROUP BY d.Contact_ID</td>
        <td>64</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT   D.Contact_ID,
         SUM(duration) AS CallBackTime
INTO     #CallBackTemp
FROM     dbo.contact_log_detail AS d
         INNER JOIN
         dbo.contact_log_detail_summary AS s
         ON s.Contact_ID = d.Contact_ID
            AND s.StateIndex = d.StateIndex
WHERE    d.contact_ID IN (SELECT contact_id
                          FROM   #dw_contact_log)
         AND d.contact_state = 15
GROUP BY D.contact_ID</td>
        <td>72</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT   Contact_id,
         MAX(disposition_code) AS DispCode
INTO     #DispoTemp
FROM     dbo.contact_log_dispositions AS d
WHERE    d.contact_id IN (SELECT contact_id
                          FROM   #dw_contact_log)
GROUP BY d.contact_id</td>
        <td>80</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN (clg.contact_id IS NOT NULL) THEN 'Y' ELSE 'N' END</td>
        <td>113</td>
      </tr>
      <tr valign="top">
        <td colspan="1">COMMIT TRANSACTION</td>
        <td colspan="1">COMMIT TRANSACTION</td>
        <td>142</td>
      </tr>
    </table>
  </body>
</html>