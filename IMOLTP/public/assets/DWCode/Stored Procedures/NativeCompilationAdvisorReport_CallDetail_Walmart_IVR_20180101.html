<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_Walmart_IVR]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_Walmart_IVR]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:11 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">BEGIN TRANSACTION</td>
        <td colspan="1">BEGIN TRANSACTION</td>
        <td>1</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">EXECUTE LockCriticalSection 'CallDetail_Walmart_IVR'</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#SourceTable AS s</td>
        <td>60</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#SourceTable AS s</td>
        <td>77</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#wlmrt_Values2</td>
        <td>83</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#wlmrt_Values</td>
        <td>109</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#wlmrt_Values2</td>
        <td>131</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>6</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>7</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT h.[Master_Contact_Id],
       h.[Contact_Id],
       l.[Data_Name],
       l.[Data_Value],
       f.[End_Date]
INTO   #SourceTable
FROM   [dbo].[Contact_Log_Header] AS h
       INNER JOIN
       [dbo].[Contact_Log_Footer] AS f
       ON f.[Contact_ID] = h.[Contact_ID]
       INNER JOIN
       [dbo].[Custom_Contact_Log] AS l
       ON l.[Contact_ID] = h.[Contact_ID]
WHERE  h.[bus_no] = @p_Bus_no
       AND h.[start_date] BETWEEN @p_UTCStart_Date AND @p_UTCEnd_Date
OPTION (OPTIMIZE FOR (@p_UTCStart_Date = '1/1/2016', @p_UTCEnd_Date = '1/2/2016'))</td>
        <td>34</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT Master_Contact_Id,
       Contact_Id,
       mainmenuoptionid,
       mainmenuname,
       menuoptionvalue,
       mainmenuspent,
       MainMenustart,
       mainmenuend,
       latency,
       end_date
INTO   #wlmrt_Values
FROM   #SourceTable AS s PIVOT (MAX (s.[Data_Value]) FOR s.[Data_Name] IN (mainmenuoptionid, mainmenuname, menuoptionvalue, mainmenuspent, MainMenustart, mainmenuend, latency)) AS wlmrtPivotTable</td>
        <td>48</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT Master_Contact_Id,
       Contact_Id,
       DotComStart,
       DotComMenuID,
       DotComName,
       DotComSpent,
       DotComEnd,
       DotComOptionValue,
       End_date
INTO   #wlmrt_Values2
FROM   #SourceTable AS s PIVOT (MAX ([Data_Value]) FOR [Data_Name] IN (DotComStart, DotComMenuID, DotComName, DotComSpent, DotComEnd, DotComOptionValue)) AS wlmrtPivotTable</td>
        <td>66</td>
      </tr>
      <tr valign="top">
        <td colspan="1">PIVOT</td>
        <td colspan="1">#SourceTable AS s PIVOT (MAX (s.[Data_Value]) FOR s.[Data_Name] IN (mainmenuoptionid, mainmenuname, menuoptionvalue, mainmenuspent, MainMenustart, mainmenuend, latency)) AS wlmrtPivotTable</td>
        <td>60</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#SourceTable AS s PIVOT (MAX ([Data_Value]) FOR [Data_Name] IN (DotComStart, DotComMenuID, DotComName, DotComSpent, DotComEnd, DotComOptionValue)) AS wlmrtPivotTable</td>
        <td>77</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE ISNULL(mainmenuspent, 'nullvalue') WHEN 'nullvalue' THEN CASE ISNULL(DATEDIFF(SECOND, [dbo].[fn_ConvertTimeZoneToUTC](mainmenustart, 'Central'), [End_date]), 0) WHEN 0 THEN '0' ELSE DATEDIFF(SECOND, [dbo].[fn_ConvertTimeZoneToUTC](mainmenustart, 'Central'), [End_date]) END ELSE DATEDIFF(SECOND, mainmenustart, mainmenuend) END</td>
        <td>92</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE ISNULL(DATEDIFF(SECOND, [dbo].[fn_ConvertTimeZoneToUTC](mainmenustart, 'Central'), [End_date]), 0) WHEN 0 THEN '0' ELSE DATEDIFF(SECOND, [dbo].[fn_ConvertTimeZoneToUTC](mainmenustart, 'Central'), [End_date]) END</td>
        <td>93</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ISNULL(mainmenustart, '') = '' THEN CONVERT (NVARCHAR (20), [End_Date], 120) ELSE CONVERT (NVARCHAR (20), ISNULL([dbo].[fn_ConvertTimeZoneToUTC](mainmenustart, 'Central'), ''), 120) END</td>
        <td>99</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ISNULL(mainmenuend, '') = '' THEN CONVERT (NVARCHAR (20), [End_Date], 120) ELSE CONVERT (NVARCHAR (20), ISNULL([dbo].[fn_ConvertTimeZoneToUTC](mainmenuend, 'Central'), ''), 120) END</td>
        <td>103</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE ISNULL(DATEDIFF(SECOND, dotcomstart, dotcomend), 0) WHEN 0 THEN DATEDIFF(SECOND, [dbo].[fn_ConvertTimeZoneToUTC](dotcomstart, 'Central'), [End_date]) ELSE DATEDIFF(SECOND, dotcomstart, dotcomend) END</td>
        <td>117</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ISNULL(DotComStart, '') = '' THEN CONVERT (NVARCHAR (20), [End_Date], 120) ELSE CONVERT (NVARCHAR (20), ISNULL([dbo].[fn_ConvertTimeZoneToUTC](dotcomstart, 'Central'), ''), 120) END</td>
        <td>121</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ISNULL(DotComEnd, '') = '' THEN CONVERT (NVARCHAR (20), [End_Date], 120) ELSE CONVERT (NVARCHAR (20), ISNULL([dbo].[fn_ConvertTimeZoneToUTC](dotcomend, 'Central'), ''), 120) END</td>
        <td>125</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">COMMIT TRANSACTION</td>
        <td colspan="1">COMMIT TRANSACTION</td>
        <td>135</td>
      </tr>
    </table>
  </body>
</html>