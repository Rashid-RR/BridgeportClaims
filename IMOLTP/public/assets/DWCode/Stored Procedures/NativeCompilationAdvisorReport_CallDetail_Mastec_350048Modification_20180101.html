<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_Mastec_350048Modification]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_Mastec_350048Modification]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:10 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SET OPTION OFF</td>
        <td colspan="1">SET FORCEPLAN OFF</td>
        <td>4</td>
      </tr>
      <tr valign="top">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT Contact_ID,
       bus_no,
       dbo.fn_ConvertUTCToTargetTimeZone(start_date, @p_TimeZone) AS [start_date],
       Contact_Code,
       Master_Contact_Id
INTO   #tmp_Contact_Log_Header
FROM   dbo.Contact_Log_Header AS H
WHERE  H.bus_no = @p_Bus_no
       AND H.lasttouched BETWEEN @p_UTCStart_Date AND @p_UTCEnd_Date</td>
        <td>18</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT   D.Contact_ID,
         SUM(CASE WHEN contact_state = 2 THEN S.Duration ELSE 0 END) AS Routing_Time,
         SUM(CASE WHEN contact_state = 15 THEN S.Duration ELSE 0 END) AS Callback_Time
INTO     #DetailInfo
FROM     dbo.Contact_Log_Detail AS D
         INNER JOIN
         dbo.Contact_Log_Detail_Summary AS S
         ON S.Contact_ID = D.Contact_ID
            AND S.StateIndex = D.StateIndex
            AND D.Contact_State IN (2, 15)
WHERE    D.bus_no = @p_Bus_no
         AND D.Header_Start_Date BETWEEN @p_UTCStart_Date AND @p_UTCEnd_Date
GROUP BY D.Contact_ID</td>
        <td>31</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN contact_state = 2 THEN S.Duration ELSE 0 END</td>
        <td>32</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN contact_state = 15 THEN S.Duration ELSE 0 END</td>
        <td>33</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.Outbound_Skill = 1 THEN r.to_addr ELSE r.from_addr END</td>
        <td>52</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (clg.contact_id IS NOT NULL) THEN 'Y' ELSE 'N' END</td>
        <td>77</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN CLD.Contact_ID IS NOT NULL THEN ISNULL(CLD.Disposition_Code, 0) WHEN CLD.Contact_ID IS NULL THEN '' ELSE 0 END</td>
        <td>85</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN CLD.Contact_ID IS NOT NULL THEN ISNULL(D.Description, 'N/A') WHEN CLD.Contact_ID IS NULL THEN '' ELSE 'N/A' END</td>
        <td>90</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN CLD.Contact_ID IS NOT NULL THEN ISNULL('"' + CLD.Disposition_Comments + '"', NULL) ELSE '' END</td>
        <td>95</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">#tmp_Contact_Log_Header AS l</td>
        <td>104</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#DetailInfo AS B</td>
        <td>129</td>
      </tr>
    </table>
  </body>
</html>