<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[DW_MergePersistentContactLog]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[DW_MergePersistentContactLog]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:11 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO [dbo].[PersistentContactLog]
 AS target
USING [ETL].[PersistentContactLog] AS source ON (target.Contact_Id = source.Contact_Id)
WHEN MATCHED AND source.ActionID = 0 THEN DELETE
WHEN MATCHED AND source.ActionID IN (1, 2, 3) THEN UPDATE 
SET Master_Contact_Id     = source.Master_Contact_Id,
    Bus_no                = source.Bus_no,
    Skill_No              = source.Skill_No,
    Campaign_no           = source.Campaign_no,
    Agent_No              = source.Agent_No,
    Team_No               = source.Team_No,
    start_date            = source.start_date,
    Media_Type            = source.Media_Type,
    to_addr               = source.to_addr,
    from_addr             = source.from_addr,
    current_contact_state = source.current_contact_state,
    current_contact_date  = source.current_contact_date,
    ReskillIndicator      = source.ReskillIndicator,
    CustomPortIndicator   = source.CustomPortIndicator,
    InitialPriority       = source.InitialPriority,
    Acceleration          = source.Acceleration,
    MaxPriority           = source.MaxPriority,
    LastInQueueStartTime  = source.LastInQueueStartTime,
    TargetAgent_no        = source.TargetAgent_no,
    InDeliveryProcess     = source.InDeliveryProcess,
    DeliverScript         = source.DeliverScript,
    FileName              = source.FileName,
    ScriptState           = source.ScriptState,
    ScriptStateIndex      = source.ScriptStateIndex,
    ScriptStateServer     = source.ScriptStateServer,
    Direction             = source.Direction,
    ApplicationName       = source.ApplicationName,
    Contact_Code          = source.Contact_Code
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (Contact_Id, Master_Contact_Id, Bus_no, Skill_No, Campaign_no, Agent_No, Team_No, start_date, Media_Type, to_addr, from_addr, current_contact_state, current_contact_date, ReskillIndicator, CustomPortIndicator, InitialPriority, Acceleration, MaxPriority, LastInQueueStartTime, TargetAgent_no, InDeliveryProcess, DeliverScript, FileName, ScriptState, ScriptStateIndex, ScriptStateServer, Direction, ApplicationName, Contact_Code) VALUES (source.Contact_Id, source.Master_Contact_Id, source.Bus_no, source.Skill_No, source.Campaign_no, source.Agent_No, source.Team_No, source.start_date, source.Media_Type, source.to_addr, source.from_addr, source.current_contact_state, source.current_contact_date, source.ReskillIndicator, source.CustomPortIndicator, source.InitialPriority, source.Acceleration, source.MaxPriority, source.LastInQueueStartTime, source.TargetAgent_no, source.InDeliveryProcess, source.DeliverScript, source.FileName, source.ScriptState, source.ScriptStateIndex, source.ScriptStateServer, source.Direction, source.ApplicationName, source.Contact_Code)</td>
        <td>5</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [dbo].[PersistentContactLog]
 AS target
USING [ETL].[PersistentContactLog] AS source ON (target.Contact_Id = source.Contact_Id)
WHEN MATCHED AND source.ActionID = 0 THEN DELETE
WHEN MATCHED AND source.ActionID IN (1, 2, 3) THEN UPDATE 
SET Master_Contact_Id     = source.Master_Contact_Id,
    Bus_no                = source.Bus_no,
    Skill_No              = source.Skill_No,
    Campaign_no           = source.Campaign_no,
    Agent_No              = source.Agent_No,
    Team_No               = source.Team_No,
    start_date            = source.start_date,
    Media_Type            = source.Media_Type,
    to_addr               = source.to_addr,
    from_addr             = source.from_addr,
    current_contact_state = source.current_contact_state,
    current_contact_date  = source.current_contact_date,
    ReskillIndicator      = source.ReskillIndicator,
    CustomPortIndicator   = source.CustomPortIndicator,
    InitialPriority       = source.InitialPriority,
    Acceleration          = source.Acceleration,
    MaxPriority           = source.MaxPriority,
    LastInQueueStartTime  = source.LastInQueueStartTime,
    TargetAgent_no        = source.TargetAgent_no,
    InDeliveryProcess     = source.InDeliveryProcess,
    DeliverScript         = source.DeliverScript,
    FileName              = source.FileName,
    ScriptState           = source.ScriptState,
    ScriptStateIndex      = source.ScriptStateIndex,
    ScriptStateServer     = source.ScriptStateServer,
    Direction             = source.Direction,
    ApplicationName       = source.ApplicationName,
    Contact_Code          = source.Contact_Code
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (Contact_Id, Master_Contact_Id, Bus_no, Skill_No, Campaign_no, Agent_No, Team_No, start_date, Media_Type, to_addr, from_addr, current_contact_state, current_contact_date, ReskillIndicator, CustomPortIndicator, InitialPriority, Acceleration, MaxPriority, LastInQueueStartTime, TargetAgent_no, InDeliveryProcess, DeliverScript, FileName, ScriptState, ScriptStateIndex, ScriptStateServer, Direction, ApplicationName, Contact_Code) VALUES (source.Contact_Id, source.Master_Contact_Id, source.Bus_no, source.Skill_No, source.Campaign_no, source.Agent_No, source.Team_No, source.start_date, source.Media_Type, source.to_addr, source.from_addr, source.current_contact_state, source.current_contact_date, source.ReskillIndicator, source.CustomPortIndicator, source.InitialPriority, source.Acceleration, source.MaxPriority, source.LastInQueueStartTime, source.TargetAgent_no, source.InDeliveryProcess, source.DeliverScript, source.FileName, source.ScriptState, source.ScriptStateIndex, source.ScriptStateServer, source.Direction, source.ApplicationName, source.Contact_Code)</td>
        <td>5</td>
      </tr>
    </table>
  </body>
</html>