<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeCallBacks]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeCallBacks]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:10 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO [dbo].[CallBacks]
 AS target
USING [ETL].[CallBacks] AS source ON (target.CallBack_ID = source.CallBack_ID)
WHEN MATCHED AND source.ActionID = 0 THEN DELETE
WHEN MATCHED AND source.ActionID IN (1, 2, 3) THEN UPDATE 
SET Bus_No             = source.Bus_No,
    Target_Type        = source.Target_Type,
    Agent_No           = source.Agent_No,
    Skill_No           = source.Skill_No,
    Originating_Number = source.Originating_Number,
    Number_To_Dial     = source.Number_To_Dial,
    First_Name         = source.First_Name,
    Last_Name          = source.Last_Name,
    CallBackTime       = source.CallBackTime,
    CallBackEndTime    = source.CallBackEndTime,
    Add_Date           = source.Add_Date,
    Deprecated_GUID    = source.Deprecated_GUID,
    Notes              = source.Notes,
    TimeZone           = source.TimeZone,
    CallBackType       = source.CallBackType
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (CallBack_ID, Bus_No, Target_Type, Agent_No, Skill_No, Originating_Number, Number_To_Dial, First_Name, Last_Name, CallBackTime, CallBackEndTime, Add_Date, Deprecated_GUID, Notes, TimeZone, CallBackType) VALUES (source.CallBack_ID, source.Bus_No, source.Target_Type, source.Agent_No, source.Skill_No, source.Originating_Number, source.Number_To_Dial, source.First_Name, source.Last_Name, source.CallBackTime, source.CallBackEndTime, source.Add_Date, source.Deprecated_GUID, source.Notes, source.TimeZone, source.CallBackType)</td>
        <td>5</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [dbo].[CallBacks]
 AS target
USING [ETL].[CallBacks] AS source ON (target.CallBack_ID = source.CallBack_ID)
WHEN MATCHED AND source.ActionID = 0 THEN DELETE
WHEN MATCHED AND source.ActionID IN (1, 2, 3) THEN UPDATE 
SET Bus_No             = source.Bus_No,
    Target_Type        = source.Target_Type,
    Agent_No           = source.Agent_No,
    Skill_No           = source.Skill_No,
    Originating_Number = source.Originating_Number,
    Number_To_Dial     = source.Number_To_Dial,
    First_Name         = source.First_Name,
    Last_Name          = source.Last_Name,
    CallBackTime       = source.CallBackTime,
    CallBackEndTime    = source.CallBackEndTime,
    Add_Date           = source.Add_Date,
    Deprecated_GUID    = source.Deprecated_GUID,
    Notes              = source.Notes,
    TimeZone           = source.TimeZone,
    CallBackType       = source.CallBackType
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (CallBack_ID, Bus_No, Target_Type, Agent_No, Skill_No, Originating_Number, Number_To_Dial, First_Name, Last_Name, CallBackTime, CallBackEndTime, Add_Date, Deprecated_GUID, Notes, TimeZone, CallBackType) VALUES (source.CallBack_ID, source.Bus_No, source.Target_Type, source.Agent_No, source.Skill_No, source.Originating_Number, source.Number_To_Dial, source.First_Name, source.Last_Name, source.CallBackTime, source.CallBackEndTime, source.Add_Date, source.Deprecated_GUID, source.Notes, source.TimeZone, source.CallBackType)</td>
        <td>5</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [Staging].[CallBacks]
 AS target
USING [ETL].[CallBacks] AS source ON (target.CallBack_ID = source.CallBack_ID)
WHEN MATCHED THEN UPDATE 
SET ActionID           = source.ActionID,
    Bus_No             = CASE WHEN source.ActionID = 0 THEN target.Bus_No ELSE source.Bus_No END,
    Target_Type        = CASE WHEN source.ActionID = 0 THEN target.Target_Type ELSE source.Target_Type END,
    Agent_No           = CASE WHEN source.ActionID = 0 THEN target.Agent_No ELSE source.Agent_No END,
    Skill_No           = CASE WHEN source.ActionID = 0 THEN target.Skill_No ELSE source.Skill_No END,
    Originating_Number = CASE WHEN source.ActionID = 0 THEN target.Originating_Number ELSE source.Originating_Number END,
    Number_To_Dial     = CASE WHEN source.ActionID = 0 THEN target.Number_To_Dial ELSE source.Number_To_Dial END,
    First_Name         = CASE WHEN source.ActionID = 0 THEN target.First_Name ELSE source.First_Name END,
    Last_Name          = CASE WHEN source.ActionID = 0 THEN target.Last_Name ELSE source.Last_Name END,
    CallBackTime       = CASE WHEN source.ActionID = 0 THEN target.CallBackTime ELSE source.CallBackTime END,
    CallBackEndTime    = CASE WHEN source.ActionID = 0 THEN target.CallBackEndTime ELSE source.CallBackEndTime END,
    Add_Date           = CASE WHEN source.ActionID = 0 THEN target.Add_Date ELSE source.Add_Date END,
    Deprecated_GUID    = CASE WHEN source.ActionID = 0 THEN target.Deprecated_GUID ELSE source.Deprecated_GUID END,
    Notes              = CASE WHEN source.ActionID = 0 THEN target.Notes ELSE source.Notes END,
    TimeZone           = CASE WHEN source.ActionID = 0 THEN target.TimeZone ELSE source.TimeZone END,
    CallBackType       = CASE WHEN source.ActionID = 0 THEN target.CallBackType ELSE source.CallBackType END
WHEN NOT MATCHED THEN INSERT (ActionID, CallBack_ID, Bus_No, Target_Type, Agent_No, Skill_No, Originating_Number, Number_To_Dial, First_Name, Last_Name, CallBackTime, CallBackEndTime, Add_Date, Deprecated_GUID, Notes, TimeZone, CallBackType) VALUES (source.ActionID, source.CallBack_ID, source.Bus_No, source.Target_Type, source.Agent_No, source.Skill_No, source.Originating_Number, source.Number_To_Dial, source.First_Name, source.Last_Name, source.CallBackTime, source.CallBackEndTime, source.Add_Date, source.Deprecated_GUID, source.Notes, source.TimeZone, source.CallBackType)</td>
        <td>83</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [Staging].[CallBacks]
 AS target
USING [ETL].[CallBacks] AS source ON (target.CallBack_ID = source.CallBack_ID)
WHEN MATCHED THEN UPDATE 
SET ActionID           = source.ActionID,
    Bus_No             = CASE WHEN source.ActionID = 0 THEN target.Bus_No ELSE source.Bus_No END,
    Target_Type        = CASE WHEN source.ActionID = 0 THEN target.Target_Type ELSE source.Target_Type END,
    Agent_No           = CASE WHEN source.ActionID = 0 THEN target.Agent_No ELSE source.Agent_No END,
    Skill_No           = CASE WHEN source.ActionID = 0 THEN target.Skill_No ELSE source.Skill_No END,
    Originating_Number = CASE WHEN source.ActionID = 0 THEN target.Originating_Number ELSE source.Originating_Number END,
    Number_To_Dial     = CASE WHEN source.ActionID = 0 THEN target.Number_To_Dial ELSE source.Number_To_Dial END,
    First_Name         = CASE WHEN source.ActionID = 0 THEN target.First_Name ELSE source.First_Name END,
    Last_Name          = CASE WHEN source.ActionID = 0 THEN target.Last_Name ELSE source.Last_Name END,
    CallBackTime       = CASE WHEN source.ActionID = 0 THEN target.CallBackTime ELSE source.CallBackTime END,
    CallBackEndTime    = CASE WHEN source.ActionID = 0 THEN target.CallBackEndTime ELSE source.CallBackEndTime END,
    Add_Date           = CASE WHEN source.ActionID = 0 THEN target.Add_Date ELSE source.Add_Date END,
    Deprecated_GUID    = CASE WHEN source.ActionID = 0 THEN target.Deprecated_GUID ELSE source.Deprecated_GUID END,
    Notes              = CASE WHEN source.ActionID = 0 THEN target.Notes ELSE source.Notes END,
    TimeZone           = CASE WHEN source.ActionID = 0 THEN target.TimeZone ELSE source.TimeZone END,
    CallBackType       = CASE WHEN source.ActionID = 0 THEN target.CallBackType ELSE source.CallBackType END
WHEN NOT MATCHED THEN INSERT (ActionID, CallBack_ID, Bus_No, Target_Type, Agent_No, Skill_No, Originating_Number, Number_To_Dial, First_Name, Last_Name, CallBackTime, CallBackEndTime, Add_Date, Deprecated_GUID, Notes, TimeZone, CallBackType) VALUES (source.ActionID, source.CallBack_ID, source.Bus_No, source.Target_Type, source.Agent_No, source.Skill_No, source.Originating_Number, source.Number_To_Dial, source.First_Name, source.Last_Name, source.CallBackTime, source.CallBackEndTime, source.Add_Date, source.Deprecated_GUID, source.Notes, source.TimeZone, source.CallBackType)</td>
        <td>83</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Bus_No ELSE source.Bus_No END</td>
        <td>95</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Target_Type ELSE source.Target_Type END</td>
        <td>96</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Agent_No ELSE source.Agent_No END</td>
        <td>97</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Skill_No ELSE source.Skill_No END</td>
        <td>98</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Originating_Number ELSE source.Originating_Number END</td>
        <td>99</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Number_To_Dial ELSE source.Number_To_Dial END</td>
        <td>100</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.First_Name ELSE source.First_Name END</td>
        <td>101</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Last_Name ELSE source.Last_Name END</td>
        <td>102</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.CallBackTime ELSE source.CallBackTime END</td>
        <td>103</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.CallBackEndTime ELSE source.CallBackEndTime END</td>
        <td>104</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Add_Date ELSE source.Add_Date END</td>
        <td>105</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Deprecated_GUID ELSE source.Deprecated_GUID END</td>
        <td>106</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Notes ELSE source.Notes END</td>
        <td>107</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.TimeZone ELSE source.TimeZone END</td>
        <td>108</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.CallBackType ELSE source.CallBackType END</td>
        <td>109</td>
      </tr>
    </table>
  </body>
</html>