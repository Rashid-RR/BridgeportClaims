<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[API_GetCallingListContacts]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[API_GetCallingListContacts]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:10 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>4</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT *
INTO   #ProspectiveContacts
FROM   (SELECT pc.ProspectiveContactId,
               ROW_NUMBER() OVER (ORDER BY pc.ProspectiveContactID) AS RowID
        FROM   [dbo].[ProspectiveContacts] AS pc
               LEFT OUTER JOIN
               dbo.[ProspectiveContactFinalizedStates] AS FS
               ON PC.ProspectiveContactId = FS.ProspectiveContactId
        WHERE  pc.Bus_No = @BusNo
               AND pc.ProspectiveContactSourceId = @prospectiveContactSourceID
               AND (FS.Overridden = 0
                    OR FS.Overridden IS NULL)) AS ProspectiveContactsTable
WHERE  ProspectiveContactsTable.RowID BETWEEN @recordStart AND (@recordStart + @BatchSize - 1)</td>
        <td>22</td>
      </tr>
      <tr valign="top">
        <td colspan="1">*</td>
        <td colspan="1">SELECT *
INTO   #ProspectiveContacts
FROM   (SELECT pc.ProspectiveContactId,
               ROW_NUMBER() OVER (ORDER BY pc.ProspectiveContactID) AS RowID
        FROM   [dbo].[ProspectiveContacts] AS pc
               LEFT OUTER JOIN
               dbo.[ProspectiveContactFinalizedStates] AS FS
               ON PC.ProspectiveContactId = FS.ProspectiveContactId
        WHERE  pc.Bus_No = @BusNo
               AND pc.ProspectiveContactSourceId = @prospectiveContactSourceID
               AND (FS.Overridden = 0
                    OR FS.Overridden IS NULL)) AS ProspectiveContactsTable
WHERE  ProspectiveContactsTable.RowID BETWEEN @recordStart AND (@recordStart + @BatchSize - 1)</td>
        <td>22</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">ROW_NUMBER</td>
        <td colspan="1">ROW_NUMBER() OVER (ORDER BY pc.ProspectiveContactID)</td>
        <td>26</td>
      </tr>
      <tr valign="top">
        <td colspan="1">OVER</td>
        <td colspan="1">OVER (ORDER BY pc.ProspectiveContactID)</td>
        <td>26</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN pcs.SourceRemovalScheduledDateTime IS NULL THEN 0 ELSE 1 END</td>
        <td>46</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.Finalized = 0 THEN 'Active' WHEN s.ContactDisposedFinal = 1 THEN 'ContactDisposedFinal' WHEN s.ContactDNC = 1
                                                                                                         AND s.CheckedIn = 0 THEN 'ContactDNC' WHEN s.ContactDNC = 1
                                                                                                                                                    AND s.CheckedIn = 1 THEN 'ContactDNCCheckedIn' WHEN s.ContactExhausted = 1 THEN 'ContactExhausted' WHEN s.ContactExpired = 1 THEN 'ContactExpired' WHEN s.Removed = 1
                                                                                                                                                                                                                                                                                                            AND s.CheckedIn = 0 THEN 'Remove' WHEN s.Removed = 1
                                                                                                                                                                                                                                                                                                                                                   AND s.CheckedIn = 1 THEN 'Removed' WHEN s.SourceRemoved = 1
                                                                                                                                                                                                                                                                                                                                                                                           AND s.CheckedIn = 0 THEN 'SourceRemoved' WHEN s.SourceRemoved = 1
                                                                                                                                                                                                                                                                                                                                                                                                                                         AND s.CheckedIn = 1 THEN 'SourceRemovedCheckedIn' END</td>
        <td>61</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN odr.Canceled = 1
          OR odr.Completed = 1 THEN NULL ELSE COALESCE (odr.RescheduledDateTimeGMT, odr.CallbackDateTimeGMT) END</td>
        <td>77</td>
      </tr>
      <tr valign="top">
        <td colspan="1">COALESCE</td>
        <td colspan="1">COALESCE (odr.RescheduledDateTimeGMT, odr.CallbackDateTimeGMT)</td>
        <td>79</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">#ProspectiveContacts AS tr</td>
        <td>86</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ProspectiveContactDestinations AS dest</td>
        <td>115</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#ProspectiveContacts AS t</td>
        <td>116</td>
      </tr>
    </table>
  </body>
</html>