<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[ExtRep_EA_Daily_Call_Summary]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[ExtRep_EA_Daily_Call_Summary]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:10 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">BEGIN TRANSACTION</td>
        <td colspan="1">BEGIN TRANSACTION</td>
        <td>4</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT s.skill_no AS SkillNo,
       s.skill_name AS SkillName,
       c.campaign_no AS CampaignNo,
       c.campaign_name AS CampaignName,
       b.business_unit_name AS BusName
INTO   #MySkills
FROM   dbo.Skills AS s
       INNER JOIN
       dbo.Campaign AS c
       ON s.campaign_no = c.campaign_no
       INNER JOIN
       dbo.business_unit AS b
       ON c.bus_no = b.bus_no
WHERE  b.bus_no = @Bus_No
       AND s.status = 'Curr'
       AND c.status = 'Curr'
       AND (@campaign LIKE '%,' + CONVERT (NVARCHAR, c.campaign_no) + ',%'
            OR @campaign IS NULL)
       AND (@skill LIKE '%,' + CONVERT (NVARCHAR, s.skill_no) + ',%'
            OR @skill IS NULL)
       AND (@InboundOutbound &gt;= 2
            OR s.Outbound_skill = @InboundOutbound)
OPTION (MAXDOP 2)</td>
        <td>35</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT p.[contact_code],
       p.[contact_name],
       p.[status],
       p.[bus_no],
       p.[contact_type]
INTO   [#dw_POC2]
FROM   (SELECT c.contact_code,
               IsNull(c.contact_name, 'CallBack') AS contact_name,
               c.status,
               a.bus_no,
               c.contact_type
        FROM   dbo.pointofcontact AS c
               INNER JOIN
               dbo.skills AS s
               ON c.default_skill_no = s.skill_no
               INNER JOIN
               dbo.campaign AS a
               ON s.campaign_no = a.campaign_no
        WHERE  c.contact_type = 1
               AND a.bus_no = @bus_no
        UNION
        SELECT c.contact_code,
               s.description,
               c.status,
               @bus_no,
               c.contact_type
        FROM   dbo.pointofcontact AS c
               INNER JOIN
               dbo.contact_types AS s
               ON c.contact_type = s.contact_type
        WHERE  default_skill_no IS NULL) AS p
OPTION (MAXDOP 2)</td>
        <td>59</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">LIKE</td>
        <td colspan="1">@campaign LIKE '%,' + CONVERT (NVARCHAR, c.campaign_no) + ',%'</td>
        <td>47</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@skill LIKE '%,' + CONVERT (NVARCHAR, s.skill_no) + ',%'</td>
        <td>50</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@campaign LIKE '%,' + CONVERT (NVARCHAR, f.campaign_no) + ',%'</td>
        <td>187</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@skill LIKE '%,' + CONVERT (NVARCHAR, f.skill_no) + ',%'</td>
        <td>190</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@team LIKE '%,' + CONVERT (NVARCHAR, f.[team_no]) + ',%'</td>
        <td>196</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@agent LIKE '%,' + CONVERT (NVARCHAR, f.[agent_no]) + ',%'</td>
        <td>199</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">MAXDOP</td>
        <td colspan="1">MAXDOP 2</td>
        <td>56</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">MAXDOP 2</td>
        <td>82</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MAXDOP 2</td>
        <td>212</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">MAXDOP 2</td>
        <td>256</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">#MyContactStats</td>
        <td>118</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#Myskills AS ms</td>
        <td>248</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#MyContactStats AS mc</td>
        <td>250</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">[#dw_POC2] AS ci</td>
        <td>251</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN s.InQueue_Time &gt; 0 THEN 1 ELSE 0 END</td>
        <td>149</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.Agent_Time &gt; 0 THEN 1 ELSE 0 END</td>
        <td>150</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.Abandon_Time &gt; 0 THEN 1 ELSE 0 END</td>
        <td>151</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.Abandon_Time &lt;= 0 THEN s.InQueue_Seconds ELSE 0 END</td>
        <td>158</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.Abandon_Time &lt;= 0 THEN s.inqueue_Seconds ELSE 0 END</td>
        <td>159</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.[sla] &gt;= 0
          AND s.Abandon_Time &lt;= 0 THEN 1 ELSE 0 END</td>
        <td>164</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.[sla] &lt; 0
          AND s.Abandon_Time &lt;= 0 THEN 1 ELSE 0 END</td>
        <td>165</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.Abandon_Time &lt;= 0 THEN s.inqueue_Seconds ELSE 0 END</td>
        <td>167</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN sk.Outbound_Skill = 1 THEN 1 ELSE 0 END</td>
        <td>172</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN sk.Outbound_Skill = 1 THEN s.Agent_Seconds ELSE 0 END</td>
        <td>173</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">COMMIT TRANSACTION</td>
        <td colspan="1">COMMIT TRANSACTION</td>
        <td>259</td>
      </tr>
    </table>
  </body>
</html>