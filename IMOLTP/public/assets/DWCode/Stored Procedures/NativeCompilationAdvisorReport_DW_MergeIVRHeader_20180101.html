<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeIVRHeader]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeIVRHeader]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:11 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO [dbo].[IVR_Header]
 AS target
USING [ETL].[IVR_Header] AS source ON (target.master_id = source.master_id)
WHEN MATCHED AND source.ActionID = 0 THEN DELETE
WHEN MATCHED AND source.ActionID IN (1, 2, 3) THEN UPDATE 
SET Bus_No          = source.Bus_No,
    Media_Type      = source.Media_Type,
    script_name     = source.script_name,
    script_path     = source.script_path,
    status          = source.status,
    create_date     = source.create_date,
    create_time     = source.create_time,
    modify_date     = source.modify_date,
    modify_time     = source.modify_time,
    script_type     = source.script_type,
    SUser           = source.SUser,
    MUser           = source.MUser,
    old_master_id   = source.old_master_id,
    Notes           = source.Notes,
    Hidden          = source.Hidden,
    ReadOnly        = source.ReadOnly,
    ScriptDirectory = source.ScriptDirectory
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (master_id, Bus_No, Media_Type, script_name, script_path, status, create_date, create_time, modify_date, modify_time, script_type, SUser, MUser, old_master_id, Notes, Hidden, ReadOnly, ScriptDirectory) VALUES (source.master_id, source.Bus_No, source.Media_Type, source.script_name, source.script_path, source.status, source.create_date, source.create_time, source.modify_date, source.modify_time, source.script_type, source.SUser, source.MUser, source.old_master_id, source.Notes, source.Hidden, source.ReadOnly, source.ScriptDirectory)</td>
        <td>5</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [dbo].[IVR_Header]
 AS target
USING [ETL].[IVR_Header] AS source ON (target.master_id = source.master_id)
WHEN MATCHED AND source.ActionID = 0 THEN DELETE
WHEN MATCHED AND source.ActionID IN (1, 2, 3) THEN UPDATE 
SET Bus_No          = source.Bus_No,
    Media_Type      = source.Media_Type,
    script_name     = source.script_name,
    script_path     = source.script_path,
    status          = source.status,
    create_date     = source.create_date,
    create_time     = source.create_time,
    modify_date     = source.modify_date,
    modify_time     = source.modify_time,
    script_type     = source.script_type,
    SUser           = source.SUser,
    MUser           = source.MUser,
    old_master_id   = source.old_master_id,
    Notes           = source.Notes,
    Hidden          = source.Hidden,
    ReadOnly        = source.ReadOnly,
    ScriptDirectory = source.ScriptDirectory
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (master_id, Bus_No, Media_Type, script_name, script_path, status, create_date, create_time, modify_date, modify_time, script_type, SUser, MUser, old_master_id, Notes, Hidden, ReadOnly, ScriptDirectory) VALUES (source.master_id, source.Bus_No, source.Media_Type, source.script_name, source.script_path, source.status, source.create_date, source.create_time, source.modify_date, source.modify_time, source.script_type, source.SUser, source.MUser, source.old_master_id, source.Notes, source.Hidden, source.ReadOnly, source.ScriptDirectory)</td>
        <td>5</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [Staging].[IVR_Header]
 AS target
USING [ETL].[IVR_Header] AS source ON (target.master_id = source.master_id)
WHEN MATCHED THEN UPDATE 
SET ActionID        = source.ActionID,
    Bus_No          = CASE WHEN source.ActionID = 0 THEN target.Bus_No ELSE source.Bus_No END,
    Media_Type      = CASE WHEN source.ActionID = 0 THEN target.Media_Type ELSE source.Media_Type END,
    script_name     = CASE WHEN source.ActionID = 0 THEN target.script_name ELSE source.script_name END,
    script_path     = CASE WHEN source.ActionID = 0 THEN target.script_path ELSE source.script_path END,
    status          = CASE WHEN source.ActionID = 0 THEN target.status ELSE source.status END,
    create_date     = CASE WHEN source.ActionID = 0 THEN target.create_date ELSE source.create_date END,
    create_time     = CASE WHEN source.ActionID = 0 THEN target.create_time ELSE source.create_time END,
    modify_date     = CASE WHEN source.ActionID = 0 THEN target.modify_date ELSE source.modify_date END,
    modify_time     = CASE WHEN source.ActionID = 0 THEN target.modify_time ELSE source.modify_time END,
    script_type     = CASE WHEN source.ActionID = 0 THEN target.script_type ELSE source.script_type END,
    SUser           = CASE WHEN source.ActionID = 0 THEN target.SUser ELSE source.SUser END,
    MUser           = CASE WHEN source.ActionID = 0 THEN target.MUser ELSE source.MUser END,
    old_master_id   = CASE WHEN source.ActionID = 0 THEN target.old_master_id ELSE source.old_master_id END,
    Notes           = CASE WHEN source.ActionID = 0 THEN target.Notes ELSE source.Notes END,
    Hidden          = CASE WHEN source.ActionID = 0 THEN target.Hidden ELSE source.Hidden END,
    ReadOnly        = CASE WHEN source.ActionID = 0 THEN target.ReadOnly ELSE source.ReadOnly END,
    ScriptDirectory = CASE WHEN source.ActionID = 0 THEN target.ScriptDirectory ELSE source.ScriptDirectory END
WHEN NOT MATCHED THEN INSERT (ActionID, master_id, Bus_No, Media_Type, script_name, script_path, status, create_date, create_time, modify_date, modify_time, script_type, SUser, MUser, old_master_id, Notes, Hidden, ReadOnly, ScriptDirectory) VALUES (source.ActionID, source.master_id, source.Bus_No, source.Media_Type, source.script_name, source.script_path, source.status, source.create_date, source.create_time, source.modify_date, source.modify_time, source.script_type, source.SUser, source.MUser, source.old_master_id, source.Notes, source.Hidden, source.ReadOnly, source.ScriptDirectory)</td>
        <td>89</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [Staging].[IVR_Header]
 AS target
USING [ETL].[IVR_Header] AS source ON (target.master_id = source.master_id)
WHEN MATCHED THEN UPDATE 
SET ActionID        = source.ActionID,
    Bus_No          = CASE WHEN source.ActionID = 0 THEN target.Bus_No ELSE source.Bus_No END,
    Media_Type      = CASE WHEN source.ActionID = 0 THEN target.Media_Type ELSE source.Media_Type END,
    script_name     = CASE WHEN source.ActionID = 0 THEN target.script_name ELSE source.script_name END,
    script_path     = CASE WHEN source.ActionID = 0 THEN target.script_path ELSE source.script_path END,
    status          = CASE WHEN source.ActionID = 0 THEN target.status ELSE source.status END,
    create_date     = CASE WHEN source.ActionID = 0 THEN target.create_date ELSE source.create_date END,
    create_time     = CASE WHEN source.ActionID = 0 THEN target.create_time ELSE source.create_time END,
    modify_date     = CASE WHEN source.ActionID = 0 THEN target.modify_date ELSE source.modify_date END,
    modify_time     = CASE WHEN source.ActionID = 0 THEN target.modify_time ELSE source.modify_time END,
    script_type     = CASE WHEN source.ActionID = 0 THEN target.script_type ELSE source.script_type END,
    SUser           = CASE WHEN source.ActionID = 0 THEN target.SUser ELSE source.SUser END,
    MUser           = CASE WHEN source.ActionID = 0 THEN target.MUser ELSE source.MUser END,
    old_master_id   = CASE WHEN source.ActionID = 0 THEN target.old_master_id ELSE source.old_master_id END,
    Notes           = CASE WHEN source.ActionID = 0 THEN target.Notes ELSE source.Notes END,
    Hidden          = CASE WHEN source.ActionID = 0 THEN target.Hidden ELSE source.Hidden END,
    ReadOnly        = CASE WHEN source.ActionID = 0 THEN target.ReadOnly ELSE source.ReadOnly END,
    ScriptDirectory = CASE WHEN source.ActionID = 0 THEN target.ScriptDirectory ELSE source.ScriptDirectory END
WHEN NOT MATCHED THEN INSERT (ActionID, master_id, Bus_No, Media_Type, script_name, script_path, status, create_date, create_time, modify_date, modify_time, script_type, SUser, MUser, old_master_id, Notes, Hidden, ReadOnly, ScriptDirectory) VALUES (source.ActionID, source.master_id, source.Bus_No, source.Media_Type, source.script_name, source.script_path, source.status, source.create_date, source.create_time, source.modify_date, source.modify_time, source.script_type, source.SUser, source.MUser, source.old_master_id, source.Notes, source.Hidden, source.ReadOnly, source.ScriptDirectory)</td>
        <td>89</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Bus_No ELSE source.Bus_No END</td>
        <td>101</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Media_Type ELSE source.Media_Type END</td>
        <td>102</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.script_name ELSE source.script_name END</td>
        <td>103</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.script_path ELSE source.script_path END</td>
        <td>104</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.status ELSE source.status END</td>
        <td>105</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.create_date ELSE source.create_date END</td>
        <td>106</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.create_time ELSE source.create_time END</td>
        <td>107</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.modify_date ELSE source.modify_date END</td>
        <td>108</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.modify_time ELSE source.modify_time END</td>
        <td>109</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.script_type ELSE source.script_type END</td>
        <td>110</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.SUser ELSE source.SUser END</td>
        <td>111</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.MUser ELSE source.MUser END</td>
        <td>112</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.old_master_id ELSE source.old_master_id END</td>
        <td>113</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Notes ELSE source.Notes END</td>
        <td>114</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Hidden ELSE source.Hidden END</td>
        <td>115</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.ReadOnly ELSE source.ReadOnly END</td>
        <td>116</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.ScriptDirectory ELSE source.ScriptDirectory END</td>
        <td>117</td>
      </tr>
    </table>
  </body>
</html>