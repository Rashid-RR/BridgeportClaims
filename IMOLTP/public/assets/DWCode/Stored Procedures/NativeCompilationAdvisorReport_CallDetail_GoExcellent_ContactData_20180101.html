<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_GoExcellent_ContactData]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_GoExcellent_ContactData]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:09 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">BEGIN TRANSACTION</td>
        <td colspan="1">BEGIN TRANSACTION</td>
        <td>4</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">EXECUTE LockCriticalSection 'CallDetail_GoExcellent_ContactData'</td>
        <td>13</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#Transfers AS T</td>
        <td>151</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#Spawned AS SP</td>
        <td>152</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#CallBack AS CB</td>
        <td>153</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#Routing AS R</td>
        <td>154</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#HPA AS HP</td>
        <td>155</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#RoutingDatetime AS RDT</td>
        <td>156</td>
      </tr>
      <tr valign="top">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT DISTINCT H.Contact_ID
INTO   #Transfers
FROM   dbo.Contact_Log_Header AS H
       INNER JOIN
       dbo.Contact_Log_Detail AS D
       ON H.Contact_ID = D.Contact_ID
       INNER JOIN
       dbo.Contact_Log_Detail_Summary AS DS
       ON H.Contact_ID = DS.Contact_ID
          AND D.StateIndex = DS.StateIndex
WHERE  H.Bus_no = @p_Bus_No
       AND H.Start_Date BETWEEN @P_UTCStart_Date AND @P_UTCEnd_Date
       AND (D.Contact_State = 5
            OR D.Contact_State = 22)</td>
        <td>22</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT DISTINCT H.Contact_ID
INTO   #Spawned
FROM   dbo.Contact_Log_Header AS H
       INNER JOIN
       dbo.Contact_Log_Detail AS D
       ON H.Contact_ID = D.Contact_ID
       INNER JOIN
       dbo.Contact_Log_Detail_Summary AS DS
       ON H.Contact_ID = DS.Contact_ID
          AND D.StateIndex = DS.StateIndex
WHERE  H.Bus_no = @p_Bus_No
       AND H.Start_Date BETWEEN @P_UTCStart_Date AND @P_UTCEnd_Date
       AND D.Contact_State = 16</td>
        <td>32</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT   DISTINCT H.Contact_ID,
                  SUM(DS.Duration_Seconds) AS Duration
INTO     #CallBack
FROM     dbo.Contact_Log_Header AS H
         INNER JOIN
         dbo.Contact_Log_Detail AS D
         ON H.Contact_ID = D.Contact_ID
         INNER JOIN
         dbo.Contact_Log_Detail_Summary AS DS
         ON H.Contact_ID = DS.Contact_ID
            AND D.StateIndex = DS.StateIndex
WHERE    H.Bus_no = @p_Bus_No
         AND H.Start_Date BETWEEN @P_UTCStart_Date AND @P_UTCEnd_Date
         AND D.Contact_State = 15
GROUP BY H.Contact_ID</td>
        <td>42</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT DISTINCT H.Contact_ID
INTO   #Routing
FROM   dbo.Contact_Log_Header AS H
       INNER JOIN
       dbo.Contact_Log_Detail AS D
       ON H.Contact_ID = D.Contact_ID
       INNER JOIN
       dbo.Contact_Log_Detail_Summary AS DS
       ON H.Contact_ID = DS.Contact_ID
          AND D.StateIndex = DS.StateIndex
WHERE  H.Bus_no = @p_Bus_No
       AND H.Start_Date BETWEEN @P_UTCStart_Date AND @P_UTCEnd_Date
       AND D.Contact_State = 2</td>
        <td>54</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT DISTINCT H.Contact_ID,
                D.Start_Date
INTO   #RoutingDatetime
FROM   dbo.Contact_Log_Header AS H
       INNER JOIN
       dbo.Contact_Log_Detail AS D
       ON H.Contact_ID = D.Contact_ID
       INNER JOIN
       dbo.Contact_Log_Detail_Summary AS DS
       ON H.Contact_ID = DS.Contact_ID
          AND D.StateIndex = DS.StateIndex
WHERE  H.Bus_no = @p_Bus_No
       AND H.Start_Date BETWEEN @P_UTCStart_Date AND @P_UTCEnd_Date
       AND D.Contact_State = 2</td>
        <td>64</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT DISTINCT D.Contact_ID
INTO   #HPA
FROM   dbo.Agent_Log_Header AS H
       INNER JOIN
       dbo.AGent_Log_Detail AS D
       ON H.Agent_Session_ID = D.Agent_Session_ID
WHERE  H.Bus_no = @p_Bus_No
       AND H.Start_Date BETWEEN @P_UTCStart_Date AND @P_UTCEnd_Date
       AND D.Outstate_Code = -2</td>
        <td>74</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT DISTINCT H.Contact_ID
INTO   #Refused
FROM   dbo.Contact_Log_Header AS H
       INNER JOIN
       dbo.Contact_Log_Detail AS D
       ON H.Contact_ID = D.Contact_ID
       INNER JOIN
       dbo.Contact_Log_Detail_Summary AS DS
       ON H.Contact_ID = DS.Contact_ID
          AND D.StateIndex = DS.StateIndex
WHERE  H.Bus_no = @p_Bus_No
       AND H.Start_Date BETWEEN @P_UTCStart_Date AND @P_UTCEnd_Date
       AND D.Contact_State = 24</td>
        <td>83</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN S.Sla = 0 THEN 1 ELSE 0 END</td>
        <td>106</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN S.Sla = 1 THEN 1 ELSE 0 END</td>
        <td>107</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN F.INbound = 'T' THEN 1 ELSE 0 END</td>
        <td>108</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN F.INbound = 'F' THEN 1 ELSE 0 END</td>
        <td>109</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN F.INbound = 'T'
          AND S.Total_Seconds &gt; 2 THEN 1 ELSE 0 END</td>
        <td>110</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN F.INbound = 'T' THEN 1 ELSE 0 END</td>
        <td>111</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN S.inQueue_time &gt; 0 THEN 1 ELSE 0 END</td>
        <td>112</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN S.agent_Seconds &gt; 0 THEN 1 ELSE 0 END</td>
        <td>113</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN S.Abandon_SEconds &gt; 0 THEN 1 ELSE 0 END</td>
        <td>114</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN HP.Contact_ID &gt; 0 THEN 1 ELSE 0 END</td>
        <td>115</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN S.inQueue_Time &gt; 999 THEN S.inQueue_Seconds WHEN S.inQueue_Time &gt; 0 THEN 1 ELSE 0 END</td>
        <td>118</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN prequeue_Seconds &gt; 0
          AND inqueue_Seconds = 0
          AND agent_seconds = 0 THEN 1 ELSE 0 END</td>
        <td>122</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN S.Abandon_Seconds &gt; 0 THEN 1 ELSE 0 END</td>
        <td>123</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN S.isShortAbandon = 1 THEN 1 ELSE 0 END</td>
        <td>124</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN S.Abandon_Seconds &gt; 0 THEN 1 ELSE 0 END</td>
        <td>125</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN RCL.Contact_ID IS NOT NULL THEN 1 ELSE 0 END</td>
        <td>126</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN S.Agent_Seconds &gt; 0 THEN S.inQueue_Seconds ELSE 0 END</td>
        <td>127</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN S.Conf_Seconds &gt; 0 THEN 1 ELSE 0 END</td>
        <td>136</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN CB.Contact_ID &gt; 0 THEN 1 ELSE 0 END</td>
        <td>137</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN R.Contact_ID &gt; 0 THEN 1 ELSE 0 END</td>
        <td>139</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN CB.Duration &gt; 0 THEN CB.DUration ELSE 0 END</td>
        <td>140</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SP.Contact_ID &gt; 0 THEN 1 ELSE 0 END</td>
        <td>141</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN F.Inbound = 'T'
          AND S.Agent_Time &gt; 0 THEN 1 ELSE 0 END</td>
        <td>142</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN T.Contact_ID &gt; 0 THEN 1 ELSE 0 END</td>
        <td>143</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">COMMIT TRANSACTION</td>
        <td colspan="1">COMMIT TRANSACTION</td>
        <td>170</td>
      </tr>
    </table>
  </body>
</html>