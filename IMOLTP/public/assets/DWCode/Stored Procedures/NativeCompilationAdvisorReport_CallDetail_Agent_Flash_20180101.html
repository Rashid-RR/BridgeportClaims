<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_Agent_Flash]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_Agent_Flash]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:11 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT l.contact_id,
       l.master_contact_id,
       l.bus_no,
       l.contact_code,
       r.skill_no,
       r.campaign_no,
       IsNull(r.agent_no, 0) AS agent_no,
       IsNull(r.team_no, 0) AS team_no,
       NULL AS archived,
       IsNull(s.sla, 0) AS sla,
       l.Start_Date,
       s.prequeue_time,
       s.inqueue_time,
       s.agent_time,
       s.postqueue_time,
       s.abandon_time,
       r.abandon,
       r.from_addr,
       r.to_addr,
       s.Hold_time,
       s.Release_time
INTO   #Contact_Log
FROM   dbo.Contact_Log_Header AS l
       LEFT OUTER JOIN
       dbo.Contact_Log_Footer AS r
       ON r.Contact_ID = l.Contact_ID
       LEFT OUTER JOIN
       dbo.Contact_Log_Summary AS s
       ON s.Contact_ID = l.Contact_ID
WHERE  l.bus_no = @p_Bus_no
       AND r.bus_no = @p_Bus_no
       AND l.start_date BETWEEN @p_UTCStart_Date AND @p_UTCEnd_Date</td>
        <td>5</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT h.Agent_Session_ID,
       d.StateIndex,
       h.agent_no,
       h.team_no,
       h.bus_no,
       d.start_date,
       d.working,
       d.available,
       d.outstate_code,
       s.duration,
       d.log_state,
       d.skill_no,
       (CASE WHEN d.working IN (1, 2, 3, 4) THEN d.working WHEN d.working = 0 THEN (CASE WHEN d.available = 1 THEN d.working WHEN (d.outstate_code &gt; -1)
                                                                                                                                  AND (d.outstate_code &lt; 10) THEN 3 ELSE d.outstate_code END) END) AS State_Code
INTO   #Agent_Log
FROM   dbo.Agent_Log_Header AS h
       LEFT OUTER JOIN
       dbo.Agent_Log_Detail AS d
       ON d.Agent_Session_ID = h.Agent_Session_ID
       LEFT OUTER JOIN
       dbo.Agent_Log_Detail_Summary AS s
       ON s.Agent_Session_ID = d.Agent_Session_ID
          AND s.StateIndex = d.StateIndex
WHERE  h.bus_no = @p_Bus_no
       AND h.start_date BETWEEN @p_UTCStart_Date AND @p_UTCEnd_Date</td>
        <td>34</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN d.working IN (1, 2, 3, 4) THEN d.working WHEN d.working = 0 THEN (CASE WHEN d.available = 1 THEN d.working WHEN (d.outstate_code &gt; -1)
                                                                                                                          AND (d.outstate_code &lt; 10) THEN 3 ELSE d.outstate_code END) END</td>
        <td>46</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.available = 1 THEN d.working WHEN (d.outstate_code &gt; -1)
                                              AND (d.outstate_code &lt; 10) THEN 3 ELSE d.outstate_code END</td>
        <td>47</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.Outbound_skill = 0 THEN 1 ELSE 0 END</td>
        <td>62</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.Outbound_skill = 1 THEN 1 ELSE 0 END</td>
        <td>65</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SUM(CASE WHEN s.Outbound_skill = 0 THEN 1 ELSE 0 END) = 0 THEN 0 ELSE (ISNULL(al.ACD_t, 0) / SUM(CASE WHEN s.Outbound_skill = 0 THEN 1 ELSE 0 END)) END</td>
        <td>69</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.Outbound_skill = 0 THEN 1 ELSE 0 END</td>
        <td>69</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.Outbound_skill = 0 THEN 1 ELSE 0 END</td>
        <td>72</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ISNULL(al.Total_t, 0.0) = 0 THEN 0.0 ELSE CONVERT (FLOAT, ISNULL(al.Wrap_t, 0)) / ISNULL(al.Total_t, 0) END</td>
        <td>77</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ISNULL(al.Total_t, 0.0) = 0 THEN 0.0 ELSE CONVERT (FLOAT, ISNULL(al.Unav_t, 0)) / ISNULL(al.Total_t, 0) END</td>
        <td>81</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN a.available = 1
          AND Working = 0 THEN (a.duration / 1000) ELSE 0 END</td>
        <td>89</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN a.available = 0
          AND Working = 0 THEN (a.duration / 1000) ELSE 0 END</td>
        <td>93</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE s.Outbound_Skill WHEN 0 THEN (a.duration / 1000) ELSE 0 END</td>
        <td>97</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN a.available = 0
          AND Working = 0
          AND o.description LIKE '%wrap%' THEN (a.duration / 1000) ELSE 0 END</td>
        <td>100</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">#Contact_Log AS Cl</td>
        <td>86</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#agent_log AS a</td>
        <td>106</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">LIKE</td>
        <td colspan="1">o.description LIKE '%wrap%'</td>
        <td>102</td>
      </tr>
    </table>
  </body>
</html>