<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeProspectiveContactDestinations]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeProspectiveContactDestinations]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:12 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO [dbo].[ProspectiveContactDestinations]
 AS target
USING [ETL].[ProspectiveContactDestinations] AS source ON (target.ProspectiveContactDestinationId = source.ProspectiveContactDestinationId)
WHEN MATCHED AND source.ActionID = 0 THEN DELETE
WHEN MATCHED AND source.ActionID IN (1, 2, 3) THEN UPDATE 
SET Bus_No                              = source.Bus_No,
    ProspectiveContactId                = source.ProspectiveContactId,
    ProspectiveContactDestinationTypeId = source.ProspectiveContactDestinationTypeId,
    TimeZoneNames                       = source.TimeZoneNames,
    ProspectiveContactDestinationValue  = source.ProspectiveContactDestinationValue,
    FieldId                             = source.FieldId,
    Active                              = source.Active,
    DNC                                 = source.DNC,
    CreatedDate                         = source.CreatedDate,
    CreatedBy                           = source.CreatedBy,
    ModifiedBy                          = source.ModifiedBy,
    ModifiedDate                        = source.ModifiedDate,
    CallerId                            = source.CallerId,
    Description                         = source.Description,
    Compliance                          = source.Compliance,
    Attempts                            = source.Attempts,
    StartTimeMinutes                    = source.StartTimeMinutes,
    EndTimeMinutes                      = source.EndTimeMinutes
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (ProspectiveContactDestinationId, Bus_No, ProspectiveContactId, ProspectiveContactDestinationTypeId, TimeZoneNames, ProspectiveContactDestinationValue, FieldId, Active, DNC, CreatedDate, CreatedBy, ModifiedBy, ModifiedDate, CallerId, Description, Compliance, Attempts, StartTimeMinutes, EndTimeMinutes) VALUES (source.ProspectiveContactDestinationId, source.Bus_No, source.ProspectiveContactId, source.ProspectiveContactDestinationTypeId, source.TimeZoneNames, source.ProspectiveContactDestinationValue, source.FieldId, source.Active, source.DNC, source.CreatedDate, source.CreatedBy, source.ModifiedBy, source.ModifiedDate, source.CallerId, source.Description, source.Compliance, source.Attempts, source.StartTimeMinutes, source.EndTimeMinutes)</td>
        <td>5</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [dbo].[ProspectiveContactDestinations]
 AS target
USING [ETL].[ProspectiveContactDestinations] AS source ON (target.ProspectiveContactDestinationId = source.ProspectiveContactDestinationId)
WHEN MATCHED AND source.ActionID = 0 THEN DELETE
WHEN MATCHED AND source.ActionID IN (1, 2, 3) THEN UPDATE 
SET Bus_No                              = source.Bus_No,
    ProspectiveContactId                = source.ProspectiveContactId,
    ProspectiveContactDestinationTypeId = source.ProspectiveContactDestinationTypeId,
    TimeZoneNames                       = source.TimeZoneNames,
    ProspectiveContactDestinationValue  = source.ProspectiveContactDestinationValue,
    FieldId                             = source.FieldId,
    Active                              = source.Active,
    DNC                                 = source.DNC,
    CreatedDate                         = source.CreatedDate,
    CreatedBy                           = source.CreatedBy,
    ModifiedBy                          = source.ModifiedBy,
    ModifiedDate                        = source.ModifiedDate,
    CallerId                            = source.CallerId,
    Description                         = source.Description,
    Compliance                          = source.Compliance,
    Attempts                            = source.Attempts,
    StartTimeMinutes                    = source.StartTimeMinutes,
    EndTimeMinutes                      = source.EndTimeMinutes
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (ProspectiveContactDestinationId, Bus_No, ProspectiveContactId, ProspectiveContactDestinationTypeId, TimeZoneNames, ProspectiveContactDestinationValue, FieldId, Active, DNC, CreatedDate, CreatedBy, ModifiedBy, ModifiedDate, CallerId, Description, Compliance, Attempts, StartTimeMinutes, EndTimeMinutes) VALUES (source.ProspectiveContactDestinationId, source.Bus_No, source.ProspectiveContactId, source.ProspectiveContactDestinationTypeId, source.TimeZoneNames, source.ProspectiveContactDestinationValue, source.FieldId, source.Active, source.DNC, source.CreatedDate, source.CreatedBy, source.ModifiedBy, source.ModifiedDate, source.CallerId, source.Description, source.Compliance, source.Attempts, source.StartTimeMinutes, source.EndTimeMinutes)</td>
        <td>5</td>
      </tr>
    </table>
  </body>
</html>