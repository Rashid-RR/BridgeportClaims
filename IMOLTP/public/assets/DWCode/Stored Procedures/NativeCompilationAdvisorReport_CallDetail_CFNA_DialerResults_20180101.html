<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_CFNA_DialerResults]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_CFNA_DialerResults]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:12 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">BEGIN TRANSACTION</td>
        <td colspan="1">BEGIN TRANSACTION</td>
        <td>1</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">EXECUTE LockCriticalSection 'CallDetail_CFNA_DialerResults'</td>
        <td>4</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#PC AS PC</td>
        <td>37</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#FinalizationStatus AS FS</td>
        <td>96</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#GXHld_Values AS HV</td>
        <td>104</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT contact_id,
       busphone,
       timezone,
       payhistory,
       pastdue,
       paymentamount,
       cyclenumber,
       resphone,
       delinquentperiod,
       balance,
       totaldue,
       zip,
       creationdate,
       externalid,
       [state],
       [init],
       accounttype,
       cassstatuscode
INTO   #GXHld_Values
FROM   (SELECT contact_ID,
               data_name,
               data_value
        FROM   dbo.custom_contact_log
        WHERE  bus_no = @Bus_no
               AND lastTouched BETWEEN @UTCStart_Date AND @UTCEnd_Date) AS SourceTable PIVOT (MAX (data_value) FOR data_name IN (busphone, timezone, payhistory, pastdue, paymentamount, cyclenumber, resphone, delinquentperiod, balance, totaldue, zip, creationdate, externalid, [state], [init], accounttype, cassstatuscode)) AS GtxPivotTable
WHERE  externalid IS NOT NULL</td>
        <td>8</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT ProspectiveContactID,
       customerleadexternaluniqueid,
       ProspectiveContactSourceID
INTO   #PC
FROM   [dbo].[ProspectiveContacts]
WHERE  bus_no = @Bus_no
       AND createddate &gt; @UTCStart_Date</td>
        <td>29</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT   PC.ProspectiveContactID,
         PC.customerleadexternaluniqueid,
         MAX(FS.ProspectiveContactPotentialStateId) AS FinalizationState
INTO     #FinalizationStatus
FROM     #PC AS PC
         INNER JOIN
         dbo.ProspectiveContactSources AS pcs
         ON pcs.ProspectiveContactSourceID = pc.ProspectiveContactSourceID
         LEFT OUTER JOIN
         dbo.[ProspectiveContactFinalizedStates] AS FS
         ON PC.ProspectiveContactId = FS.ProspectiveContactId
WHERE    pcs.Bus_No = @Bus_No
         AND (FS.Overridden = 0
              OR FS.Overridden IS NULL)
GROUP BY PC.ProspectiveContactID, PC.CustomerLeadExternalUniqueId</td>
        <td>35</td>
      </tr>
      <tr valign="top">
        <td colspan="1">PIVOT</td>
        <td colspan="1">(SELECT contact_ID,
        data_name,
        data_value
 FROM   dbo.custom_contact_log
 WHERE  bus_no = @Bus_no
        AND lastTouched BETWEEN @UTCStart_Date AND @UTCEnd_Date) AS SourceTable PIVOT (MAX (data_value) FOR data_name IN (busphone, timezone, payhistory, pastdue, paymentamount, cyclenumber, resphone, delinquentperiod, balance, totaldue, zip, creationdate, externalid, [state], [init], accounttype, cassstatuscode)) AS GtxPivotTable</td>
        <td>13</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN pcs.SourceRemovalScheduledDateTime IS NULL THEN 0 ELSE 1 END</td>
        <td>71</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (odr.Canceled = 1
           OR odr.Completed = 1) THEN NULL ELSE ISNULL(COALESCE (odr.RescheduledDateTimeGMT, odr.CallbackDateTimeGMT), '1/1/1960') END</td>
        <td>87</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">COALESCE</td>
        <td colspan="1">COALESCE (odr.RescheduledDateTimeGMT, odr.CallbackDateTimeGMT)</td>
        <td>89</td>
      </tr>
      <tr valign="top">
        <td colspan="1">OBJECT_ID</td>
        <td colspan="1">OBJECT_ID('tempdb..#FinalizationStatus')</td>
        <td>111</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">OBJECT_ID('tempdb..#GXHld_Values')</td>
        <td>114</td>
      </tr>
      <tr valign="top">
        <td colspan="1">COMMIT TRANSACTION</td>
        <td colspan="1">COMMIT TRANSACTION</td>
        <td>117</td>
      </tr>
    </table>
  </body>
</html>