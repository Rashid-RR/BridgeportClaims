<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_Omniglobe_DailyProductivity]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[CallDetail_Omniglobe_DailyProductivity]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:10 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">BEGIN TRANSACTION</td>
        <td colspan="1">BEGIN TRANSACTION</td>
        <td>5</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">EXECUTE LockCriticalSection 'CallDetail_Omniglobe_DailyProductivity'</td>
        <td>7</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#ContactTransferDataTemp AS t</td>
        <td>35</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#ContactTransferData AS ctd</td>
        <td>229</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#AgentsForCampaigns AS afc</td>
        <td>434</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#ContactData AS cd</td>
        <td>504</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#AgentData AS ad</td>
        <td>505</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT h.Contact_ID
INTO   #ContactTransferDataTemp
FROM   [dbo].[Contact_Log_Header] AS h
       INNER JOIN
       [dbo].[Contact_Log_Detail] AS d
       ON d.[Contact_ID] = h.[Contact_ID]
          AND d.[contact_State] = 5
       INNER JOIN
       [dbo].[Contact_Log_Footer] AS f
       ON f.[Contact_ID] = h.[Contact_ID]
WHERE  h.[Bus_No] = @P_Bus_No
       AND h.[Start_Date] BETWEEN @P_UTCStart_Date AND @P_UTCEnd_Date
       AND h.[ReskillIndicator] &lt;&gt; 2
       AND h.[ReskillIndicator] &lt;&gt; 3
       AND h.[ReskillIndicator] &lt;&gt; 4
OPTION (RECOMPILE)</td>
        <td>15</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT   t.Contact_ID
INTO     #ContactTransferData
FROM     #ContactTransferDataTemp AS t
GROUP BY t.Contact_ID</td>
        <td>32</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT   c.[Campaign_Name] AS [Campaign],
         CONVERT (NVARCHAR, [dbo].[fn_ConvertUTCToTargetTimeZone](h.[Start_Date], @P_TimeZone), 111) AS [Date],
         SUM(CASE WHEN s.[inqueue_time] &gt; 0
                       AND s.[IsShortAbandon] = 0
                       AND f.[INbound] = 'T' THEN 1 ELSE 0 END) AS [OFF],
         SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                        AND f.[INbound] = 'T')
                       OR (s.[agent_time] = 0
                           AND s.[inqueue_Time] &gt; 0
                           AND s.[Abandon_Time] = 0
                           AND s.[IsShortAbandon] = 0
                           AND f.[INbound] = 'T') THEN 1 ELSE 0 END) AS [ANS],
         SUM(CASE WHEN s.[Abandon_Seconds] &gt; 0
                       AND s.[IsShortAbandon] = 0
                       AND f.[INbound] = 'T' THEN 1 ELSE 0 END) AS [ABN],
         CASE WHEN CAST (SUM(CASE WHEN s.[inqueue_time] &gt; 0
                                       AND s.[IsShortAbandon] = 0
                                       AND f.[INbound] = 'T' THEN 1 ELSE 0 END) AS MONEY) = 0 THEN 0 ELSE (CAST (SUM(CASE WHEN s.[Abandon_Seconds] &gt; 0
                                                                                                                               AND s.[IsShortAbandon] = 0
                                                                                                                               AND f.[INbound] = 'T' THEN 1 ELSE 0 END) AS MONEY) / CAST (SUM(CASE WHEN s.[inqueue_time] &gt; 0
                                                                                                                                                                                                        AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                        AND f.[INbound] = 'T' THEN 1 ELSE 0 END) AS MONEY)) * 100 END AS [ABN%],
         ' ' AS [ATA],
         CASE WHEN SUM(CASE WHEN s.[inqueue_time] &gt; 0
                                 AND s.[IsShortAbandon] = 0
                                 AND s.[Abandon_Seconds] &gt; 0
                                 AND f.[INbound] = 'T' THEN 1 ELSE 0 END) = 0 THEN 0 ELSE (SUM(CASE WHEN s.[Abandon_Seconds] &gt; 0
                                                                                                         AND s.[IsShortAbandon] = 0
                                                                                                         AND f.[INbound] = 'T' THEN s.[Abandon_Seconds] ELSE 0 END) / SUM(CASE WHEN s.[inqueue_time] &gt; 0
                                                                                                                                                                                    AND s.[IsShortAbandon] = 0
                                                                                                                                                                                    AND s.[Abandon_Seconds] &gt; 0
                                                                                                                                                                                    AND f.[INbound] = 'T' THEN 1 ELSE 0 END)) END AS [AVG Abn],
         CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                  AND f.[INbound] = 'T')
                                 OR (s.[agent_time] = 0
                                     AND s.[inqueue_Time] &gt; 0
                                     AND s.[Abandon_Time] = 0
                                     AND s.[IsShortAbandon] = 0
                                     AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                              AND f.[Inbound] = 'T')
                                                                                                             OR (s.[agent_time] = 0
                                                                                                                 AND s.[inqueue_Time] &gt; 0
                                                                                                                 AND s.[Abandon_Time] = 0
                                                                                                                 AND s.[IsShortAbandon] = 0
                                                                                                                 AND f.[INbound] = 'T') THEN s.[inQueue_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                              AND f.[INbound] = 'T')
                                                                                                                                                                                             OR (s.[agent_time] = 0
                                                                                                                                                                                                 AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                 AND s.[Abandon_Time] = 0
                                                                                                                                                                                                 AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                 AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END AS [ASA],
         CASE WHEN (SUM(CASE WHEN SLA = 0 THEN 1 ELSE 0 END) + SUM(CASE WHEN SLA = 1 THEN 1 ELSE 0 END)) = 0 THEN 0 ELSE (CAST (SUM(CASE WHEN SLA = 0 THEN 1 ELSE 0 END) AS MONEY) / CAST ((SUM(CASE WHEN SLA = 0 THEN 1 ELSE 0 END) + SUM(CASE WHEN SLA = 1 THEN 1 ELSE 0 END)) AS MONEY)) * 100 END AS [SL%],
         SUM(CASE WHEN SLA = 0 THEN 1 ELSE 0 END) AS [SLCC],
         '' AS [FCST],
         '' AS [O/F %],
         '' AS [A/F %],
         SUM(CASE WHEN f.[INbound] = 'T' THEN s.[Agent_Seconds] ELSE 0 END) AS [Talk Time],
         SUM(CASE WHEN f.[INbound] = 'T' THEN s.[Hold_Seconds] ELSE 0 END) AS [Hold Time],
         '' AS [Transfer Time],
         SUM(CASE WHEN ctd.[Contact_ID] IS NOT NULL
                       AND f.[Inbound] = 'T' THEN 1 ELSE 0 END) AS [Transfers],
         '' AS [Transfer Out %],
         SUM(CASE WHEN f.[INbound] = 'T' THEN s.[ACW_Seconds] ELSE 0 END) AS [ACW Time],
         REPLACE(STR(CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                              AND f.[INbound] = 'T')
                                             OR (s.[agent_time] = 0
                                                 AND s.[inqueue_Time] &gt; 0
                                                 AND s.[Abandon_Time] = 0
                                                 AND s.[IsShortAbandon] = 0
                                                 AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                          AND f.[INbound] = 'T')
                                                                                                                         OR (s.[agent_time] = 0
                                                                                                                             AND s.[inqueue_Time] &gt; 0
                                                                                                                             AND s.[Abandon_Time] = 0
                                                                                                                             AND s.[IsShortAbandon] = 0
                                                                                                                             AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                          AND f.[INbound] = 'T')
                                                                                                                                                                                                                         OR (s.[agent_time] = 0
                                                                                                                                                                                                                             AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                             AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                             AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                             AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END / 3600, LEN(LTRIM(CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                      AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                     OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                         AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                         AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                         AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                         AND f.[inbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                  AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                 OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                     AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                     AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                     AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                     AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END / 3600)) + ABS(SIGN(CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               AND f.INbound = 'T') THEN 1 ELSE 0 END) END / 359999) - 1)) + ':' + STR((CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END / 60) % 60, 2) + ':' + STR(CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END % 60, 2), ' ', '0') AS [AHT],
         SUM(CASE WHEN f.[INbound] = 'T' THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) AS [INB Transaction Time],
         SUM(CASE WHEN f.[INbound] = 'F'
                       AND f.[to_addr] NOT IN ('8665407270', '8772882020', '8002882020', '8008705855', '8662744357', '8002468464', '8666276093', '8006678934', '8882109153', '8777360730', '8008612974', '8885734107', '8664104511', '8664069596', '8003310500', '8005315000', '8002784388', '8888252557', '8662661292', '8662375249', '8885734147', '8002038600', '8889288932', '8882749056', '8885099399', '6019612954', '8883954654', '8008709582', '8665080898', '8009753902', '9723400023', '7136386948', '8772581427', '8777092027', '8668053921', '8669156188', '8668627221', '8006214533', '8005590050', '8777223755', '8883212375', '8663830076', '8882374554', '8003585982', '8886100680', '8886100727', '8007425877', '8667464694', '8663412662', '8773770415', '8665088290', '8664464115', '8666735963', '8773770414', '8887229337', '8669128216', '8003102355', '8665930724', '8887576500', '8666624548', '8775710223', '8006947466', '8885628662', '8772552377', '8003310500', '8669268262', '7873975332', '8888674384', '8667461081', '8008445175', '8008661514', '8162753420', '8664168166', '8664051373', '8663910749', '8665637634', '8889322324', '8664019271', '8883973742', '8885678688', '8004633339', '8778445584', '8664997888', '8884444410', '8009995445', '8888987685', '8669145787', '8778148977', '8002140825', '8664998008', '8772846828', '8009475096', '8662887629', '8668951099', '8008884213', '8007425877', '8002221811', '8008011101', '8009822084', '8668528617', '8774486767', '8008074205', '8002882020', '8772882020', '8662943464', '8005315000', '8662904236', '8883821222', '8777223755', '8883212375', '8667223425', '888 5734147', '8004385678', '8003310500', '8779991083', '8002468464', '8777372478', '8779991085', '8779990788', '8002038600', '8883006500', '8006356840', '8005470403', '8008677183', '8006497570', '8883411270') THEN s.[Agent_Seconds] - s.[ACW_Seconds] ELSE 0 END) AS [OUTB Talk Time],
         SUM(CASE WHEN f.[INbound] = 'F'
                       AND f.[to_addr] NOT IN ('8665407270', '8772882020', '8002882020', '8008705855', '8662744357', '8002468464', '8666276093', '8006678934', '8882109153', '8777360730', '8008612974', '8885734107', '8664104511', '8664069596', '8003310500', '8005315000', '8002784388', '8888252557', '8662661292', '8662375249', '8885734147', '8002038600', '8889288932', '8882749056', '8885099399', '6019612954', '8883954654', '8008709582', '8665080898', '8009753902', '9723400023', '7136386948', '8772581427', '8777092027', '8668053921', '8669156188', '8668627221', '8006214533', '8005590050', '8777223755', '8883212375', '8663830076', '8882374554', '8003585982', '8886100680', '8886100727', '8007425877', '8667464694', '8663412662', '8773770415', '8665088290', '8664464115', '8666735963', '8773770414', '8887229337', '8669128216', '8003102355', '8665930724', '8887576500', '8666624548', '8775710223', '8006947466', '8885628662', '8772552377', '8003310500', '8669268262', '7873975332', '8888674384', '8667461081', '8008445175', '8008661514', '8162753420', '8664168166', '8664051373', '8663910749', '8665637634', '8889322324', '8664019271', '8883973742', '8885678688', '8004633339', '8778445584', '8664997888', '8884444410', '8009995445', '8888987685', '8669145787', '8778148977', '8002140825', '8664998008', '8772846828', '8009475096', '8662887629', '8668951099', '8008884213', '8007425877', '8002221811', '8008011101', '8009822084', '8668528617', '8774486767', '8008074205', '8002882020', '8772882020', '8662943464', '8005315000', '8662904236', '8883821222', '8777223755', '8883212375', '8667223425', '888 5734147', '8004385678', '8003310500', '8779991083', '8002468464', '8777372478', '8779991085', '8779990788', '8002038600', '8883006500', '8006356840', '8005470403', '8008677183', '8006497570', '8883411270') THEN s.[ACW_Seconds] ELSE 0 END) AS [OUTB ACW Time],
         SUM(CASE WHEN f.[INbound] = 'F'
                       AND f.[to_addr] NOT IN ('8665407270', '8772882020', '8002882020', '8008705855', '8662744357', '8002468464', '8666276093', '8006678934', '8882109153', '8777360730', '8008612974', '8885734107', '8664104511', '8664069596', '8003310500', '8005315000', '8002784388', '8888252557', '8662661292', '8662375249', '8885734147', '8002038600', '8889288932', '8882749056', '8885099399', '6019612954', '8883954654', '8008709582', '8665080898', '8009753902', '9723400023', '7136386948', '8772581427', '8777092027', '8668053921', '8669156188', '8668627221', '8006214533', '8005590050', '8777223755', '8883212375', '8663830076', '8882374554', '8003585982', '8886100680', '8886100727', '8007425877', '8667464694', '8663412662', '8773770415', '8665088290', '8664464115', '8666735963', '8773770414', '8887229337', '8669128216', '8003102355', '8665930724', '8887576500', '8666624548', '8775710223', '8006947466', '8885628662', '8772552377', '8003310500', '8669268262', '7873975332', '8888674384', '8667461081', '8008445175', '8008661514', '8162753420', '8664168166', '8664051373', '8663910749', '8665637634', '8889322324', '8664019271', '8883973742', '8885678688', '8004633339', '8778445584', '8664997888', '8884444410', '8009995445', '8888987685', '8669145787', '8778148977', '8002140825', '8664998008', '8772846828', '8009475096', '8662887629', '8668951099', '8008884213', '8007425877', '8002221811', '8008011101', '8009822084', '8668528617', '8774486767', '8008074205', '8002882020', '8772882020', '8662943464', '8005315000', '8662904236', '8883821222', '8777223755', '8883212375', '8667223425', '888 5734147', '8004385678', '8003310500', '8779991083', '8002468464', '8777372478', '8779991085', '8779990788', '8002038600', '8883006500', '8006356840', '8005470403', '8008677183', '8006497570', '8883411270') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) AS [OUTB Transaction Time],
         '' AS [OUTB Transaction %],
         SUM(CASE WHEN f.[Inbound] = 'F'
                       AND f.[to_addr] NOT IN ('8665407270', '8772882020', '8002882020', '8008705855', '8662744357', '8002468464', '8666276093', '8006678934', '8882109153', '8777360730', '8008612974', '8885734107', '8664104511', '8664069596', '8003310500', '8005315000', '8002784388', '8888252557', '8662661292', '8662375249', '8885734147', '8002038600', '8889288932', '8882749056', '8885099399', '6019612954', '8883954654', '8008709582', '8665080898', '8009753902', '9723400023', '7136386948', '8772581427', '8777092027', '8668053921', '8669156188', '8668627221', '8006214533', '8005590050', '8777223755', '8883212375', '8663830076', '8882374554', '8003585982', '8886100680', '8886100727', '8007425877', '8667464694', '8663412662', '8773770415', '8665088290', '8664464115', '8666735963', '8773770414', '8887229337', '8669128216', '8003102355', '8665930724', '8887576500', '8666624548', '8775710223', '8006947466', '8885628662', '8772552377', '8003310500', '8669268262', '7873975332', '8888674384', '8667461081', '8008445175', '8008661514', '8162753420', '8664168166', '8664051373', '8663910749', '8665637634', '8889322324', '8664019271', '8883973742', '8885678688', '8004633339', '8778445584', '8664997888', '8884444410', '8009995445', '8888987685', '8669145787', '8778148977', '8002140825', '8664998008', '8772846828', '8009475096', '8662887629', '8668951099', '8008884213', '8007425877', '8002221811', '8008011101', '8009822084', '8668528617', '8774486767', '8008074205', '8002882020', '8772882020', '8662943464', '8005315000', '8662904236', '8883821222', '8777223755', '8883212375', '8667223425', '888 5734147', '8004385678', '8003310500', '8779991083', '8002468464', '8777372478', '8779991085', '8779990788', '8002038600', '8883006500', '8006356840', '8005470403', '8008677183', '8006497570', '8883411270') THEN 1 ELSE 0 END) AS [OUTB Transactions]
INTO     #ContactData
FROM     [dbo].[Contact_Log_Header] AS h
         INNER JOIN
         [dbo].[Contact_Log_Footer] AS f
         ON f.[Contact_ID] = h.[Contact_ID]
         INNER JOIN
         [dbo].[Contact_Log_Summary] AS s
         ON s.[Contact_ID] = h.[Contact_ID]
         INNER JOIN
         [dbo].[Campaign] AS c
         ON c.[Campaign_no] = f.[Campaign_No]
         INNER JOIN
         [dbo].[Skills] AS sk
         ON sk.[Skill_No] = f.[SKill_No]
         LEFT OUTER JOIN
         #ContactTransferData AS ctd
         ON ctd.[Contact_ID] = h.[Contact_ID]
WHERE    h.[Bus_No] = @P_Bus_No
         AND h.[Start_Date] BETWEEN @P_UTCStart_Date AND @P_UTCEnd_Date
         AND h.[ReskillIndicator] &lt;&gt; 2
         AND h.[ReskillIndicator] &lt;&gt; 3
         AND h.[ReskillIndicator] &lt;&gt; 4
GROUP BY c.[Campaign_Name], CONVERT (NVARCHAR, [dbo].[fn_ConvertUTCToTargetTimeZone](h.[Start_Date], @P_TimeZone), 111)</td>
        <td>42</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT   c.[Campaign_Name],
         ask.[Agent_No]
INTO     #AgentsForCampaigns
FROM     [dbo].[Campaign] AS c
         INNER JOIN
         [dbo].[Skills] AS sk
         ON sk.[Campaign_No] = c.[Campaign_No]
         INNER JOIN
         [dbo].[AgentSkl] AS ask
         ON ask.[Skill_No] = sk.[SKill_NO]
            AND ask.[Status] = 'CURR'
WHERE    c.[Bus_No] = @P_Bus_No
GROUP BY c.[Campaign_Name], ask.[Agent_No]</td>
        <td>242</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT   afc.[Campaign_Name] AS [Campaign],
         CONVERT (NVARCHAR, [dbo].[fn_ConvertUTCToTargetTimeZone](h.[Start_Date], @P_TimeZone), 111) AS [Date],
         SUM(CASE WHEN d.[Working] = 1
                       AND d.[Available] = 0
                       AND d.[outstate_Code] = 0 THEN ds.[Duration_Seconds] ELSE 0 END) + SUM(CASE WHEN d.[Working] = 0
                                                                                                        AND d.[Available] = 0
                                                                                                        AND ds.[IsACW] = 'T' THEN ds.[Duration_Seconds] ELSE 0 END) + SUM(CASE WHEN (d.[Working] = 2
                                                                                                                                                                                     AND d.[Available] = 0
                                                                                                                                                                                     AND d.[outstate_Code] = 0) THEN ds.[Duration_Seconds] ELSE 0 END) AS [Total Transaction Time],
         SUM(CASE WHEN d.[Working] = 0
                       AND d.[Available] = 1
                       AND d.[outstate_Code] = 0 THEN ds.[Duration_Seconds] ELSE 0 END) AS [Idle Time],
         SUM(CASE WHEN d.[Working] = 0
                       AND d.[Available] = 0
                       AND d.[outstate_Code] IN (51, 45, 170) THEN ds.[Duration_Seconds] ELSE 0 END) AS [NR Prod Time],
         SUM(CASE WHEN d.[Working] = 0
                       AND d.[Available] = 0
                       AND d.[outstate_Code] = 51 THEN ds.[Duration_Seconds] ELSE 0 END) AS [NR Training],
         SUM(CASE WHEN d.[Working] = 0
                       AND d.[Available] = 0
                       AND d.[outstate_Code] = 45 THEN ds.[Duration_Seconds] ELSE 0 END) AS [NR Coaching],
         SUM(CASE WHEN d.[Working] = 0
                       AND d.[Available] = 0
                       AND d.[outstate_Code] = 170 THEN ds.[Duration_Seconds] ELSE 0 END) AS [NR Special],
         SUM(CASE WHEN d.[Working] = 0
                       AND d.[Available] = 0
                       AND d.[outstate_Code] IN (47, 44, 50) THEN ds.[Duration_Seconds] ELSE 0 END) AS [NR UnProd Time],
         SUM(CASE WHEN d.[Working] = 0
                       AND d.[Available] = 0
                       AND d.[outstate_Code] = 47 THEN ds.[Duration_Seconds] ELSE 0 END) AS [NR Lunch],
         SUM(CASE WHEN d.[Working] = 0
                       AND d.[Available] = 0
                       AND d.[outstate_Code] = 44 THEN ds.[Duration_Seconds] ELSE 0 END) AS [NR Break],
         SUM(CASE WHEN d.[Working] = 0
                       AND d.[Available] = 0
                       AND d.[outstate_Code] = 50 THEN ds.[Duration_Seconds] ELSE 0 END) AS [NR Other],
         SUM(CASE WHEN d.[Working] = 0
                       AND d.[Available] = 0
                       AND d.[outstate_Code] = 242 THEN ds.[Duration_Seconds] ELSE 0 END) AS [NR OP],
         SUM(CASE WHEN d.[Working] = 0
                       AND d.[Available] = 0
                       AND d.[outstate_Code] = 414 THEN ds.[Duration_Seconds] ELSE 0 END) AS [NR CHAT],
         SUM(CASE WHEN d.[Working] = 0
                       AND d.[Available] = 0
                       AND d.[outstate_Code] = 48 THEN ds.[Duration_Seconds] ELSE 0 END) AS [NR OB],
         SUM(CASE WHEN d.[Working] = 0
                       AND d.[Available] = 0
                       AND d.[outstate_Code] = 49 THEN ds.[Duration_Seconds] ELSE 0 END) AS [NR TM MTG],
         SUM(CASE WHEN d.[Working] = 0
                       AND d.[Available] = 0
                       AND d.[outstate_Code] = 413 THEN ds.[Duration_Seconds] ELSE 0 END) AS [NR FLR SPT],
         SUM(CASE WHEN d.[Working] = 0
                       AND d.[Available] = 0
                       AND d.[outstate_Code] = 481 THEN ds.[Duration_Seconds] ELSE 0 END) AS [NR SPECIAL PROJECT],
         SUM(CASE WHEN d.[Working] = 0
                       AND d.[Available] = 0
                       AND d.[outstate_Code] = 46 THEN ds.[Duration_Seconds] ELSE 0 END) AS [NR DOWN],
         SUM(CASE WHEN d.[Working] = 1
                       AND d.[Available] = 0
                       AND d.[outstate_Code] = 0 THEN ds.[Duration_Seconds] ELSE 0 END) + SUM(CASE WHEN d.[Working] = 2
                                                                                                        AND d.[Available] = 0
                                                                                                        AND d.[outstate_Code] = 0 THEN ds.[Duration_Seconds] ELSE 0 END) + SUM(CASE WHEN d.[Working] = 0
                                                                                                                                                                                         AND d.[Available] = 0
                                                                                                                                                                                         AND ds.[isACW] = 'T' THEN ds.[Duration_Seconds] ELSE 0 END) + SUM(CASE WHEN d.[Working] = 0
                                                                                                                                                                                                                                                                     AND d.[Available] = 1
                                                                                                                                                                                                                                                                     AND d.[outstate_Code] = 0 THEN ds.[Duration_Seconds] ELSE 0 END) + SUM(CASE WHEN d.[Working] = 0
                                                                                                                                                                                                                                                                                                                                                      AND d.[Available] = 0
                                                                                                                                                                                                                                                                                                                                                      AND d.[outstate_Code] IN (51, 45, 170) THEN ds.[Duration_Seconds] ELSE 0 END) + SUM(CASE WHEN d.[Working] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                    AND d.[Available] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                    AND d.[outstate_Code] IN (47, 44, 50) THEN ds.[Duration_Seconds] ELSE 0 END) AS [Total Time],
         '' AS [MSR],
         '' AS [MSC],
         '' AS [Sched Time],
         '' AS [AA],
         '' AS [BackFill Time],
         '' AS [OT Time],
         '' AS [Absent Time],
         '' AS [Absence %],
         '' AS [SynOT],
         '' AS [UOT],
         '' AS [EABS%],
         CASE WHEN CAST (SUM(CASE WHEN (d.[Working] = 1
                                        AND d.[Available] = 0
                                        AND d.[outstate_Code] = 0)
                                       OR (d.[Working] = 2
                                           AND d.[Available] = 0
                                           AND d.[outstate_Code] = 0)
                                       OR (d.[Working] = 0
                                           AND d.[Available] = 0
                                           AND d.[outstate_Code] &lt;&gt; 0
                                           AND ds.[IsACW] = 'T')
                                       OR (d.[Working] = 0
                                           AND d.[Available] = 1
                                           AND d.[outstate_Code] = 0)
                                       OR (d.[Working] = 0
                                           AND d.[Available] = 0
                                           AND d.[outstate_Code] IN (51, 45, 170))
                                       OR (d.[Working] = 0
                                           AND d.[Available] = 0
                                           AND d.[outstate_Code] = 50) THEN ds.[Duration_Seconds] ELSE 0 END) AS MONEY) * 100 &lt;= 0 THEN 0 ELSE (CAST (SUM(CASE WHEN (d.[Working] = 1
                                                                                                                                                                     AND d.[Available] = 0
                                                                                                                                                                     AND d.[outstate_Code] = 0)
                                                                                                                                                                    OR (d.[Working] = 2
                                                                                                                                                                        AND d.[Available] = 0
                                                                                                                                                                        AND d.[outstate_Code] = 0)
                                                                                                                                                                    OR (d.[Working] = 0
                                                                                                                                                                        AND d.[Available] = 0
                                                                                                                                                                        AND d.[outstate_Code] &lt;&gt; 0
                                                                                                                                                                        AND ds.[IsACW] = 'T') THEN ds.[Duration_Seconds] ELSE 0 END) AS MONEY) / CAST (SUM(CASE WHEN (d.[Working] = 1
                                                                                                                                                                                                                                                                      AND d.[Available] = 0
                                                                                                                                                                                                                                                                      AND d.[outstate_Code] = 0)
                                                                                                                                                                                                                                                                     OR (d.[Working] = 2
                                                                                                                                                                                                                                                                         AND d.[Available] = 0
                                                                                                                                                                                                                                                                         AND d.[outstate_Code] = 0)
                                                                                                                                                                                                                                                                     OR (d.[Working] = 0
                                                                                                                                                                                                                                                                         AND d.[Available] = 0
                                                                                                                                                                                                                                                                         AND d.[outstate_Code] &lt;&gt; 0
                                                                                                                                                                                                                                                                         AND ds.[IsACW] = 'T')
                                                                                                                                                                                                                                                                     OR (d.[Working] = 0
                                                                                                                                                                                                                                                                         AND d.[Available] = 1
                                                                                                                                                                                                                                                                         AND d.[outstate_Code] = 0)
                                                                                                                                                                                                                                                                     OR (d.[Working] = 0
                                                                                                                                                                                                                                                                         AND d.[Available] = 0
                                                                                                                                                                                                                                                                         AND d.[outstate_Code] IN (51, 45, 170))
                                                                                                                                                                                                                                                                     OR (d.[Working] = 0
                                                                                                                                                                                                                                                                         AND d.[Available] = 0
                                                                                                                                                                                                                                                                         AND d.[outstate_Code] = 50) THEN ds.[Duration_Seconds] ELSE 0 END) AS MONEY)) * 100 END AS [OCC %],
         CASE WHEN CAST (SUM(CASE WHEN (d.[Working] = 1
                                        AND d.[Available] = 0
                                        AND d.[outstate_Code] = 0)
                                       OR (d.[Working] = 2
                                           AND d.[Available] = 0
                                           AND d.[outstate_Code] = 0)
                                       OR (d.[Working] = 0
                                           AND d.[Available] = 1
                                           AND d.[outstate_Code] = 0)
                                       OR (d.[Working] = 0
                                           AND d.[Available] = 0
                                           AND d.[outstate_Code] &lt;&gt; 0
                                           AND ds.[IsACW] = 'T') THEN ds.[Duration_Seconds] ELSE 0 END) AS MONEY) * 100 &lt;= 0 THEN 0 ELSE (CAST (SUM(CASE WHEN (d.[Working] = 1
                                                                                                                                                               AND d.[Available] = 0
                                                                                                                                                               AND d.[outstate_Code] = 0)
                                                                                                                                                              OR (d.[Working] = 2
                                                                                                                                                                  AND d.[Available] = 0
                                                                                                                                                                  AND d.[outstate_Code] = 0)
                                                                                                                                                              OR (d.[Working] = 0
                                                                                                                                                                  AND d.[Available] = 0
                                                                                                                                                                  AND d.[outstate_Code] &lt;&gt; 0
                                                                                                                                                                  AND ds.[IsACW] = 'T') THEN ds.[Duration_Seconds] ELSE 0 END) AS MONEY) / CAST (SUM(CASE WHEN (d.[Working] = 1
                                                                                                                                                                                                                                                                AND d.[Available] = 0
                                                                                                                                                                                                                                                                AND d.[outstate_Code] = 0)
                                                                                                                                                                                                                                                               OR (d.[Working] = 2
                                                                                                                                                                                                                                                                   AND d.[Available] = 0
                                                                                                                                                                                                                                                                   AND d.[outstate_Code] = 0)
                                                                                                                                                                                                                                                               OR (d.[Working] = 0
                                                                                                                                                                                                                                                                   AND d.[Available] = 1
                                                                                                                                                                                                                                                                   AND d.[outstate_Code] = 0)
                                                                                                                                                                                                                                                               OR (d.[Working] = 0
                                                                                                                                                                                                                                                                   AND d.[Available] = 0
                                                                                                                                                                                                                                                                   AND d.[outstate_Code] &lt;&gt; 0
                                                                                                                                                                                                                                                                   AND ds.[IsACW] = 'T') THEN ds.[Duration_Seconds] ELSE 0 END) AS MONEY)) * 100 END AS [UTIL %],
         CASE WHEN CAST (SUM(ds.[Duration_Seconds]) AS MONEY) * 100 &lt;= 0 THEN 0 ELSE (CAST (SUM(CASE WHEN (d.[Working] = 1
                                                                                                           AND d.[Available] = 0
                                                                                                           AND d.[outstate_Code] = 0)
                                                                                                          OR (d.[Working] = 2
                                                                                                              AND d.[Available] = 0
                                                                                                              AND d.[outstate_Code] = 0)
                                                                                                          OR d.[Working] = 0
                                                                                                             AND d.[Available] = 0
                                                                                                             AND d.[outstate_Code] IN (51, 45)
                                                                                                          OR (d.[Working] = 0
                                                                                                              AND d.[Available] = 0
                                                                                                              AND d.[outstate_Code] &lt;&gt; 0
                                                                                                              AND ds.[IsACW] = 'T') THEN ds.[Duration_Seconds] ELSE 0 END) AS MONEY) / CAST (SUM(ds.[Duration_Seconds]) AS MONEY)) * 100 END AS [PROD %],
         '' AS [Total Billable Time],
         SUM(CASE WHEN (d.[Working] = 1
                        AND d.[Available] = 0
                        AND d.[outstate_Code] = 0)
                       OR (d.[Working] = 2
                           AND d.[Available] = 0
                           AND d.[outstate_Code] = 0)
                       OR (d.[Working] = 0
                           AND d.[Available] = 0
                           AND d.[outstate_Code] &lt;&gt; 0
                           AND ds.[IsACW] = 'T')
                       OR (d.[Working] = 0
                           AND d.[Available] = 1
                           AND d.[outstate_Code] = 0)
                       OR (d.[Working] = 0
                           AND d.[Available] = 0
                           AND d.[outstate_Code] IN (51, 45))
                       OR (d.[Working] = 0
                           AND d.[Available] = 0
                           AND d.[outstate_Code] = 50) THEN ds.[Duration_Seconds] ELSE 0 END) AS [Total Productive Time],
         '' AS [Trans per Billable Hour],
         CASE WHEN SUM(CASE WHEN (d.[Working] = 1
                                  AND d.[Available] = 0
                                  AND d.[outstate_Code] = 0)
                                 OR (d.[Working] = 2
                                     AND d.[Available] = 0
                                     AND d.[outstate_Code] = 0)
                                 OR (d.[Working] = 0
                                     AND d.[Available] = 0
                                     AND d.[outstate_Code] &lt;&gt; 0
                                     AND ds.[IsACW] = 'T')
                                 OR (d.[Working] = 0
                                     AND d.[Available] = 1
                                     AND d.[outstate_Code] = 0)
                                 OR (d.[Working] = 0
                                     AND d.[Available] = 0
                                     AND d.[outstate_Code] IN (51, 45, 170))
                                 OR (d.[Working] = 0
                                     AND d.[Available] = 0
                                     AND d.[outstate_Code] = 50) THEN ds.[Duration_Seconds] ELSE 0 END) / 60 / 60 &lt;= 0 THEN 0 ELSE SUM(CASE WHEN (d.[Working] = 1
                                                                                                                                                  AND d.[Available] = 0
                                                                                                                                                  AND d.[outstate_Code] = 0) THEN 1 ELSE 0 END) / SUM(CASE WHEN (d.[Working] = 1
                                                                                                                                                                                                                 AND d.[Available] = 0
                                                                                                                                                                                                                 AND d.[outstate_Code] = 0)
                                                                                                                                                                                                                OR (d.[Working] = 2
                                                                                                                                                                                                                    AND d.[Available] = 0
                                                                                                                                                                                                                    AND d.[outstate_Code] = 0)
                                                                                                                                                                                                                OR (d.[Working] = 0
                                                                                                                                                                                                                    AND d.[Available] = 0
                                                                                                                                                                                                                    AND d.[outstate_Code] &lt;&gt; 0
                                                                                                                                                                                                                    AND ds.[IsACW] = 'T')
                                                                                                                                                                                                                OR (d.[Working] = 0
                                                                                                                                                                                                                    AND d.[Available] = 1
                                                                                                                                                                                                                    AND d.[outstate_Code] = 0)
                                                                                                                                                                                                                OR (d.[Working] = 0
                                                                                                                                                                                                                    AND d.[Available] = 0
                                                                                                                                                                                                                    AND d.[outstate_Code] IN (51, 45, 170))
                                                                                                                                                                                                                OR (d.[Working] = 0
                                                                                                                                                                                                                    AND d.[Available] = 0
                                                                                                                                                                                                                    AND d.[outstate_Code] = 50) THEN ds.[Duration_Seconds] ELSE 0 END) / 60 / 60 END AS [Trans per Productive Hour],
         '' AS [Regular Hours],
         '' AS [Paid OT Hours],
         CAST ((CAST (SUM(ds.[Duration_Seconds]) AS MONEY) - CAST (SUM(CASE WHEN d.[Working] = 0
                                                                                 AND d.[Available] = 0
                                                                                 AND d.[outstate_Code] IN (47, 44, 50) THEN ds.[Duration_Seconds] ELSE 0 END) AS MONEY)) / 60 / 60 AS MONEY) AS [Total Hours],
         CAST (((CAST (SUM(ds.[Duration_Seconds]) AS MONEY) - CAST (SUM(CASE WHEN d.[Working] = 0
                                                                                  AND d.[Available] = 0
                                                                                  AND d.[outstate_Code] IN (47, 44, 50) THEN ds.[Duration_Seconds] ELSE 0 END) AS MONEY)) / 60 / 60) / 8 AS MONEY) AS [Effective HC],
         '' AS [Cost per Day],
         '' AS [Cost per Transaction]
INTO     #AgentData
FROM     [dbo].[Agent_Log_Header] AS h
         INNER JOIN
         [dbo].[Agent_Log_Detail] AS d
         ON d.[Agent_Session_ID] = h.[Agent_Session_ID]
         INNER JOIN
         [dbo].[Agent_Log_Detail_Summary] AS ds
         ON ds.[Agent_Session_ID] = h.[Agent_Session_ID]
            AND ds.[StateINdex] = d.[StateIndex]
         INNER JOIN
         #AgentsForCampaigns AS afc
         ON afc.[Agent_No] = h.[Agent_No]
WHERE    h.[Bus_No] = @P_Bus_No
         AND h.[Start_Date] BETWEEN @P_UTCStart_Date AND @P_UTCEnd_Date
GROUP BY afc.[Campaign_Name], CONVERT (NVARCHAR, [dbo].[fn_ConvertUTCToTargetTimeZone](h.[Start_Date], @P_TimeZone), 111)</td>
        <td>258</td>
      </tr>
      <tr valign="top">
        <td colspan="1">RECOMPILE</td>
        <td colspan="1">RECOMPILE</td>
        <td>-1</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN s.[inqueue_time] &gt; 0
          AND s.[IsShortAbandon] = 0
          AND f.[INbound] = 'T' THEN 1 ELSE 0 END</td>
        <td>45</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN 1 ELSE 0 END</td>
        <td>49</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.[Abandon_Seconds] &gt; 0
          AND s.[IsShortAbandon] = 0
          AND f.[INbound] = 'T' THEN 1 ELSE 0 END</td>
        <td>53</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN CAST (SUM(CASE WHEN s.[inqueue_time] &gt; 0
                              AND s.[IsShortAbandon] = 0
                              AND f.[INbound] = 'T' THEN 1 ELSE 0 END) AS MONEY) = 0 THEN 0 ELSE (CAST (SUM(CASE WHEN s.[Abandon_Seconds] &gt; 0
                                                                                                                      AND s.[IsShortAbandon] = 0
                                                                                                                      AND f.[INbound] = 'T' THEN 1 ELSE 0 END) AS MONEY) / CAST (SUM(CASE WHEN s.[inqueue_time] &gt; 0
                                                                                                                                                                                               AND s.[IsShortAbandon] = 0
                                                                                                                                                                                               AND f.[INbound] = 'T' THEN 1 ELSE 0 END) AS MONEY)) * 100 END</td>
        <td>57</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.[inqueue_time] &gt; 0
          AND s.[IsShortAbandon] = 0
          AND f.[INbound] = 'T' THEN 1 ELSE 0 END</td>
        <td>58</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.[Abandon_Seconds] &gt; 0
          AND s.[IsShortAbandon] = 0
          AND f.[INbound] = 'T' THEN 1 ELSE 0 END</td>
        <td>62</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.[inqueue_time] &gt; 0
          AND s.[IsShortAbandon] = 0
          AND f.[INbound] = 'T' THEN 1 ELSE 0 END</td>
        <td>65</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SUM(CASE WHEN s.[inqueue_time] &gt; 0
                        AND s.[IsShortAbandon] = 0
                        AND s.[Abandon_Seconds] &gt; 0
                        AND f.[INbound] = 'T' THEN 1 ELSE 0 END) = 0 THEN 0 ELSE (SUM(CASE WHEN s.[Abandon_Seconds] &gt; 0
                                                                                                AND s.[IsShortAbandon] = 0
                                                                                                AND f.[INbound] = 'T' THEN s.[Abandon_Seconds] ELSE 0 END) / SUM(CASE WHEN s.[inqueue_time] &gt; 0
                                                                                                                                                                           AND s.[IsShortAbandon] = 0
                                                                                                                                                                           AND s.[Abandon_Seconds] &gt; 0
                                                                                                                                                                           AND f.[INbound] = 'T' THEN 1 ELSE 0 END)) END</td>
        <td>71</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.[inqueue_time] &gt; 0
          AND s.[IsShortAbandon] = 0
          AND s.[Abandon_Seconds] &gt; 0
          AND f.[INbound] = 'T' THEN 1 ELSE 0 END</td>
        <td>72</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.[Abandon_Seconds] &gt; 0
          AND s.[IsShortAbandon] = 0
          AND f.[INbound] = 'T' THEN s.[Abandon_Seconds] ELSE 0 END</td>
        <td>76</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN s.[inqueue_time] &gt; 0
          AND s.[IsShortAbandon] = 0
          AND s.[Abandon_Seconds] &gt; 0
          AND f.[INbound] = 'T' THEN 1 ELSE 0 END</td>
        <td>79</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                         AND f.[INbound] = 'T')
                        OR (s.[agent_time] = 0
                            AND s.[inqueue_Time] &gt; 0
                            AND s.[Abandon_Time] = 0
                            AND s.[IsShortAbandon] = 0
                            AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                     AND f.[Inbound] = 'T')
                                                                                                    OR (s.[agent_time] = 0
                                                                                                        AND s.[inqueue_Time] &gt; 0
                                                                                                        AND s.[Abandon_Time] = 0
                                                                                                        AND s.[IsShortAbandon] = 0
                                                                                                        AND f.[INbound] = 'T') THEN s.[inQueue_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                     AND f.[INbound] = 'T')
                                                                                                                                                                                    OR (s.[agent_time] = 0
                                                                                                                                                                                        AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                        AND s.[Abandon_Time] = 0
                                                                                                                                                                                        AND s.[IsShortAbandon] = 0
                                                                                                                                                                                        AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END</td>
        <td>84</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN 1 ELSE 0 END</td>
        <td>85</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[Inbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN s.[inQueue_Seconds] ELSE 0 END</td>
        <td>89</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN 1 ELSE 0 END</td>
        <td>92</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (SUM(CASE WHEN SLA = 0 THEN 1 ELSE 0 END) + SUM(CASE WHEN SLA = 1 THEN 1 ELSE 0 END)) = 0 THEN 0 ELSE (CAST (SUM(CASE WHEN SLA = 0 THEN 1 ELSE 0 END) AS MONEY) / CAST ((SUM(CASE WHEN SLA = 0 THEN 1 ELSE 0 END) + SUM(CASE WHEN SLA = 1 THEN 1 ELSE 0 END)) AS MONEY)) * 100 END</td>
        <td>97</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SLA = 0 THEN 1 ELSE 0 END</td>
        <td>98</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SLA = 1 THEN 1 ELSE 0 END</td>
        <td>101</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SLA = 0 THEN 1 ELSE 0 END</td>
        <td>105</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SLA = 0 THEN 1 ELSE 0 END</td>
        <td>108</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SLA = 1 THEN 1 ELSE 0 END</td>
        <td>111</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SLA = 0 THEN 1 ELSE 0 END</td>
        <td>116</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN f.[INbound] = 'T' THEN s.[Agent_Seconds] ELSE 0 END</td>
        <td>123</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN f.[INbound] = 'T' THEN s.[Hold_Seconds] ELSE 0 END</td>
        <td>127</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ctd.[Contact_ID] IS NOT NULL
          AND f.[Inbound] = 'T' THEN 1 ELSE 0 END</td>
        <td>132</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN f.[INbound] = 'T' THEN s.[ACW_Seconds] ELSE 0 END</td>
        <td>137</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                         AND f.[INbound] = 'T')
                        OR (s.[agent_time] = 0
                            AND s.[inqueue_Time] &gt; 0
                            AND s.[Abandon_Time] = 0
                            AND s.[IsShortAbandon] = 0
                            AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                     AND f.[INbound] = 'T')
                                                                                                    OR (s.[agent_time] = 0
                                                                                                        AND s.[inqueue_Time] &gt; 0
                                                                                                        AND s.[Abandon_Time] = 0
                                                                                                        AND s.[IsShortAbandon] = 0
                                                                                                        AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                     AND f.[INbound] = 'T')
                                                                                                                                                                                                    OR (s.[agent_time] = 0
                                                                                                                                                                                                        AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                        AND s.[Abandon_Time] = 0
                                                                                                                                                                                                        AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                        AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END</td>
        <td>141</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN 1 ELSE 0 END</td>
        <td>142</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END</td>
        <td>146</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN 1 ELSE 0 END</td>
        <td>149</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                         AND f.[INbound] = 'T')
                        OR (s.[agent_time] = 0
                            AND s.[inqueue_Time] &gt; 0
                            AND s.[Abandon_Time] = 0
                            AND s.[IsShortAbandon] = 0
                            AND f.[inbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                     AND f.[INbound] = 'T')
                                                                                                    OR (s.[agent_time] = 0
                                                                                                        AND s.[inqueue_Time] &gt; 0
                                                                                                        AND s.[Abandon_Time] = 0
                                                                                                        AND s.[IsShortAbandon] = 0
                                                                                                        AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                     AND f.[INbound] = 'T')
                                                                                                                                                                                                    OR (s.[agent_time] = 0
                                                                                                                                                                                                        AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                        AND s.[Abandon_Time] = 0
                                                                                                                                                                                                        AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                        AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END</td>
        <td>153</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[inbound] = 'T') THEN 1 ELSE 0 END</td>
        <td>154</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END</td>
        <td>158</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN 1 ELSE 0 END</td>
        <td>161</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                         AND f.[INbound] = 'T')
                        OR (s.[agent_time] = 0
                            AND s.[inqueue_Time] &gt; 0
                            AND s.[Abandon_Time] = 0
                            AND s.[IsShortAbandon] = 0
                            AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                     AND f.[INbound] = 'T')
                                                                                                    OR (s.[agent_time] = 0
                                                                                                        AND s.[inqueue_Time] &gt; 0
                                                                                                        AND s.[Abandon_Time] = 0
                                                                                                        AND s.[IsShortAbandon] = 0
                                                                                                        AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                     AND f.[INbound] = 'T')
                                                                                                                                                                                                    OR (s.[agent_time] = 0
                                                                                                                                                                                                        AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                        AND s.[Abandon_Time] = 0
                                                                                                                                                                                                        AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                        AND f.INbound = 'T') THEN 1 ELSE 0 END) END</td>
        <td>165</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN 1 ELSE 0 END</td>
        <td>166</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END</td>
        <td>170</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.INbound = 'T') THEN 1 ELSE 0 END</td>
        <td>173</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                         AND f.[INbound] = 'T')
                        OR (s.[agent_time] = 0
                            AND s.[inqueue_Time] &gt; 0
                            AND s.[Abandon_Time] = 0
                            AND s.[IsShortAbandon] = 0
                            AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                     AND f.[INbound] = 'T')
                                                                                                    OR (s.[agent_time] = 0
                                                                                                        AND s.[inqueue_Time] &gt; 0
                                                                                                        AND s.[Abandon_Time] = 0
                                                                                                        AND s.[IsShortAbandon] = 0
                                                                                                        AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                     AND f.[INbound] = 'T')
                                                                                                                                                                                                    OR (s.[agent_time] = 0
                                                                                                                                                                                                        AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                        AND s.[Abandon_Time] = 0
                                                                                                                                                                                                        AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                        AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END</td>
        <td>177</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN 1 ELSE 0 END</td>
        <td>178</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END</td>
        <td>182</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN 1 ELSE 0 END</td>
        <td>185</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                         AND f.[INbound] = 'T')
                        OR (s.[agent_time] = 0
                            AND s.[inqueue_Time] &gt; 0
                            AND s.[Abandon_Time] = 0
                            AND s.[IsShortAbandon] = 0
                            AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                     AND f.[INbound] = 'T')
                                                                                                    OR (s.[agent_time] = 0
                                                                                                        AND s.[inqueue_Time] &gt; 0
                                                                                                        AND s.[Abandon_Time] = 0
                                                                                                        AND s.[IsShortAbandon] = 0
                                                                                                        AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                     AND f.[INbound] = 'T')
                                                                                                                                                                                                    OR (s.[agent_time] = 0
                                                                                                                                                                                                        AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                        AND s.[Abandon_Time] = 0
                                                                                                                                                                                                        AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                        AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END</td>
        <td>189</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN 1 ELSE 0 END</td>
        <td>190</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END</td>
        <td>194</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (s.[Agent_Time] &gt; 0
           AND f.[INbound] = 'T')
          OR (s.[agent_time] = 0
              AND s.[inqueue_Time] &gt; 0
              AND s.[Abandon_Time] = 0
              AND s.[IsShortAbandon] = 0
              AND f.[INbound] = 'T') THEN 1 ELSE 0 END</td>
        <td>197</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN f.[INbound] = 'T' THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END</td>
        <td>202</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN f.[INbound] = 'F'
          AND f.[to_addr] NOT IN ('8665407270', '8772882020', '8002882020', '8008705855', '8662744357', '8002468464', '8666276093', '8006678934', '8882109153', '8777360730', '8008612974', '8885734107', '8664104511', '8664069596', '8003310500', '8005315000', '8002784388', '8888252557', '8662661292', '8662375249', '8885734147', '8002038600', '8889288932', '8882749056', '8885099399', '6019612954', '8883954654', '8008709582', '8665080898', '8009753902', '9723400023', '7136386948', '8772581427', '8777092027', '8668053921', '8669156188', '8668627221', '8006214533', '8005590050', '8777223755', '8883212375', '8663830076', '8882374554', '8003585982', '8886100680', '8886100727', '8007425877', '8667464694', '8663412662', '8773770415', '8665088290', '8664464115', '8666735963', '8773770414', '8887229337', '8669128216', '8003102355', '8665930724', '8887576500', '8666624548', '8775710223', '8006947466', '8885628662', '8772552377', '8003310500', '8669268262', '7873975332', '8888674384', '8667461081', '8008445175', '8008661514', '8162753420', '8664168166', '8664051373', '8663910749', '8665637634', '8889322324', '8664019271', '8883973742', '8885678688', '8004633339', '8778445584', '8664997888', '8884444410', '8009995445', '8888987685', '8669145787', '8778148977', '8002140825', '8664998008', '8772846828', '8009475096', '8662887629', '8668951099', '8008884213', '8007425877', '8002221811', '8008011101', '8009822084', '8668528617', '8774486767', '8008074205', '8002882020', '8772882020', '8662943464', '8005315000', '8662904236', '8883821222', '8777223755', '8883212375', '8667223425', '888 5734147', '8004385678', '8003310500', '8779991083', '8002468464', '8777372478', '8779991085', '8779990788', '8002038600', '8883006500', '8006356840', '8005470403', '8008677183', '8006497570', '8883411270') THEN s.[Agent_Seconds] - s.[ACW_Seconds] ELSE 0 END</td>
        <td>206</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN f.[INbound] = 'F'
          AND f.[to_addr] NOT IN ('8665407270', '8772882020', '8002882020', '8008705855', '8662744357', '8002468464', '8666276093', '8006678934', '8882109153', '8777360730', '8008612974', '8885734107', '8664104511', '8664069596', '8003310500', '8005315000', '8002784388', '8888252557', '8662661292', '8662375249', '8885734147', '8002038600', '8889288932', '8882749056', '8885099399', '6019612954', '8883954654', '8008709582', '8665080898', '8009753902', '9723400023', '7136386948', '8772581427', '8777092027', '8668053921', '8669156188', '8668627221', '8006214533', '8005590050', '8777223755', '8883212375', '8663830076', '8882374554', '8003585982', '8886100680', '8886100727', '8007425877', '8667464694', '8663412662', '8773770415', '8665088290', '8664464115', '8666735963', '8773770414', '8887229337', '8669128216', '8003102355', '8665930724', '8887576500', '8666624548', '8775710223', '8006947466', '8885628662', '8772552377', '8003310500', '8669268262', '7873975332', '8888674384', '8667461081', '8008445175', '8008661514', '8162753420', '8664168166', '8664051373', '8663910749', '8665637634', '8889322324', '8664019271', '8883973742', '8885678688', '8004633339', '8778445584', '8664997888', '8884444410', '8009995445', '8888987685', '8669145787', '8778148977', '8002140825', '8664998008', '8772846828', '8009475096', '8662887629', '8668951099', '8008884213', '8007425877', '8002221811', '8008011101', '8009822084', '8668528617', '8774486767', '8008074205', '8002882020', '8772882020', '8662943464', '8005315000', '8662904236', '8883821222', '8777223755', '8883212375', '8667223425', '888 5734147', '8004385678', '8003310500', '8779991083', '8002468464', '8777372478', '8779991085', '8779990788', '8002038600', '8883006500', '8006356840', '8005470403', '8008677183', '8006497570', '8883411270') THEN s.[ACW_Seconds] ELSE 0 END</td>
        <td>210</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN f.[INbound] = 'F'
          AND f.[to_addr] NOT IN ('8665407270', '8772882020', '8002882020', '8008705855', '8662744357', '8002468464', '8666276093', '8006678934', '8882109153', '8777360730', '8008612974', '8885734107', '8664104511', '8664069596', '8003310500', '8005315000', '8002784388', '8888252557', '8662661292', '8662375249', '8885734147', '8002038600', '8889288932', '8882749056', '8885099399', '6019612954', '8883954654', '8008709582', '8665080898', '8009753902', '9723400023', '7136386948', '8772581427', '8777092027', '8668053921', '8669156188', '8668627221', '8006214533', '8005590050', '8777223755', '8883212375', '8663830076', '8882374554', '8003585982', '8886100680', '8886100727', '8007425877', '8667464694', '8663412662', '8773770415', '8665088290', '8664464115', '8666735963', '8773770414', '8887229337', '8669128216', '8003102355', '8665930724', '8887576500', '8666624548', '8775710223', '8006947466', '8885628662', '8772552377', '8003310500', '8669268262', '7873975332', '8888674384', '8667461081', '8008445175', '8008661514', '8162753420', '8664168166', '8664051373', '8663910749', '8665637634', '8889322324', '8664019271', '8883973742', '8885678688', '8004633339', '8778445584', '8664997888', '8884444410', '8009995445', '8888987685', '8669145787', '8778148977', '8002140825', '8664998008', '8772846828', '8009475096', '8662887629', '8668951099', '8008884213', '8007425877', '8002221811', '8008011101', '8009822084', '8668528617', '8774486767', '8008074205', '8002882020', '8772882020', '8662943464', '8005315000', '8662904236', '8883821222', '8777223755', '8883212375', '8667223425', '888 5734147', '8004385678', '8003310500', '8779991083', '8002468464', '8777372478', '8779991085', '8779990788', '8002038600', '8883006500', '8006356840', '8005470403', '8008677183', '8006497570', '8883411270') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END</td>
        <td>214</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN f.[Inbound] = 'F'
          AND f.[to_addr] NOT IN ('8665407270', '8772882020', '8002882020', '8008705855', '8662744357', '8002468464', '8666276093', '8006678934', '8882109153', '8777360730', '8008612974', '8885734107', '8664104511', '8664069596', '8003310500', '8005315000', '8002784388', '8888252557', '8662661292', '8662375249', '8885734147', '8002038600', '8889288932', '8882749056', '8885099399', '6019612954', '8883954654', '8008709582', '8665080898', '8009753902', '9723400023', '7136386948', '8772581427', '8777092027', '8668053921', '8669156188', '8668627221', '8006214533', '8005590050', '8777223755', '8883212375', '8663830076', '8882374554', '8003585982', '8886100680', '8886100727', '8007425877', '8667464694', '8663412662', '8773770415', '8665088290', '8664464115', '8666735963', '8773770414', '8887229337', '8669128216', '8003102355', '8665930724', '8887576500', '8666624548', '8775710223', '8006947466', '8885628662', '8772552377', '8003310500', '8669268262', '7873975332', '8888674384', '8667461081', '8008445175', '8008661514', '8162753420', '8664168166', '8664051373', '8663910749', '8665637634', '8889322324', '8664019271', '8883973742', '8885678688', '8004633339', '8778445584', '8664997888', '8884444410', '8009995445', '8888987685', '8669145787', '8778148977', '8002140825', '8664998008', '8772846828', '8009475096', '8662887629', '8668951099', '8008884213', '8007425877', '8002221811', '8008011101', '8009822084', '8668528617', '8774486767', '8008074205', '8002882020', '8772882020', '8662943464', '8005315000', '8662904236', '8883821222', '8777223755', '8883212375', '8667223425', '888 5734147', '8004385678', '8003310500', '8779991083', '8002468464', '8777372478', '8779991085', '8779990788', '8002038600', '8883006500', '8006356840', '8005470403', '8008677183', '8006497570', '8883411270') THEN 1 ELSE 0 END</td>
        <td>219</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 1
          AND d.[Available] = 0
          AND d.[outstate_Code] = 0 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>261</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND ds.[IsACW] = 'T' THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>264</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (d.[Working] = 2
           AND d.[Available] = 0
           AND d.[outstate_Code] = 0) THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>267</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 1
          AND d.[outstate_Code] = 0 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>271</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] IN (51, 45, 170) THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>275</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] = 51 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>279</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] = 45 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>283</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] = 170 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>287</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] IN (47, 44, 50) THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>291</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] = 47 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>295</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] = 44 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>299</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] = 50 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>303</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] = 242 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>307</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] = 414 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>311</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] = 48 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>315</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] = 49 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>319</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] = 413 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>323</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] = 481 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>327</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] = 46 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>331</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 1
          AND d.[Available] = 0
          AND d.[outstate_Code] = 0 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>335</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 2
          AND d.[Available] = 0
          AND d.[outstate_Code] = 0 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>338</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND ds.[isACW] = 'T' THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>341</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 1
          AND d.[outstate_Code] = 0 THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>344</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] IN (51, 45, 170) THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>347</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] IN (47, 44, 50) THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>350</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN CAST (SUM(CASE WHEN (d.[Working] = 1
                               AND d.[Available] = 0
                               AND d.[outstate_Code] = 0)
                              OR (d.[Working] = 2
                                  AND d.[Available] = 0
                                  AND d.[outstate_Code] = 0)
                              OR (d.[Working] = 0
                                  AND d.[Available] = 0
                                  AND d.[outstate_Code] &lt;&gt; 0
                                  AND ds.[IsACW] = 'T')
                              OR (d.[Working] = 0
                                  AND d.[Available] = 1
                                  AND d.[outstate_Code] = 0)
                              OR (d.[Working] = 0
                                  AND d.[Available] = 0
                                  AND d.[outstate_Code] IN (51, 45, 170))
                              OR (d.[Working] = 0
                                  AND d.[Available] = 0
                                  AND d.[outstate_Code] = 50) THEN ds.[Duration_Seconds] ELSE 0 END) AS MONEY) * 100 &lt;= 0 THEN 0 ELSE (CAST (SUM(CASE WHEN (d.[Working] = 1
                                                                                                                                                            AND d.[Available] = 0
                                                                                                                                                            AND d.[outstate_Code] = 0)
                                                                                                                                                           OR (d.[Working] = 2
                                                                                                                                                               AND d.[Available] = 0
                                                                                                                                                               AND d.[outstate_Code] = 0)
                                                                                                                                                           OR (d.[Working] = 0
                                                                                                                                                               AND d.[Available] = 0
                                                                                                                                                               AND d.[outstate_Code] &lt;&gt; 0
                                                                                                                                                               AND ds.[IsACW] = 'T') THEN ds.[Duration_Seconds] ELSE 0 END) AS MONEY) / CAST (SUM(CASE WHEN (d.[Working] = 1
                                                                                                                                                                                                                                                             AND d.[Available] = 0
                                                                                                                                                                                                                                                             AND d.[outstate_Code] = 0)
                                                                                                                                                                                                                                                            OR (d.[Working] = 2
                                                                                                                                                                                                                                                                AND d.[Available] = 0
                                                                                                                                                                                                                                                                AND d.[outstate_Code] = 0)
                                                                                                                                                                                                                                                            OR (d.[Working] = 0
                                                                                                                                                                                                                                                                AND d.[Available] = 0
                                                                                                                                                                                                                                                                AND d.[outstate_Code] &lt;&gt; 0
                                                                                                                                                                                                                                                                AND ds.[IsACW] = 'T')
                                                                                                                                                                                                                                                            OR (d.[Working] = 0
                                                                                                                                                                                                                                                                AND d.[Available] = 1
                                                                                                                                                                                                                                                                AND d.[outstate_Code] = 0)
                                                                                                                                                                                                                                                            OR (d.[Working] = 0
                                                                                                                                                                                                                                                                AND d.[Available] = 0
                                                                                                                                                                                                                                                                AND d.[outstate_Code] IN (51, 45, 170))
                                                                                                                                                                                                                                                            OR (d.[Working] = 0
                                                                                                                                                                                                                                                                AND d.[Available] = 0
                                                                                                                                                                                                                                                                AND d.[outstate_Code] = 50) THEN ds.[Duration_Seconds] ELSE 0 END) AS MONEY)) * 100 END</td>
        <td>365</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (d.[Working] = 1
           AND d.[Available] = 0
           AND d.[outstate_Code] = 0)
          OR (d.[Working] = 2
              AND d.[Available] = 0
              AND d.[outstate_Code] = 0)
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] &lt;&gt; 0
              AND ds.[IsACW] = 'T')
          OR (d.[Working] = 0
              AND d.[Available] = 1
              AND d.[outstate_Code] = 0)
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] IN (51, 45, 170))
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] = 50) THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>366</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (d.[Working] = 1
           AND d.[Available] = 0
           AND d.[outstate_Code] = 0)
          OR (d.[Working] = 2
              AND d.[Available] = 0
              AND d.[outstate_Code] = 0)
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] &lt;&gt; 0
              AND ds.[IsACW] = 'T') THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>370</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (d.[Working] = 1
           AND d.[Available] = 0
           AND d.[outstate_Code] = 0)
          OR (d.[Working] = 2
              AND d.[Available] = 0
              AND d.[outstate_Code] = 0)
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] &lt;&gt; 0
              AND ds.[IsACW] = 'T')
          OR (d.[Working] = 0
              AND d.[Available] = 1
              AND d.[outstate_Code] = 0)
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] IN (51, 45, 170))
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] = 50) THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>373</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN CAST (SUM(CASE WHEN (d.[Working] = 1
                               AND d.[Available] = 0
                               AND d.[outstate_Code] = 0)
                              OR (d.[Working] = 2
                                  AND d.[Available] = 0
                                  AND d.[outstate_Code] = 0)
                              OR (d.[Working] = 0
                                  AND d.[Available] = 1
                                  AND d.[outstate_Code] = 0)
                              OR (d.[Working] = 0
                                  AND d.[Available] = 0
                                  AND d.[outstate_Code] &lt;&gt; 0
                                  AND ds.[IsACW] = 'T') THEN ds.[Duration_Seconds] ELSE 0 END) AS MONEY) * 100 &lt;= 0 THEN 0 ELSE (CAST (SUM(CASE WHEN (d.[Working] = 1
                                                                                                                                                      AND d.[Available] = 0
                                                                                                                                                      AND d.[outstate_Code] = 0)
                                                                                                                                                     OR (d.[Working] = 2
                                                                                                                                                         AND d.[Available] = 0
                                                                                                                                                         AND d.[outstate_Code] = 0)
                                                                                                                                                     OR (d.[Working] = 0
                                                                                                                                                         AND d.[Available] = 0
                                                                                                                                                         AND d.[outstate_Code] &lt;&gt; 0
                                                                                                                                                         AND ds.[IsACW] = 'T') THEN ds.[Duration_Seconds] ELSE 0 END) AS MONEY) / CAST (SUM(CASE WHEN (d.[Working] = 1
                                                                                                                                                                                                                                                       AND d.[Available] = 0
                                                                                                                                                                                                                                                       AND d.[outstate_Code] = 0)
                                                                                                                                                                                                                                                      OR (d.[Working] = 2
                                                                                                                                                                                                                                                          AND d.[Available] = 0
                                                                                                                                                                                                                                                          AND d.[outstate_Code] = 0)
                                                                                                                                                                                                                                                      OR (d.[Working] = 0
                                                                                                                                                                                                                                                          AND d.[Available] = 1
                                                                                                                                                                                                                                                          AND d.[outstate_Code] = 0)
                                                                                                                                                                                                                                                      OR (d.[Working] = 0
                                                                                                                                                                                                                                                          AND d.[Available] = 0
                                                                                                                                                                                                                                                          AND d.[outstate_Code] &lt;&gt; 0
                                                                                                                                                                                                                                                          AND ds.[IsACW] = 'T') THEN ds.[Duration_Seconds] ELSE 0 END) AS MONEY)) * 100 END</td>
        <td>378</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (d.[Working] = 1
           AND d.[Available] = 0
           AND d.[outstate_Code] = 0)
          OR (d.[Working] = 2
              AND d.[Available] = 0
              AND d.[outstate_Code] = 0)
          OR (d.[Working] = 0
              AND d.[Available] = 1
              AND d.[outstate_Code] = 0)
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] &lt;&gt; 0
              AND ds.[IsACW] = 'T') THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>379</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (d.[Working] = 1
           AND d.[Available] = 0
           AND d.[outstate_Code] = 0)
          OR (d.[Working] = 2
              AND d.[Available] = 0
              AND d.[outstate_Code] = 0)
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] &lt;&gt; 0
              AND ds.[IsACW] = 'T') THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>383</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (d.[Working] = 1
           AND d.[Available] = 0
           AND d.[outstate_Code] = 0)
          OR (d.[Working] = 2
              AND d.[Available] = 0
              AND d.[outstate_Code] = 0)
          OR (d.[Working] = 0
              AND d.[Available] = 1
              AND d.[outstate_Code] = 0)
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] &lt;&gt; 0
              AND ds.[IsACW] = 'T') THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>386</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN CAST (SUM(ds.[Duration_Seconds]) AS MONEY) * 100 &lt;= 0 THEN 0 ELSE (CAST (SUM(CASE WHEN (d.[Working] = 1
                                                                                                  AND d.[Available] = 0
                                                                                                  AND d.[outstate_Code] = 0)
                                                                                                 OR (d.[Working] = 2
                                                                                                     AND d.[Available] = 0
                                                                                                     AND d.[outstate_Code] = 0)
                                                                                                 OR d.[Working] = 0
                                                                                                    AND d.[Available] = 0
                                                                                                    AND d.[outstate_Code] IN (51, 45)
                                                                                                 OR (d.[Working] = 0
                                                                                                     AND d.[Available] = 0
                                                                                                     AND d.[outstate_Code] &lt;&gt; 0
                                                                                                     AND ds.[IsACW] = 'T') THEN ds.[Duration_Seconds] ELSE 0 END) AS MONEY) / CAST (SUM(ds.[Duration_Seconds]) AS MONEY)) * 100 END</td>
        <td>391</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (d.[Working] = 1
           AND d.[Available] = 0
           AND d.[outstate_Code] = 0)
          OR (d.[Working] = 2
              AND d.[Available] = 0
              AND d.[outstate_Code] = 0)
          OR d.[Working] = 0
             AND d.[Available] = 0
             AND d.[outstate_Code] IN (51, 45)
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] &lt;&gt; 0
              AND ds.[IsACW] = 'T') THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>393</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (d.[Working] = 1
           AND d.[Available] = 0
           AND d.[outstate_Code] = 0)
          OR (d.[Working] = 2
              AND d.[Available] = 0
              AND d.[outstate_Code] = 0)
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] &lt;&gt; 0
              AND ds.[IsACW] = 'T')
          OR (d.[Working] = 0
              AND d.[Available] = 1
              AND d.[outstate_Code] = 0)
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] IN (51, 45))
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] = 50) THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>399</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN SUM(CASE WHEN (d.[Working] = 1
                         AND d.[Available] = 0
                         AND d.[outstate_Code] = 0)
                        OR (d.[Working] = 2
                            AND d.[Available] = 0
                            AND d.[outstate_Code] = 0)
                        OR (d.[Working] = 0
                            AND d.[Available] = 0
                            AND d.[outstate_Code] &lt;&gt; 0
                            AND ds.[IsACW] = 'T')
                        OR (d.[Working] = 0
                            AND d.[Available] = 1
                            AND d.[outstate_Code] = 0)
                        OR (d.[Working] = 0
                            AND d.[Available] = 0
                            AND d.[outstate_Code] IN (51, 45, 170))
                        OR (d.[Working] = 0
                            AND d.[Available] = 0
                            AND d.[outstate_Code] = 50) THEN ds.[Duration_Seconds] ELSE 0 END) / 60 / 60 &lt;= 0 THEN 0 ELSE SUM(CASE WHEN (d.[Working] = 1
                                                                                                                                         AND d.[Available] = 0
                                                                                                                                         AND d.[outstate_Code] = 0) THEN 1 ELSE 0 END) / SUM(CASE WHEN (d.[Working] = 1
                                                                                                                                                                                                        AND d.[Available] = 0
                                                                                                                                                                                                        AND d.[outstate_Code] = 0)
                                                                                                                                                                                                       OR (d.[Working] = 2
                                                                                                                                                                                                           AND d.[Available] = 0
                                                                                                                                                                                                           AND d.[outstate_Code] = 0)
                                                                                                                                                                                                       OR (d.[Working] = 0
                                                                                                                                                                                                           AND d.[Available] = 0
                                                                                                                                                                                                           AND d.[outstate_Code] &lt;&gt; 0
                                                                                                                                                                                                           AND ds.[IsACW] = 'T')
                                                                                                                                                                                                       OR (d.[Working] = 0
                                                                                                                                                                                                           AND d.[Available] = 1
                                                                                                                                                                                                           AND d.[outstate_Code] = 0)
                                                                                                                                                                                                       OR (d.[Working] = 0
                                                                                                                                                                                                           AND d.[Available] = 0
                                                                                                                                                                                                           AND d.[outstate_Code] IN (51, 45, 170))
                                                                                                                                                                                                       OR (d.[Working] = 0
                                                                                                                                                                                                           AND d.[Available] = 0
                                                                                                                                                                                                           AND d.[outstate_Code] = 50) THEN ds.[Duration_Seconds] ELSE 0 END) / 60 / 60 END</td>
        <td>404</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (d.[Working] = 1
           AND d.[Available] = 0
           AND d.[outstate_Code] = 0)
          OR (d.[Working] = 2
              AND d.[Available] = 0
              AND d.[outstate_Code] = 0)
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] &lt;&gt; 0
              AND ds.[IsACW] = 'T')
          OR (d.[Working] = 0
              AND d.[Available] = 1
              AND d.[outstate_Code] = 0)
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] IN (51, 45, 170))
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] = 50) THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>405</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (d.[Working] = 1
           AND d.[Available] = 0
           AND d.[outstate_Code] = 0) THEN 1 ELSE 0 END</td>
        <td>409</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (d.[Working] = 1
           AND d.[Available] = 0
           AND d.[outstate_Code] = 0)
          OR (d.[Working] = 2
              AND d.[Available] = 0
              AND d.[outstate_Code] = 0)
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] &lt;&gt; 0
              AND ds.[IsACW] = 'T')
          OR (d.[Working] = 0
              AND d.[Available] = 1
              AND d.[outstate_Code] = 0)
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] IN (51, 45, 170))
          OR (d.[Working] = 0
              AND d.[Available] = 0
              AND d.[outstate_Code] = 50) THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>412</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] IN (47, 44, 50) THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>419</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.[Working] = 0
          AND d.[Available] = 0
          AND d.[outstate_Code] IN (47, 44, 50) THEN ds.[Duration_Seconds] ELSE 0 END</td>
        <td>423</td>
      </tr>
      <tr valign="top">
        <td colspan="1">REPLACE</td>
        <td colspan="1">REPLACE(STR(CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                     AND f.[INbound] = 'T')
                                    OR (s.[agent_time] = 0
                                        AND s.[inqueue_Time] &gt; 0
                                        AND s.[Abandon_Time] = 0
                                        AND s.[IsShortAbandon] = 0
                                        AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                 AND f.[INbound] = 'T')
                                                                                                                OR (s.[agent_time] = 0
                                                                                                                    AND s.[inqueue_Time] &gt; 0
                                                                                                                    AND s.[Abandon_Time] = 0
                                                                                                                    AND s.[IsShortAbandon] = 0
                                                                                                                    AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                 AND f.[INbound] = 'T')
                                                                                                                                                                                                                OR (s.[agent_time] = 0
                                                                                                                                                                                                                    AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                    AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                    AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                    AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END / 3600, LEN(LTRIM(CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                             AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                            OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                AND f.[inbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                         AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                        OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                            AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                            AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                            AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                            AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END / 3600)) + ABS(SIGN(CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      AND f.INbound = 'T') THEN 1 ELSE 0 END) END / 359999) - 1)) + ':' + STR((CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END / 60) % 60, 2) + ':' + STR(CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END % 60, 2), ' ', '0')</td>
        <td>141</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">STR</td>
        <td colspan="1">STR(CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                             AND f.[INbound] = 'T')
                            OR (s.[agent_time] = 0
                                AND s.[inqueue_Time] &gt; 0
                                AND s.[Abandon_Time] = 0
                                AND s.[IsShortAbandon] = 0
                                AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                         AND f.[INbound] = 'T')
                                                                                                        OR (s.[agent_time] = 0
                                                                                                            AND s.[inqueue_Time] &gt; 0
                                                                                                            AND s.[Abandon_Time] = 0
                                                                                                            AND s.[IsShortAbandon] = 0
                                                                                                            AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                         AND f.[INbound] = 'T')
                                                                                                                                                                                                        OR (s.[agent_time] = 0
                                                                                                                                                                                                            AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                            AND s.[Abandon_Time] = 0
                                                                                                                                                                                                            AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                            AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END / 3600, LEN(LTRIM(CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                     AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                    OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                        AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                        AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                        AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                        AND f.[inbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                 AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                    AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                    AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                    AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                    AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END / 3600)) + ABS(SIGN(CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           AND f.[INbound] = 'T')
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          OR (s.[agent_time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              AND s.[Abandon_Time] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              AND f.INbound = 'T') THEN 1 ELSE 0 END) END / 359999) - 1))</td>
        <td>141</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">STR((CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                              AND f.[INbound] = 'T')
                             OR (s.[agent_time] = 0
                                 AND s.[inqueue_Time] &gt; 0
                                 AND s.[Abandon_Time] = 0
                                 AND s.[IsShortAbandon] = 0
                                 AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                          AND f.[INbound] = 'T')
                                                                                                         OR (s.[agent_time] = 0
                                                                                                             AND s.[inqueue_Time] &gt; 0
                                                                                                             AND s.[Abandon_Time] = 0
                                                                                                             AND s.[IsShortAbandon] = 0
                                                                                                             AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                          AND f.[INbound] = 'T')
                                                                                                                                                                                                         OR (s.[agent_time] = 0
                                                                                                                                                                                                             AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                             AND s.[Abandon_Time] = 0
                                                                                                                                                                                                             AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                             AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END / 60) % 60, 2)</td>
        <td>177</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">STR(CASE WHEN SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                             AND f.[INbound] = 'T')
                            OR (s.[agent_time] = 0
                                AND s.[inqueue_Time] &gt; 0
                                AND s.[Abandon_Time] = 0
                                AND s.[IsShortAbandon] = 0
                                AND f.[INbound] = 'T') THEN 1 ELSE 0 END) = 0 THEN 0 ELSE SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                         AND f.[INbound] = 'T')
                                                                                                        OR (s.[agent_time] = 0
                                                                                                            AND s.[inqueue_Time] &gt; 0
                                                                                                            AND s.[Abandon_Time] = 0
                                                                                                            AND s.[IsShortAbandon] = 0
                                                                                                            AND f.[INbound] = 'T') THEN s.[Agent_Seconds] + s.[ACW_Seconds] ELSE 0 END) / SUM(CASE WHEN (s.[Agent_Time] &gt; 0
                                                                                                                                                                                                         AND f.[INbound] = 'T')
                                                                                                                                                                                                        OR (s.[agent_time] = 0
                                                                                                                                                                                                            AND s.[inqueue_Time] &gt; 0
                                                                                                                                                                                                            AND s.[Abandon_Time] = 0
                                                                                                                                                                                                            AND s.[IsShortAbandon] = 0
                                                                                                                                                                                                            AND f.[INbound] = 'T') THEN 1 ELSE 0 END) END % 60, 2)</td>
        <td>189</td>
      </tr>
      <tr valign="top">
        <td colspan="1">COMMIT TRANSACTION</td>
        <td colspan="1">COMMIT TRANSACTION</td>
        <td>508</td>
      </tr>
    </table>
  </body>
</html>