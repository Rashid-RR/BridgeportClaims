<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeFactInvitation]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeFactInvitation]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:11 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO dbo.FactInvitation
 AS target
USING #DWETLTable AS source ON (target.InvitationID = source.InvitationID
                                AND target.BusNo = source.BusNo)
WHEN MATCHED AND target.IsInferred = 1 THEN UPDATE 
SET BusNo             = source.BusNo,
    SurveyKey         = source.SurveyKey,
    AgentKey          = source.AgentKey,
    InvitationID      = source.InvitationID,
    SentDate          = source.SentDate,
    RespondentContact = source.RespondentContact,
    FirstName         = source.FirstName,
    MiddleName        = source.MiddleName,
    LastName          = source.LastName,
    ContactID         = source.ContactID,
    IsInferred        = 0,
    SurveyID          = source.SurveyID,
    AgentNo           = source.AgentNo
WHEN NOT MATCHED THEN INSERT (BusNo, SurveyKey, AgentKey, InvitationID, SentDate, RespondentContact, FirstName, MiddleName, LastName, ContactID, SurveyID, AgentNo) VALUES (BusNo, SurveyKey, AgentKey, InvitationID, SentDate, RespondentContact, FirstName, MiddleName, LastName, ContactID, SurveyID, AgentNo)</td>
        <td>4</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO dbo.FactInvitation
 AS target
USING #DWETLTable AS source ON (target.InvitationID = source.InvitationID
                                AND target.BusNo = source.BusNo)
WHEN MATCHED AND target.IsInferred = 1 THEN UPDATE 
SET BusNo             = source.BusNo,
    SurveyKey         = source.SurveyKey,
    AgentKey          = source.AgentKey,
    InvitationID      = source.InvitationID,
    SentDate          = source.SentDate,
    RespondentContact = source.RespondentContact,
    FirstName         = source.FirstName,
    MiddleName        = source.MiddleName,
    LastName          = source.LastName,
    ContactID         = source.ContactID,
    IsInferred        = 0,
    SurveyID          = source.SurveyID,
    AgentNo           = source.AgentNo
WHEN NOT MATCHED THEN INSERT (BusNo, SurveyKey, AgentKey, InvitationID, SentDate, RespondentContact, FirstName, MiddleName, LastName, ContactID, SurveyID, AgentNo) VALUES (BusNo, SurveyKey, AgentKey, InvitationID, SentDate, RespondentContact, FirstName, MiddleName, LastName, ContactID, SurveyID, AgentNo)</td>
        <td>4</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">#DWETLTable AS source</td>
        <td>5</td>
      </tr>
    </table>
  </body>
</html>