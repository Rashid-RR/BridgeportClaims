<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[API_Contact_GetDetailsByIdV6]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[API_Contact_GetDetailsByIdV6]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:10 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>1</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE clh.ReskillIndicator WHEN 4 THEN 1 ELSE 0 END</td>
        <td>33</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE clf.Abandon WHEN 'Y' THEN CONVERT (BIT, 1) ELSE CONVERT (BIT, 0) END</td>
        <td>107</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">APPLY</td>
        <td colspan="1">dbo.contact_log_header AS clh
INNER JOIN
(SELECT 1 AS IsActive,
        Contact_Id,
        Skill_No,
        Campaign_no,
        Agent_No,
        to_addr,
        from_addr,
        current_contact_state,
        current_contact_date,
        TargetAgent_no,
        NULL AS [FileNAme],
        0 AS Abandon
 FROM   dbo.Rt_Contact_Log
 WHERE  Contact_Id = @ContactId
 UNION ALL
 SELECT 1 AS IsActive,
        Contact_Id,
        Skill_No,
        Campaign_no,
        Agent_No,
        to_addr,
        from_addr,
        current_contact_state,
        current_contact_date,
        TargetAgent_no,
        [FileNAme],
        0 AS Abandon
 FROM   dbo.PersistentContactLog
 WHERE  Contact_Id = @ContactId
 UNION ALL
 SELECT 0 AS IsActive,
        clf.Contact_Id,
        clf.Skill_No,
        clf.Campaign_No,
        clf.Agent_No,
        clf.to_addr,
        clf.from_addr,
        dtl.contact_state AS current_contact_state,
        clf.End_Date AS current_contact_date,
        NULL AS TargetAgent_no,
        NULL AS [FileNAme],
        CASE clf.Abandon WHEN 'Y' THEN CONVERT (BIT, 1) ELSE CONVERT (BIT, 0) END AS Abandon
 FROM   dbo.Contact_Log_Footer AS clf CROSS APPLY (SELECT   TOP 1 contact_state
                                                   FROM     contact_log_detail AS det
                                                   WHERE    det.contact_id = @ContactId
                                                   ORDER BY StateIndex DESC) AS dtl
 WHERE  clf.Contact_Id = @ContactId) AS ac
ON clh.contact_id = ac.contact_id
INNER JOIN
dbo.contact_state AS cs
ON cs.contact_state = ac.current_contact_state
LEFT OUTER JOIN
dbo.contact_log_summary AS cls
ON cls.contact_id = clh.contact_id
LEFT OUTER JOIN
dbo.contact_log_dispositions AS d
ON d.contact_id = clh.contact_id
LEFT OUTER JOIN
dbo.skills AS k
ON k.skill_no = ac.skill_no
LEFT OUTER JOIN
dbo.agents AS a
ON a.agent_no = ac.agent_no OUTER APPLY (SELECT   TOP 1 Contact_ID,
                                                        reason,
                                                        refuse_time
                                         FROM     refusedcontactlog AS rcl
                                         WHERE    rcl.Contact_Id = @ContactId
                                         ORDER BY rcl.RefusedContactlogID DESC) AS r</td>
        <td>63</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">dbo.Contact_Log_Footer AS clf CROSS APPLY (SELECT   TOP 1 contact_state
                                           FROM     contact_log_detail AS det
                                           WHERE    det.contact_id = @ContactId
                                           ORDER BY StateIndex DESC) AS dtl</td>
        <td>111</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">contact_log_detail AS det</td>
        <td>114</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">refusedcontactlog AS rcl</td>
        <td>132</td>
      </tr>
    </table>
  </body>
</html>