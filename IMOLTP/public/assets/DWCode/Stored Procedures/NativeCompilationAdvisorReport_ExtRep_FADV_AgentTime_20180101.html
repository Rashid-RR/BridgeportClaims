<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[ExtRep_FADV_AgentTime]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[ExtRep_FADV_AgentTime]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:10 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT h.Agent_Session_ID AS sequence_no,
       h.agent_no,
       h.team_no,
       h.start_date AS login_date,
       s.End_Date AS logoff_date,
       s.Duration_Seconds AS Duration
INTO   #dw_agent_timecard
FROM   dbo.Agent_Log_Header AS h
       INNER JOIN
       dbo.Agent_Log_Summary AS s
       ON h.Agent_Session_ID = s.Agent_Session_ID
WHERE  h.bus_no = @Bus_No
       AND h.start_date BETWEEN @start_date AND @end_date
       AND s.end_date BETWEEN @start_date AND @end_date</td>
        <td>7</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT h.Agent_Session_ID,
       d.StateIndex,
       h.agent_no,
       h.team_no,
       h.bus_no,
       d.start_date,
       d.working,
       d.available,
       d.outstate_code,
       s.duration,
       d.log_state,
       d.skill_no,
       (CASE WHEN d.working IN (1, 2, 3, 4) THEN d.working WHEN d.working = 0 THEN (CASE WHEN d.available = 1 THEN d.working WHEN (d.outstate_code &gt; -1)
                                                                                                                                  AND (d.outstate_code &lt; 10) THEN 3 ELSE d.outstate_code END) END) AS State_Code
INTO   #dw_agent_log
FROM   dbo.Agent_Log_Header AS h
       LEFT OUTER JOIN
       dbo.Agent_Log_Detail AS d
       ON d.Agent_Session_ID = h.Agent_Session_ID
       LEFT OUTER JOIN
       dbo.Agent_Log_Detail_Summary AS s
       ON s.Agent_Session_ID = d.Agent_Session_ID
          AND s.StateIndex = d.StateIndex
WHERE  h.bus_no = @Bus_No
       AND h.start_date BETWEEN @start_date AND @end_date</td>
        <td>20</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN d.working IN (1, 2, 3, 4) THEN d.working WHEN d.working = 0 THEN (CASE WHEN d.available = 1 THEN d.working WHEN (d.outstate_code &gt; -1)
                                                                                                                          AND (d.outstate_code &lt; 10) THEN 3 ELSE d.outstate_code END) END</td>
        <td>32</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.available = 1 THEN d.working WHEN (d.outstate_code &gt; -1)
                                              AND (d.outstate_code &lt; 10) THEN 3 ELSE d.outstate_code END</td>
        <td>33</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Available = 1
          AND Working = 0 THEN Duration ELSE 0 END</td>
        <td>70</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN S.Outbound_Skill = 0
          AND Working IN (1, 2, 3, 4) THEN Duration ELSE 0 END</td>
        <td>74</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN S.Outbound_Skill = 1
          AND Working IN (1, 2, 3, 4) THEN Duration ELSE 0 END</td>
        <td>78</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN State_Code IN (500243, 500247) THEN Duration ELSE 0 END</td>
        <td>82</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN State_Code IN (500553, 500560) THEN Duration ELSE 0 END</td>
        <td>85</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN Working IN (1, 2, 3, 4) THEN Duration ELSE 0 END</td>
        <td>88</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN S.Outbound_Skill = 0 THEN 1 ELSE 0 END</td>
        <td>98</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN S.Outbound_Skill = 1 THEN 1 ELSE 0 END</td>
        <td>101</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">#dw_agent_timecard AS TC</td>
        <td>67</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dw_agent_log AS L</td>
        <td>91</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">LIKE</td>
        <td colspan="1">@team LIKE '%,' + CONVERT (NVARCHAR, t.team_no) + ',%'</td>
        <td>114</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@agent LIKE '%,' + CONVERT (NVARCHAR, a.agent_no) + ',%'</td>
        <td>118</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">MAXDOP</td>
        <td colspan="1">MAXDOP 2</td>
        <td>131</td>
      </tr>
    </table>
  </body>
</html>