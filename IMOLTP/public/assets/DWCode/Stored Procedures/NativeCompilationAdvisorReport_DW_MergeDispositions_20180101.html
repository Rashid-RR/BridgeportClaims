<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeDispositions]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeDispositions]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:11 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO [dbo].[Dispositions]
 AS target
USING [ETL].[Dispositions] AS source ON (target.Disposition_Code = source.Disposition_Code)
WHEN MATCHED AND source.ActionID = 0 THEN DELETE
WHEN MATCHED AND source.ActionID IN (1, 2, 3) THEN UPDATE 
SET Bus_No                      = source.Bus_No,
    Description                 = source.Description,
    Status                      = source.Status,
    Mod_DateTime                = source.Mod_DateTime,
    LongDescription             = source.LongDescription,
    Notes                       = source.Notes,
    asciiDescription            = source.asciiDescription,
    CreatedBy                   = source.CreatedBy,
    CreatedDate                 = source.CreatedDate,
    ModifiedBy                  = source.ModifiedBy,
    DispositionClassificationID = source.DispositionClassificationID,
    DialerAgentOutcomeID        = source.DialerAgentOutcomeID,
    DialerAgentOutcomeName      = source.DialerAgentOutcomeName,
    IsPreviewDisposition        = source.IsPreviewDisposition
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (Disposition_Code, Bus_No, Description, Status, Mod_DateTime, LongDescription, Notes, asciiDescription, CreatedBy, CreatedDate, ModifiedBy, DispositionClassificationID, DialerAgentOutcomeID, DialerAgentOutcomeName, IsPreviewDisposition) VALUES (source.Disposition_Code, source.Bus_No, source.Description, source.Status, source.Mod_DateTime, source.LongDescription, source.Notes, source.asciiDescription, source.CreatedBy, source.CreatedDate, source.ModifiedBy, source.DispositionClassificationID, source.DialerAgentOutcomeID, source.DialerAgentOutcomeName, source.IsPreviewDisposition)</td>
        <td>5</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [dbo].[Dispositions]
 AS target
USING [ETL].[Dispositions] AS source ON (target.Disposition_Code = source.Disposition_Code)
WHEN MATCHED AND source.ActionID = 0 THEN DELETE
WHEN MATCHED AND source.ActionID IN (1, 2, 3) THEN UPDATE 
SET Bus_No                      = source.Bus_No,
    Description                 = source.Description,
    Status                      = source.Status,
    Mod_DateTime                = source.Mod_DateTime,
    LongDescription             = source.LongDescription,
    Notes                       = source.Notes,
    asciiDescription            = source.asciiDescription,
    CreatedBy                   = source.CreatedBy,
    CreatedDate                 = source.CreatedDate,
    ModifiedBy                  = source.ModifiedBy,
    DispositionClassificationID = source.DispositionClassificationID,
    DialerAgentOutcomeID        = source.DialerAgentOutcomeID,
    DialerAgentOutcomeName      = source.DialerAgentOutcomeName,
    IsPreviewDisposition        = source.IsPreviewDisposition
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (Disposition_Code, Bus_No, Description, Status, Mod_DateTime, LongDescription, Notes, asciiDescription, CreatedBy, CreatedDate, ModifiedBy, DispositionClassificationID, DialerAgentOutcomeID, DialerAgentOutcomeName, IsPreviewDisposition) VALUES (source.Disposition_Code, source.Bus_No, source.Description, source.Status, source.Mod_DateTime, source.LongDescription, source.Notes, source.asciiDescription, source.CreatedBy, source.CreatedDate, source.ModifiedBy, source.DispositionClassificationID, source.DialerAgentOutcomeID, source.DialerAgentOutcomeName, source.IsPreviewDisposition)</td>
        <td>5</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [Staging].[Dispositions]
 AS target
USING [ETL].[Dispositions] AS source ON (target.Disposition_Code = source.Disposition_Code)
WHEN MATCHED THEN UPDATE 
SET ActionID               = source.ActionID,
    Bus_No                 = CASE WHEN source.ActionID = 0 THEN target.Bus_No ELSE source.Bus_No END,
    Description            = CASE WHEN source.ActionID = 0 THEN target.Description ELSE source.Description END,
    Status                 = CASE WHEN source.ActionID = 0 THEN target.Status ELSE source.Status END,
    Mod_DateTime           = CASE WHEN source.ActionID = 0 THEN target.Mod_DateTime ELSE source.Mod_DateTime END,
    LongDescription        = CASE WHEN source.ActionID = 0 THEN target.LongDescription ELSE source.LongDescription END,
    Notes                  = CASE WHEN source.ActionID = 0 THEN target.Notes ELSE source.Notes END,
    asciiDescription       = CASE WHEN source.ActionID = 0 THEN target.asciiDescription ELSE source.asciiDescription END,
    CreatedBy              = CASE WHEN source.ActionID = 0 THEN target.CreatedBy ELSE source.CreatedBy END,
    CreatedDate            = CASE WHEN source.ActionID = 0 THEN target.CreatedDate ELSE source.CreatedDate END,
    ModifiedBy             = CASE WHEN source.ActionID = 0 THEN target.ModifiedBy ELSE source.ModifiedBy END,
    DialerAgentOutcomeID   = CASE WHEN source.ActionID = 0 THEN target.DialerAgentOutcomeID ELSE source.DialerAgentOutcomeID END,
    DialerAgentOutcomeName = CASE WHEN source.ActionID = 0 THEN target.DialerAgentOutcomeName ELSE source.DialerAgentOutcomeName END
WHEN NOT MATCHED THEN INSERT (ActionID, Disposition_Code, Bus_No, Description, Status, Mod_DateTime, LongDescription, Notes, asciiDescription, CreatedBy, CreatedDate, ModifiedBy, DialerAgentOutcomeID, DialerAgentOutcomeName) VALUES (source.ActionID, source.Disposition_Code, source.Bus_No, source.Description, source.Status, source.Mod_DateTime, source.LongDescription, source.Notes, source.asciiDescription, source.CreatedBy, source.CreatedDate, source.ModifiedBy, source.DialerAgentOutcomeID, source.DialerAgentOutcomeName)</td>
        <td>80</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [Staging].[Dispositions]
 AS target
USING [ETL].[Dispositions] AS source ON (target.Disposition_Code = source.Disposition_Code)
WHEN MATCHED THEN UPDATE 
SET ActionID               = source.ActionID,
    Bus_No                 = CASE WHEN source.ActionID = 0 THEN target.Bus_No ELSE source.Bus_No END,
    Description            = CASE WHEN source.ActionID = 0 THEN target.Description ELSE source.Description END,
    Status                 = CASE WHEN source.ActionID = 0 THEN target.Status ELSE source.Status END,
    Mod_DateTime           = CASE WHEN source.ActionID = 0 THEN target.Mod_DateTime ELSE source.Mod_DateTime END,
    LongDescription        = CASE WHEN source.ActionID = 0 THEN target.LongDescription ELSE source.LongDescription END,
    Notes                  = CASE WHEN source.ActionID = 0 THEN target.Notes ELSE source.Notes END,
    asciiDescription       = CASE WHEN source.ActionID = 0 THEN target.asciiDescription ELSE source.asciiDescription END,
    CreatedBy              = CASE WHEN source.ActionID = 0 THEN target.CreatedBy ELSE source.CreatedBy END,
    CreatedDate            = CASE WHEN source.ActionID = 0 THEN target.CreatedDate ELSE source.CreatedDate END,
    ModifiedBy             = CASE WHEN source.ActionID = 0 THEN target.ModifiedBy ELSE source.ModifiedBy END,
    DialerAgentOutcomeID   = CASE WHEN source.ActionID = 0 THEN target.DialerAgentOutcomeID ELSE source.DialerAgentOutcomeID END,
    DialerAgentOutcomeName = CASE WHEN source.ActionID = 0 THEN target.DialerAgentOutcomeName ELSE source.DialerAgentOutcomeName END
WHEN NOT MATCHED THEN INSERT (ActionID, Disposition_Code, Bus_No, Description, Status, Mod_DateTime, LongDescription, Notes, asciiDescription, CreatedBy, CreatedDate, ModifiedBy, DialerAgentOutcomeID, DialerAgentOutcomeName) VALUES (source.ActionID, source.Disposition_Code, source.Bus_No, source.Description, source.Status, source.Mod_DateTime, source.LongDescription, source.Notes, source.asciiDescription, source.CreatedBy, source.CreatedDate, source.ModifiedBy, source.DialerAgentOutcomeID, source.DialerAgentOutcomeName)</td>
        <td>80</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Bus_No ELSE source.Bus_No END</td>
        <td>92</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Description ELSE source.Description END</td>
        <td>93</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Status ELSE source.Status END</td>
        <td>94</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Mod_DateTime ELSE source.Mod_DateTime END</td>
        <td>95</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.LongDescription ELSE source.LongDescription END</td>
        <td>96</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.Notes ELSE source.Notes END</td>
        <td>97</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.asciiDescription ELSE source.asciiDescription END</td>
        <td>98</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.CreatedBy ELSE source.CreatedBy END</td>
        <td>99</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.CreatedDate ELSE source.CreatedDate END</td>
        <td>100</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.ModifiedBy ELSE source.ModifiedBy END</td>
        <td>101</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.DialerAgentOutcomeID ELSE source.DialerAgentOutcomeID END</td>
        <td>102</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN source.ActionID = 0 THEN target.DialerAgentOutcomeName ELSE source.DialerAgentOutcomeName END</td>
        <td>103</td>
      </tr>
    </table>
  </body>
</html>