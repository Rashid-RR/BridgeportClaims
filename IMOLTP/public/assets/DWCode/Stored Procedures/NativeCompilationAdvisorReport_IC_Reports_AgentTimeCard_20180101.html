<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[IC_Reports_AgentTimeCard]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[IC_Reports_AgentTimeCard]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:10 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">BEGIN TRANSACTION</td>
        <td colspan="1">BEGIN TRANSACTION</td>
        <td>5</td>
      </tr>
      <tr valign="top">
        <td colspan="1">One-part names</td>
        <td colspan="1">EXECUTE LockCriticalSection @busno_str</td>
        <td>9</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#Agent_Log_Detail_Sessions</td>
        <td>68</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#tempTblSecurity AS sec</td>
        <td>99</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT DISTINCT w.EntityID,
                w.ViewAllAndFuture,
                w.SecurityProfileID
INTO   #tempTblSecurity
FROM   dbo.Security_DataRoles AS w
       INNER JOIN
       dbo.Security_DataRoleEntityTypes AS r
       ON (w.DataRoleEntityTypeID = r.DataRoleEntityTypeID)
WHERE  w.SecurityProfileID = @ProfileID
       AND r.DataRoleEntityTypeName = 'teams'</td>
        <td>22</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT DISTINCT ald.Agent_Session_ID
INTO   #Agent_Log_Detail_Sessions
FROM   dbo.Agent_Log_Detail AS ald
WHERE  ald.Bus_No = @Bus_No
       AND ((ald.[Header_Start_Date] BETWEEN @StartDate AND @EndDate)
            OR (ald.[start_date] BETWEEN @StartDate AND @EndDate))</td>
        <td>42</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT   ald.Agent_Session_ID,
         ald.Agent_No,
         ald.HeaderStartDate,
         SUM(ald.Duration) AS Duration
INTO     #Agent_Log_DetailQV_Sessions_Summarized
FROM     dbo.Agent_Log_DetailQV AS ald
WHERE    ald.[Bus_No] = @Bus_No
         AND ald.Agent_Session_ID IN (SELECT Agent_Session_ID
                                      FROM   #Agent_Log_Detail_Sessions)
GROUP BY ald.Agent_Session_ID, ald.Agent_No, ald.HeaderStartDate
OPTION (RECOMPILE, FORCE ORDER, QUERYTRACEON 9481)</td>
        <td>60</td>
      </tr>
      <tr valign="top">
        <td colspan="1">RECOMPILE</td>
        <td colspan="1">RECOMPILE</td>
        <td>-1</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">RECOMPILE</td>
        <td>-1</td>
      </tr>
      <tr valign="top">
        <td colspan="1">QUERY TRACE ON</td>
        <td colspan="1">QUERYTRACEON 9481</td>
        <td>73</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">QUERYTRACEON 9481</td>
        <td>115</td>
      </tr>
      <tr valign="top">
        <td colspan="1">Table-valued functions</td>
        <td colspan="1">dbo.fn_SplitOptionalInt(@TeamNoList) AS tks</td>
        <td>100</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">dbo.fn_SplitOptionalInt(@AgentNoList) AS aks</td>
        <td>101</td>
      </tr>
      <tr valign="top">
        <td colspan="1">COMMIT TRANSACTION</td>
        <td colspan="1">COMMIT TRANSACTION</td>
        <td>127</td>
      </tr>
    </table>
  </body>
</html>