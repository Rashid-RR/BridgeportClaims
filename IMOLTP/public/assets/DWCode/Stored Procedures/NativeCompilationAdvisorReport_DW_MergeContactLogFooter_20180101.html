<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeContactLogFooter]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeContactLogFooter]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:11 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO [dbo].[Contact_Log_Footer]
 AS target
USING [ETL].[Contact_Log_Footer] AS source ON (target.Contact_Id = source.Contact_Id)
WHEN MATCHED AND source.ActionID IN (1, 2, 3)
                 AND (source.lastTouched &gt; target.lastTouched
                      OR target.lastTouched IS NULL) THEN UPDATE 
SET Skill_No               = source.Skill_No,
    Campaign_no            = source.Campaign_no,
    Agent_No               = source.Agent_No,
    Team_No                = source.Team_No,
    End_Date               = source.End_Date,
    Abandon                = source.Abandon,
    to_addr                = source.to_addr,
    from_addr              = source.from_addr,
    bus_no                 = source.bus_no,
    Final_Contact_Type     = source.Final_Contact_Type,
    CauseCode              = source.CauseCode,
    CallFailure_CategoryID = source.CallFailure_CategoryID,
    Header_Start_Date      = source.Header_Start_Date,
    TtsMilliseconds        = source.TtsMilliseconds,
    TtsCacheMilliseconds   = source.TtsCacheMilliseconds,
    TtsVoiceIndex          = source.TtsVoiceIndex,
    AsrMilliseconds        = source.AsrMilliseconds,
    AsrLanguageLocale      = source.AsrLanguageLocale,
    ContactEndReasonId     = source.ContactEndReasonId,
    FailOverCount          = source.FailOverCount,
    lastTouched            = source.lastTouched,
    PrequeueAbandon        = source.PrequeueAbandon,
    AnalyticsProcessedDate = source.AnalyticsProcessedDate
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (Contact_Id, Skill_No, Campaign_no, Agent_No, Team_No, End_Date, Abandon, to_addr, from_addr, bus_no, Final_Contact_Type, CauseCode, CallFailure_CategoryID, Header_Start_Date, TtsMilliseconds, TtsCacheMilliseconds, TtsVoiceIndex, AsrMilliseconds, AsrLanguageLocale, ContactEndReasonId, FailOverCount, lastTouched, PrequeueAbandon, AnalyticsProcessedDate) VALUES (source.Contact_Id, source.Skill_No, source.Campaign_no, source.Agent_No, source.Team_No, source.End_Date, source.Abandon, source.to_addr, source.from_addr, source.bus_no, source.Final_Contact_Type, source.CauseCode, source.CallFailure_CategoryID, source.Header_Start_Date, source.TtsMilliseconds, source.TtsCacheMilliseconds, source.TtsVoiceIndex, source.AsrMilliseconds, source.AsrLanguageLocale, source.ContactEndReasonId, source.FailOverCount, source.lastTouched, source.PrequeueAbandon, source.AnalyticsProcessedDate)</td>
        <td>5</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [dbo].[Contact_Log_Footer]
 AS target
USING [ETL].[Contact_Log_Footer] AS source ON (target.Contact_Id = source.Contact_Id)
WHEN MATCHED AND source.ActionID IN (1, 2, 3)
                 AND (source.lastTouched &gt; target.lastTouched
                      OR target.lastTouched IS NULL) THEN UPDATE 
SET Skill_No               = source.Skill_No,
    Campaign_no            = source.Campaign_no,
    Agent_No               = source.Agent_No,
    Team_No                = source.Team_No,
    End_Date               = source.End_Date,
    Abandon                = source.Abandon,
    to_addr                = source.to_addr,
    from_addr              = source.from_addr,
    bus_no                 = source.bus_no,
    Final_Contact_Type     = source.Final_Contact_Type,
    CauseCode              = source.CauseCode,
    CallFailure_CategoryID = source.CallFailure_CategoryID,
    Header_Start_Date      = source.Header_Start_Date,
    TtsMilliseconds        = source.TtsMilliseconds,
    TtsCacheMilliseconds   = source.TtsCacheMilliseconds,
    TtsVoiceIndex          = source.TtsVoiceIndex,
    AsrMilliseconds        = source.AsrMilliseconds,
    AsrLanguageLocale      = source.AsrLanguageLocale,
    ContactEndReasonId     = source.ContactEndReasonId,
    FailOverCount          = source.FailOverCount,
    lastTouched            = source.lastTouched,
    PrequeueAbandon        = source.PrequeueAbandon,
    AnalyticsProcessedDate = source.AnalyticsProcessedDate
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (Contact_Id, Skill_No, Campaign_no, Agent_No, Team_No, End_Date, Abandon, to_addr, from_addr, bus_no, Final_Contact_Type, CauseCode, CallFailure_CategoryID, Header_Start_Date, TtsMilliseconds, TtsCacheMilliseconds, TtsVoiceIndex, AsrMilliseconds, AsrLanguageLocale, ContactEndReasonId, FailOverCount, lastTouched, PrequeueAbandon, AnalyticsProcessedDate) VALUES (source.Contact_Id, source.Skill_No, source.Campaign_no, source.Agent_No, source.Team_No, source.End_Date, source.Abandon, source.to_addr, source.from_addr, source.bus_no, source.Final_Contact_Type, source.CauseCode, source.CallFailure_CategoryID, source.Header_Start_Date, source.TtsMilliseconds, source.TtsCacheMilliseconds, source.TtsVoiceIndex, source.AsrMilliseconds, source.AsrLanguageLocale, source.ContactEndReasonId, source.FailOverCount, source.lastTouched, source.PrequeueAbandon, source.AnalyticsProcessedDate)</td>
        <td>5</td>
      </tr>
    </table>
  </body>
</html>