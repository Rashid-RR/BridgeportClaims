<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeSurveyInvitations]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeSurveyInvitations]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:09 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO [dbo].[SurveyInvitations]
 AS target
USING [ETL].[SurveyInvitations] AS source ON (target.SurveyInvitationID = source.SurveyInvitationID)
WHEN MATCHED AND source.ActionID = 0 THEN DELETE
WHEN MATCHED AND source.ActionID IN (1, 2, 3) THEN UPDATE 
SET bus_no                 = source.bus_no,
    SurveyID               = source.SurveyID,
    SurveyInvitationGUID   = source.SurveyInvitationGUID,
    FirstName              = source.FirstName,
    LastName               = source.LastName,
    MiddleName             = source.MiddleName,
    Email                  = source.Email,
    SentAt                 = source.SentAt,
    CreateDate             = source.CreateDate,
    UpdateDate             = source.UpdateDate,
    CreatedBy              = source.CreatedBy,
    UpdatedBy              = source.UpdatedBy,
    SurveyInvitationFileID = source.SurveyInvitationFileID,
    ImportStatusDetails    = source.ImportStatusDetails,
    ImportedSurveyID       = source.ImportedSurveyID,
    ImportedAgent          = source.ImportedAgent,
    AgentID                = source.AgentID,
    IsValid                = source.IsValid,
    LineNumber             = source.LineNumber,
    CallBackNumber         = source.CallBackNumber,
    ContactID              = source.ContactID,
    WasRecorded            = source.WasRecorded,
    CallerID               = source.CallerID,
    IsInternational        = source.IsInternational
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (SurveyInvitationID, bus_no, SurveyID, SurveyInvitationGUID, FirstName, LastName, MiddleName, Email, SentAt, CreateDate, UpdateDate, CreatedBy, UpdatedBy, SurveyInvitationFileID, ImportStatusDetails, ImportedSurveyID, ImportedAgent, AgentID, IsValid, LineNumber, CallBackNumber, ContactID, WasRecorded, CallerID, IsInternational) VALUES (source.SurveyInvitationID, source.bus_no, source.SurveyID, source.SurveyInvitationGUID, source.FirstName, source.LastName, source.MiddleName, source.Email, source.SentAt, source.CreateDate, source.UpdateDate, source.CreatedBy, source.UpdatedBy, source.SurveyInvitationFileID, source.ImportStatusDetails, source.ImportedSurveyID, source.ImportedAgent, source.AgentID, source.IsValid, source.LineNumber, source.CallBackNumber, source.ContactID, source.WasRecorded, source.CallerID, source.IsInternational)</td>
        <td>5</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [dbo].[SurveyInvitations]
 AS target
USING [ETL].[SurveyInvitations] AS source ON (target.SurveyInvitationID = source.SurveyInvitationID)
WHEN MATCHED AND source.ActionID = 0 THEN DELETE
WHEN MATCHED AND source.ActionID IN (1, 2, 3) THEN UPDATE 
SET bus_no                 = source.bus_no,
    SurveyID               = source.SurveyID,
    SurveyInvitationGUID   = source.SurveyInvitationGUID,
    FirstName              = source.FirstName,
    LastName               = source.LastName,
    MiddleName             = source.MiddleName,
    Email                  = source.Email,
    SentAt                 = source.SentAt,
    CreateDate             = source.CreateDate,
    UpdateDate             = source.UpdateDate,
    CreatedBy              = source.CreatedBy,
    UpdatedBy              = source.UpdatedBy,
    SurveyInvitationFileID = source.SurveyInvitationFileID,
    ImportStatusDetails    = source.ImportStatusDetails,
    ImportedSurveyID       = source.ImportedSurveyID,
    ImportedAgent          = source.ImportedAgent,
    AgentID                = source.AgentID,
    IsValid                = source.IsValid,
    LineNumber             = source.LineNumber,
    CallBackNumber         = source.CallBackNumber,
    ContactID              = source.ContactID,
    WasRecorded            = source.WasRecorded,
    CallerID               = source.CallerID,
    IsInternational        = source.IsInternational
WHEN NOT MATCHED AND source.ActionID IN (1, 2, 3) THEN INSERT (SurveyInvitationID, bus_no, SurveyID, SurveyInvitationGUID, FirstName, LastName, MiddleName, Email, SentAt, CreateDate, UpdateDate, CreatedBy, UpdatedBy, SurveyInvitationFileID, ImportStatusDetails, ImportedSurveyID, ImportedAgent, AgentID, IsValid, LineNumber, CallBackNumber, ContactID, WasRecorded, CallerID, IsInternational) VALUES (source.SurveyInvitationID, source.bus_no, source.SurveyID, source.SurveyInvitationGUID, source.FirstName, source.LastName, source.MiddleName, source.Email, source.SentAt, source.CreateDate, source.UpdateDate, source.CreatedBy, source.UpdatedBy, source.SurveyInvitationFileID, source.ImportStatusDetails, source.ImportedSurveyID, source.ImportedAgent, source.AgentID, source.IsValid, source.LineNumber, source.CallBackNumber, source.ContactID, source.WasRecorded, source.CallerID, source.IsInternational)</td>
        <td>5</td>
      </tr>
    </table>
  </body>
</html>