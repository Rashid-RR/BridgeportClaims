<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[IC_Reports_GetAllContactDetails]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[IC_Reports_GetAllContactDetails]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:11 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Subquery</td>
        <td colspan="1">(SELECT '1'
 FROM   dbo.Contact_Log_DetailQV
 WHERE  Contact_ID = @Contact_ID)</td>
        <td>36</td>
      </tr>
      <tr valign="top">
        <td colspan="1">One-part names</td>
        <td colspan="1">#TempContactDetails</td>
        <td>53</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ParentContactDetails_CTE</td>
        <td>113</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#TempContactDetails</td>
        <td>97</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ParentContactDetails_CTE AS c</td>
        <td>105</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#TempContactDetails AS t</td>
        <td>106</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ContactDetails_CTE AS c</td>
        <td>158</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#TempContactDetails AS t</td>
        <td>159</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#TempContactDetails</td>
        <td>123</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ContactDetails_CTE AS c</td>
        <td>132</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#TempContactDetails AS t</td>
        <td>133</td>
      </tr>
      <tr valign="top">
        <td colspan="1">WITH clause</td>
        <td colspan="1">WITH ParentContactDetails_CTE (Contact_ID, Master_Contact_ID, StateIndex)
AS (SELECT Contact_ID,
           Master_Contact_ID,
           StateIndex
    FROM   #TempContactDetails
    WHERE  Contact_ID = @Contact_ID
    UNION ALL
    SELECT t.Contact_ID,
           t.Master_Contact_ID,
           t.StateIndex
    FROM   ParentContactDetails_CTE AS c
           INNER JOIN
           #TempContactDetails AS t
           ON (c.Master_Contact_ID = t.Contact_ID)
    WHERE  t.Contact_ID != c.Contact_ID)</td>
        <td>92</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1"> ParentContactDetails_CTE (Contact_ID, Master_Contact_ID, StateIndex)
AS (SELECT Contact_ID,
           Master_Contact_ID,
           StateIndex
    FROM   #TempContactDetails
    WHERE  Contact_ID = @Contact_ID
    UNION ALL
    SELECT t.Contact_ID,
           t.Master_Contact_ID,
           t.StateIndex
    FROM   ParentContactDetails_CTE AS c
           INNER JOIN
           #TempContactDetails AS t
           ON (c.Master_Contact_ID = t.Contact_ID)
    WHERE  t.Contact_ID != c.Contact_ID)</td>
        <td>92</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">WITH ContactDetails_CTE (Contact_ID, Master_Contact_ID, StateIndex, Iteration_No)
AS (SELECT Contact_ID,
           Master_Contact_ID,
           StateIndex,
           @count AS Iteration_No
    FROM   #TempContactDetails
    WHERE  Contact_ID = @sourceId
    UNION ALL
    SELECT t.Contact_ID,
           t.Master_Contact_ID,
           t.StateIndex,
           Iteration_No + 1
    FROM   ContactDetails_CTE AS c
           INNER JOIN
           #TempContactDetails AS t
           ON (c.Iteration_No = 0
               OR c.Contact_ID = t.Master_Contact_ID)
              AND (c.Iteration_No != 0
                   OR (c.Master_Contact_ID = t.Master_Contact_ID
                       AND t.Master_Contact_ID != t.Contact_ID))
    WHERE  (c.Iteration_No = 0
            OR t.Contact_ID != c.Contact_ID))</td>
        <td>117</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1"> ContactDetails_CTE (Contact_ID, Master_Contact_ID, StateIndex, Iteration_No)
AS (SELECT Contact_ID,
           Master_Contact_ID,
           StateIndex,
           @count AS Iteration_No
    FROM   #TempContactDetails
    WHERE  Contact_ID = @sourceId
    UNION ALL
    SELECT t.Contact_ID,
           t.Master_Contact_ID,
           t.StateIndex,
           Iteration_No + 1
    FROM   ContactDetails_CTE AS c
           INNER JOIN
           #TempContactDetails AS t
           ON (c.Iteration_No = 0
               OR c.Contact_ID = t.Master_Contact_ID)
              AND (c.Iteration_No != 0
                   OR (c.Master_Contact_ID = t.Master_Contact_ID
                       AND t.Master_Contact_ID != t.Contact_ID))
    WHERE  (c.Iteration_No = 0
            OR t.Contact_ID != c.Contact_ID))</td>
        <td>117</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN ((Duration * 1.0) % 1000) / 1000 BETWEEN 0.5 AND 1 THEN dbo.FormatSecondsToHHMMSS(Duration / 1000 + 1) ELSE dbo.FormatSecondsToHHMMSS(Duration / 1000) END</td>
        <td>146</td>
      </tr>
    </table>
  </body>
</html>