<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[WarehouseAgents]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[WarehouseAgents]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:09 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET FORCEPLAN ON</td>
        <td>80</td>
      </tr>
      <tr valign="top">
        <td colspan="1">One-part names</td>
        <td colspan="1">#agent_log_temp</td>
        <td>82</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#tmpAgentDetailToSummarize AS t</td>
        <td>117</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#ALD AS d</td>
        <td>118</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#agent_log_temp</td>
        <td>129</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#tmpQtrHourTotals</td>
        <td>140</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#agent_log_temp AS t</td>
        <td>184</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">h</td>
        <td>196</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#tmpQtrHourTotals AS a</td>
        <td>199</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">dw_agent_byQtrHour</td>
        <td>208</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#tmpQtrHourTotals AS a</td>
        <td>222</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#tmpAgentTeamQtrHourTotals</td>
        <td>252</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#tmpQtrHourTotals AS t</td>
        <td>286</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">s</td>
        <td>297</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#tmpAgentTeamQtrHourTotals AS t</td>
        <td>304</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#tmpAgentTeamQtrHourTotals AS t</td>
        <td>341</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN d.working = 0 THEN (CASE WHEN d.available = 1 THEN 0 ELSE (CASE WHEN ((d.outstate_code BETWEEN 0 AND 9)
                                                                                OR (d.outstate_code = -1
                                                                                    AND d.contact_id IS NULL)) THEN 3 ELSE d.outstate_code END) END) WHEN d.working IN (1, 2) THEN d.working WHEN d.working = 3 THEN 2 WHEN d.working = 4 THEN 4 ELSE NULL END</td>
        <td>103</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN d.available = 1 THEN 0 ELSE (CASE WHEN ((d.outstate_code BETWEEN 0 AND 9)
                                                  OR (d.outstate_code = -1
                                                      AND d.contact_id IS NULL)) THEN 3 ELSE d.outstate_code END) END</td>
        <td>103</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ((d.outstate_code BETWEEN 0 AND 9)
           OR (d.outstate_code = -1
               AND d.contact_id IS NULL)) THEN 3 ELSE d.outstate_code END</td>
        <td>104</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN b.original_duration &gt; 0 THEN Duration / CONVERT (FLOAT, b.original_duration) ELSE 1.0 END</td>
        <td>155</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @CurQtrHour_StartDateTime &gt; t.Start_DateTime THEN @CurQtrHour_StartDateTime ELSE t.Start_DateTime END</td>
        <td>166</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @CurQtrHour_EndDateTime &lt; t.End_DateTime THEN @CurQtrHour_EndDateTime ELSE t.End_DateTime END</td>
        <td>169</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (t.optInStartDate = NULL)
          OR (t.optInEndDate = NULL) THEN 0 ELSE DATEDIFF(SECOND, (CASE WHEN @CurQtrHour_StartDateTime &gt; t.optInStartDate THEN @CurQtrHour_StartDateTime ELSE t.optInStartDate END), (CASE WHEN @CurQtrHour_EndDateTime &lt; t.optInEndDate THEN @CurQtrHour_EndDateTime ELSE t.optInEndDate END)) END</td>
        <td>174</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @CurQtrHour_StartDateTime &gt; t.optInStartDate THEN @CurQtrHour_StartDateTime ELSE t.optInStartDate END</td>
        <td>176</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN @CurQtrHour_EndDateTime &lt; t.optInEndDate THEN @CurQtrHour_EndDateTime ELSE t.optInEndDate END</td>
        <td>179</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (t.agent_state_code &gt; 9
           OR t.agent_state_code = 3
           OR t.agent_state_code &lt; 0) THEN t.duration ELSE 0 END</td>
        <td>268</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN t.agent_state_code = 0 THEN t.duration ELSE 0 END</td>
        <td>273</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN t.agent_state_code = -1 THEN t.cnt ELSE 0 END</td>
        <td>276</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN t.agent_state_code = -2 THEN t.cnt ELSE 0 END</td>
        <td>279</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN t.agent_state_code = 0 THEN t.optInDuration ELSE 0 END</td>
        <td>283</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SET OPTION OFF</td>
        <td colspan="1">SET FORCEPLAN OFF</td>
        <td>124</td>
      </tr>
      <tr valign="top">
        <td colspan="1">UPDATE with FROM clause</td>
        <td colspan="1">
FROM #tmpQtrHourTotals AS a
     INNER JOIN
     dbo.dw_agent_byQtrHour AS h
     ON h.agent_no = a.agent_no
        AND h.start_date = a.QtrHourStart_date
        AND h.QtrHour_code = a.QtrHour_Code
        AND h.agent_state_code = a.agent_state_code</td>
        <td>199</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">
FROM #tmpAgentTeamQtrHourTotals AS t
     INNER JOIN
     dbo.dw_agent_team_byQtrHour AS s
     ON s.Start_date = t.QtrHourStart_date
        AND s.agent_no = t.agent_no
        AND s.team_no = t.team_no</td>
        <td>304</td>
      </tr>
    </table>
  </body>
</html>