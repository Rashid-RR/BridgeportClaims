<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[IC_Reports_AbandonRateCompliance]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[IC_Reports_AbandonRateCompliance]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:10 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT Value
INTO   #SkillNoList
FROM   dbo.fn_Split3(@SkillNoList, DEFAULT)</td>
        <td>18</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT d.Skill_No,
       d.Contact_Id,
       d.contact_state,
       d.StateIndex
INTO   #Contacts
FROM   dbo.contact_log_header AS h
       INNER JOIN
       dbo.contact_log_footer AS f
       ON h.contact_id = f.contact_id
       INNER JOIN
       dbo.contact_log_detail AS d
       ON h.contact_id = d.contact_id
       LEFT OUTER JOIN
       #SkillNoList AS SklList
       ON d.Skill_No = SklList.Value
WHERE  h.[start_date] BETWEEN @StartDate AND @EndDate
       AND f.inbound = 'F'
       AND h.contact_code IN (10)
       AND h.Bus_No = @Bus_No
       AND d.contact_state IN (29, 4, 28, 7, 31)
       AND ((@SkillNoList IS NOT NULL
             AND SklList.Value IS NOT NULL)
            OR @SkillNoList IS NULL)</td>
        <td>23</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Table-valued functions</td>
        <td colspan="1">dbo.fn_Split3(@SkillNoList, DEFAULT)</td>
        <td>20</td>
      </tr>
      <tr valign="top">
        <td colspan="1">One-part names</td>
        <td colspan="1">#SkillNoList AS SklList</td>
        <td>28</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Total AS t</td>
        <td>66</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Handled AS h</td>
        <td>67</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Abandoned AS ab</td>
        <td>68</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Answered AS a</td>
        <td>69</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#Contacts</td>
        <td>39</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#Contacts</td>
        <td>45</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#Contacts</td>
        <td>51</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#Contacts</td>
        <td>57</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">FULL OUTER JOIN</td>
        <td colspan="1">Total AS t
FULL OUTER JOIN
Handled AS h
ON t.Contact_Id = h.Contact_Id
FULL OUTER JOIN
Abandoned AS ab
ON t.Contact_Id = ab.Contact_Id
FULL OUTER JOIN
Answered AS a
ON t.Contact_Id = a.Contact_Id</td>
        <td>66</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Total AS t
FULL OUTER JOIN
Handled AS h
ON t.Contact_Id = h.Contact_Id
FULL OUTER JOIN
Abandoned AS ab
ON t.Contact_Id = ab.Contact_Id</td>
        <td>66</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">Total AS t
FULL OUTER JOIN
Handled AS h
ON t.Contact_Id = h.Contact_Id</td>
        <td>66</td>
      </tr>
      <tr valign="top">
        <td colspan="1">WITH clause</td>
        <td colspan="1">WITH Answered (Skill_No, Contact_Id, RowNumber)
AS (SELECT Skill_No,
           Contact_Id,
           ROW_NUMBER() OVER (PARTITION BY Contact_Id ORDER BY StateIndex) AS RowNumber
    FROM   #Contacts
    WHERE  contact_state = 29),
 Handled (Skill_No, Contact_Id, RowNumber)
AS (SELECT Skill_No,
           Contact_Id,
           ROW_NUMBER() OVER (PARTITION BY Contact_Id ORDER BY StateIndex) AS RowNumber
    FROM   #Contacts
    WHERE  contact_state IN (4, 31)),
 Abandoned (Skill_No, Contact_Id, RowNumber)
AS (SELECT Skill_No,
           Contact_Id,
           ROW_NUMBER() OVER (PARTITION BY Contact_Id ORDER BY StateIndex) AS RowNumber
    FROM   #Contacts
    WHERE  contact_state = 28),
 Total (Skill_No, Contact_Id, RowNumber)
AS (SELECT Skill_No,
           Contact_Id,
           ROW_NUMBER() OVER (PARTITION BY Contact_Id ORDER BY StateIndex) AS RowNumber
    FROM   #Contacts
    WHERE  contact_state = 7)</td>
        <td>36</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1"> Answered (Skill_No, Contact_Id, RowNumber)
AS (SELECT Skill_No,
           Contact_Id,
           ROW_NUMBER() OVER (PARTITION BY Contact_Id ORDER BY StateIndex) AS RowNumber
    FROM   #Contacts
    WHERE  contact_state = 29)</td>
        <td>36</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1"> Handled (Skill_No, Contact_Id, RowNumber)
AS (SELECT Skill_No,
           Contact_Id,
           ROW_NUMBER() OVER (PARTITION BY Contact_Id ORDER BY StateIndex) AS RowNumber
    FROM   #Contacts
    WHERE  contact_state IN (4, 31))</td>
        <td>42</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1"> Abandoned (Skill_No, Contact_Id, RowNumber)
AS (SELECT Skill_No,
           Contact_Id,
           ROW_NUMBER() OVER (PARTITION BY Contact_Id ORDER BY StateIndex) AS RowNumber
    FROM   #Contacts
    WHERE  contact_state = 28)</td>
        <td>48</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1"> Total (Skill_No, Contact_Id, RowNumber)
AS (SELECT Skill_No,
           Contact_Id,
           ROW_NUMBER() OVER (PARTITION BY Contact_Id ORDER BY StateIndex) AS RowNumber
    FROM   #Contacts
    WHERE  contact_state = 7)</td>
        <td>54</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">ROW_NUMBER</td>
        <td colspan="1">ROW_NUMBER() OVER (PARTITION BY Contact_Id ORDER BY StateIndex)</td>
        <td>38</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ROW_NUMBER() OVER (PARTITION BY Contact_Id ORDER BY StateIndex)</td>
        <td>44</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ROW_NUMBER() OVER (PARTITION BY Contact_Id ORDER BY StateIndex)</td>
        <td>50</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ROW_NUMBER() OVER (PARTITION BY Contact_Id ORDER BY StateIndex)</td>
        <td>56</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">OVER</td>
        <td colspan="1">OVER (PARTITION BY Contact_Id ORDER BY StateIndex)</td>
        <td>38</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">OVER (PARTITION BY Contact_Id ORDER BY StateIndex)</td>
        <td>44</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">OVER (PARTITION BY Contact_Id ORDER BY StateIndex)</td>
        <td>50</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">OVER (PARTITION BY Contact_Id ORDER BY StateIndex)</td>
        <td>56</td>
      </tr>
    </table>
  </body>
</html>