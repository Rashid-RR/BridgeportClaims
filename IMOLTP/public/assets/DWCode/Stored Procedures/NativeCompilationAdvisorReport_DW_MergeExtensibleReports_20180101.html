<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeExtensibleReports]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[DW_MergeExtensibleReports]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:11 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SET XACT_ABORT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">MERGE</td>
        <td colspan="1">MERGE INTO [dbo].[ExtensibleReports]
 AS target
USING (SELECT ExtensibleReportID,
              GlobalReport,
              ReportName,
              RptFileName,
              Notes,
              CreatedBy,
              CreatedDate,
              ModifiedBy,
              ModifiedDate
       FROM   (SELECT ExtensibleReportID,
                      GlobalReport,
                      ReportName,
                      RptFileName,
                      Notes,
                      CreatedBy,
                      CreatedDate,
                      ModifiedBy,
                      ModifiedDate,
                      ROW_NUMBER() OVER (PARTITION BY ExtensibleReportID ORDER BY ExtensibleReportID) AS RowNum
               FROM   [ETL].[ExtensibleReports]) AS dup
       WHERE  dup.RowNum = 1) AS source ON (target.ExtensibleReportID = source.ExtensibleReportID)
WHEN MATCHED AND (target.GlobalReport != source.GlobalReport
                  OR target.ReportName != source.ReportName
                  OR target.RptFileName != source.RptFileName
                  OR CASE WHEN target.Notes = source.Notes
                               OR target.Notes IS NULL
                                  AND source.Notes IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.CreatedBy = source.CreatedBy
                               OR target.CreatedBy IS NULL
                                  AND source.CreatedBy IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.CreatedDate = source.CreatedDate
                               OR target.CreatedDate IS NULL
                                  AND source.CreatedDate IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.ModifiedBy = source.ModifiedBy
                               OR target.ModifiedBy IS NULL
                                  AND source.ModifiedBy IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.ModifiedDate = source.ModifiedDate
                               OR target.ModifiedDate IS NULL
                                  AND source.ModifiedDate IS NULL THEN 0 END IS NULL) THEN UPDATE 
SET GlobalReport = source.GlobalReport,
    ReportName   = source.ReportName,
    RptFileName  = source.RptFileName,
    Notes        = source.Notes,
    CreatedBy    = source.CreatedBy,
    CreatedDate  = source.CreatedDate,
    ModifiedBy   = source.ModifiedBy,
    ModifiedDate = source.ModifiedDate
WHEN NOT MATCHED THEN INSERT (ExtensibleReportID, GlobalReport, ReportName, RptFileName, Notes, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) VALUES (source.ExtensibleReportID, source.GlobalReport, source.ReportName, source.RptFileName, source.Notes, source.CreatedBy, source.CreatedDate, source.ModifiedBy, source.ModifiedDate)
WHEN NOT MATCHED BY SOURCE THEN DELETE</td>
        <td>5</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MERGE INTO [dbo].[ExtensibleReports]
 AS target
USING (SELECT ExtensibleReportID,
              GlobalReport,
              ReportName,
              RptFileName,
              Notes,
              CreatedBy,
              CreatedDate,
              ModifiedBy,
              ModifiedDate
       FROM   (SELECT ExtensibleReportID,
                      GlobalReport,
                      ReportName,
                      RptFileName,
                      Notes,
                      CreatedBy,
                      CreatedDate,
                      ModifiedBy,
                      ModifiedDate,
                      ROW_NUMBER() OVER (PARTITION BY ExtensibleReportID ORDER BY ExtensibleReportID) AS RowNum
               FROM   [ETL].[ExtensibleReports]) AS dup
       WHERE  dup.RowNum = 1) AS source ON (target.ExtensibleReportID = source.ExtensibleReportID)
WHEN MATCHED AND (target.GlobalReport != source.GlobalReport
                  OR target.ReportName != source.ReportName
                  OR target.RptFileName != source.RptFileName
                  OR CASE WHEN target.Notes = source.Notes
                               OR target.Notes IS NULL
                                  AND source.Notes IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.CreatedBy = source.CreatedBy
                               OR target.CreatedBy IS NULL
                                  AND source.CreatedBy IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.CreatedDate = source.CreatedDate
                               OR target.CreatedDate IS NULL
                                  AND source.CreatedDate IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.ModifiedBy = source.ModifiedBy
                               OR target.ModifiedBy IS NULL
                                  AND source.ModifiedBy IS NULL THEN 0 END IS NULL
                  OR CASE WHEN target.ModifiedDate = source.ModifiedDate
                               OR target.ModifiedDate IS NULL
                                  AND source.ModifiedDate IS NULL THEN 0 END IS NULL) THEN UPDATE 
SET GlobalReport = source.GlobalReport,
    ReportName   = source.ReportName,
    RptFileName  = source.RptFileName,
    Notes        = source.Notes,
    CreatedBy    = source.CreatedBy,
    CreatedDate  = source.CreatedDate,
    ModifiedBy   = source.ModifiedBy,
    ModifiedDate = source.ModifiedDate
WHEN NOT MATCHED THEN INSERT (ExtensibleReportID, GlobalReport, ReportName, RptFileName, Notes, CreatedBy, CreatedDate, ModifiedBy, ModifiedDate) VALUES (source.ExtensibleReportID, source.GlobalReport, source.ReportName, source.RptFileName, source.Notes, source.CreatedBy, source.CreatedDate, source.ModifiedBy, source.ModifiedDate)
WHEN NOT MATCHED BY SOURCE THEN DELETE</td>
        <td>5</td>
      </tr>
      <tr valign="top">
        <td colspan="1">ROW_NUMBER</td>
        <td colspan="1">ROW_NUMBER() OVER (PARTITION BY ExtensibleReportID ORDER BY ExtensibleReportID)</td>
        <td>30</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">OVER</td>
        <td colspan="1">OVER (PARTITION BY ExtensibleReportID ORDER BY ExtensibleReportID)</td>
        <td>30</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN target.Notes = source.Notes
          OR target.Notes IS NULL
             AND source.Notes IS NULL THEN 0 END</td>
        <td>46</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.CreatedBy = source.CreatedBy
          OR target.CreatedBy IS NULL
             AND source.CreatedBy IS NULL THEN 0 END</td>
        <td>47</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.CreatedDate = source.CreatedDate
          OR target.CreatedDate IS NULL
             AND source.CreatedDate IS NULL THEN 0 END</td>
        <td>48</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.ModifiedBy = source.ModifiedBy
          OR target.ModifiedBy IS NULL
             AND source.ModifiedBy IS NULL THEN 0 END</td>
        <td>49</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN target.ModifiedDate = source.ModifiedDate
          OR target.ModifiedDate IS NULL
             AND source.ModifiedDate IS NULL THEN 0 END</td>
        <td>50</td>
      </tr>
    </table>
  </body>
</html>