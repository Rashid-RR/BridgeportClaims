<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[Billing_GetProductUsage]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[Billing_GetProductUsage]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:11 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>4</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Four-part names</td>
        <td colspan="1">[LinkedMyGlobal].[MyGlobal].dbo.BillingView_LastQuery</td>
        <td>37</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">[LinkedMyGlobal].[MyGlobal].dbo.Billing_InsertProductUsage</td>
        <td>2243</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">[LinkedMyGlobal].[MyGlobal].dbo.Billing_InsertLastQuery</td>
        <td>2267</td>
      </tr>
      <tr valign="top">
        <td colspan="1">@@servername</td>
        <td colspan="1">@@ServerName</td>
        <td>39</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>105</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>126</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>139</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>223</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>242</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>264</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>287</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>315</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>337</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>360</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>382</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>404</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>425</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>446</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>472</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>491</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>512</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>538</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>561</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>585</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>608</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>640</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>663</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>687</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>711</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>734</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>756</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>780</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>804</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>827</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>859</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>883</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>907</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>931</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>955</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>978</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1000</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1022</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1046</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1070</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1094</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1116</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1137</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1158</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1180</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1201</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1222</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1243</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1264</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1285</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1306</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1327</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1348</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1369</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1390</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1417</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1445</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1476</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1507</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1538</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1569</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1591</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1655</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1679</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1703</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1727</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1751</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1775</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1799</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1823</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1847</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1871</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1895</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1919</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1942</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1965</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>1989</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>2013</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>2037</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>2061</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>2084</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>2107</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>2160</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>2182</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>2202</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>2219</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@ServerName</td>
        <td>2267</td>
      </tr>
      <tr valign="top">
        <td colspan="1">One-part names</td>
        <td colspan="1">#dateRange</td>
        <td>67</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>114</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>134</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>147</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>185</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#TmpConcurrentAgentCount</td>
        <td>195</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#TmpConcurrentAgentCount</td>
        <td>202</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#TmpBusConcurrentAgentCount</td>
        <td>209</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#TmpConcurrentAgentCount</td>
        <td>214</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#TmpBusConcurrentAgentCount AS t</td>
        <td>232</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>250</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>273</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>298</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>323</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>345</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>368</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>390</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>412</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>433</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>480</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>499</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>742</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>986</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>1008</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>1102</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>1124</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>1145</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>1166</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>1188</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>1209</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>1230</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>1251</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>1272</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>1293</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>1377</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>1577</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>1950</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>1973</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>2092</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>2115</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#tmpAuditHistory</td>
        <td>2130</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#tmpAgentPrivAudit</td>
        <td>2146</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#tmpAuditHistory AS a</td>
        <td>2167</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#tmpAgentPrivAudit AS p</td>
        <td>2168</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>2169</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#tmpAuditHistory AS a</td>
        <td>2189</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>2190</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#tmpAuditHistory AS a</td>
        <td>2209</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>2210</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#tmpAuditHistory AS a</td>
        <td>2226</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dateRange AS r</td>
        <td>2227</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dateRange</td>
        <td>2259</td>
      </tr>
      <tr valign="top">
        <td colspan="1">Cursors</td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 d.bus_no AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(*) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.DataConnectors AS d
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON bu.bus_no = d.bus_no
                    AND bu.Status = 'CURR' CROSS JOIN #dateRange AS r
        WHERE    isActive = 1
        GROUP BY d.Bus_no, r.CurrentDate</td>
        <td>105</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 d.bus_no AS bus_no,
                 @prodTypeID AS prodTypeID,
                 MAX(CEILING(d.Usage_MB / 1024.0)) AS prodAmt,
                 '' AS fileType,
                 '' AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.disk_utilization AS d
                 INNER JOIN
                 #dateRange AS r
                 ON dbo.fn_RemoveTime(d.query_date) = r.CurrentDate
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON bu.bus_no = d.bus_no
                    AND bu.Status = 'CURR'
        GROUP BY d.bus_no, r.CurrentDate
        UNION
        SELECT   @@ServerName AS ServerName,
                 ab.bus_no AS bus_no,
                 @prodTypeID AS prodTypeID,
                 MAX(CEILING(ab.StorageAmnt / 1073741824.0)) AS prodAmt,
                 ab.FileType AS fileType,
                 ab.StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.AWSBilling AS ab
                 INNER JOIN
                 #dateRange AS r
                 ON dbo.fn_RemoveTime(ab.CaptureDate) = r.CurrentDate
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON bu.bus_no = ab.bus_no
                    AND bu.Status = 'CURR'
        WHERE    ab.StorageType = 'Active'
        GROUP BY ab.bus_no, r.CurrentDate, ab.FileType, ab.StorageType</td>
        <td>126</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR STATIC LOCAL
    FOR SELECT DISTINCT r.CurrentDate,
                        cas.BusNo
        FROM   dbo.ConcurrentAgentSessions AS cas
               INNER JOIN
               #dateRange AS r
               ON cas.UTCQtrHourStartDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate</td>
        <td>181</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT @@ServerName AS ServerName,
               t.BusNo AS bus_no,
               @prodTypeID AS prodTypeID,
               (CASE WHEN @prodTypeID = 17 THEN t.FairPeak WHEN @prodTypeID = 46 THEN t.AgentPeak END) AS prodAmt,
               @FileType AS fileType,
               @StorageType AS storageType,
               t.Date AS queryDate
        FROM   #TmpBusConcurrentAgentCount AS t
               INNER JOIN
               dbo.business_unit AS bu
               ON bu.bus_no = t.BusNo
                  AND bu.Status = 'CURR'</td>
        <td>223</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 cc.BusNo AS bus_no,
                 18 AS prodTypeID,
                 MAX(cc.MaxConcurrent) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.ConcurrentContacts AS cc
                 INNER JOIN
                 #dateRange AS r
                 ON cc.UTCQtrHourStartDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON bu.bus_no = cc.BusNo
                    AND bu.Status = 'CURR'
        WHERE    cc.MediaType = 4
        GROUP BY cc.busno, r.CurrentDate</td>
        <td>242</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 sr.Bus_No AS bus_no,
                 19 AS prodTypeID,
                 COUNT(sr.SurveyResultID) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.Business_Unit_Products AS bup
                 INNER JOIN
                 dbo.SurveyResults AS sr
                 ON sr.bus_no = bup.BusNo
                 INNER JOIN
                 #dateRange AS r
                 ON sr.CompletedDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON bu.bus_no = sr.Bus_No
                    AND bu.Status = 'CURR'
        WHERE    bup.ProductID = 2
        GROUP BY sr.bus_no, r.CurrentDate</td>
        <td>264</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 si.Bus_No AS bus_no,
                 20 AS prodTypeID,
                 COUNT(si.SurveyInvitationID) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 CurrentDate AS queryDate
        FROM     dbo.Business_Unit_Products AS bup
                 INNER JOIN
                 dbo.SurveyInvitations AS si
                 ON si.bus_no = bup.BusNo
                    AND bup.ProductID = 2
                 INNER JOIN
                 dbo.SurveyInvitationFiles AS sif
                 ON sif.SurveyInvitationFileID = si.SurveyInvitationFileID
                 INNER JOIN
                 #dateRange AS r
                 ON sif.SendingCompleteDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON bu.bus_no = si.Bus_No
                    AND bu.Status = 'CURR'
        WHERE    si.IsValid = 1
                 AND sif.SendingCompleteDate IS NOT NULL
                 AND bup.ProductID = 2
        GROUP BY si.bus_no, r.CurrentDate</td>
        <td>287</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 ca.BusNo AS bus_no,
                 27 AS prodTypeID,
                 MAX(ca.MaxConcurrentAgents) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.ConcurrentAgentSessions AS ca
                 INNER JOIN
                 #dateRange AS r
                 ON ca.UTCQtrHourStartDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON bu.bus_no = ca.BusNo
                    AND bu.Status = 'CURR'
        GROUP BY ca.BusNo, r.CurrentDate</td>
        <td>315</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 cc.BusNo AS bus_no,
                 28 AS prodTypeID,
                 MAX(cc.MaxPorts) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.ConcurrentContacts AS cc
                 INNER JOIN
                 #dateRange AS r
                 ON cc.UTCQtrHourStartDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON bu.bus_no = cc.BusNo
                    AND bu.Status = 'CURR'
        WHERE    cc.MediaType = 4
        GROUP BY cc.busno, r.CurrentDate</td>
        <td>337</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 bu.Bus_No AS bus_no,
                 29 AS prodTypeID,
                 MAX(bu.ConfiguredUserCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingUsers AS bu
                 INNER JOIN
                 #dateRange AS r
                 ON bu.CaptureDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = bu.Bus_No
                    AND b.Status = 'CURR'
        GROUP BY bu.Bus_No, r.CurrentDate</td>
        <td>360</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 bu.Bus_No AS bus_no,
                 30 AS prodTypeID,
                 MAX(bu.MaximumUserCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingUsers AS bu
                 INNER JOIN
                 #dateRange AS r
                 ON bu.CaptureDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = bu.Bus_No
                    AND b.Status = 'CURR'
        GROUP BY bu.Bus_No, r.CurrentDate</td>
        <td>382</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 bs.Bus_No AS bus_no,
                 31 AS prodTypeID,
                 MAX(bs.ConfiguredStationCount + bs.AgentStationCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingStations AS bs
                 INNER JOIN
                 #dateRange AS r
                 ON bs.CaptureDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = bs.Bus_No
                    AND b.Status = 'CURR'
        GROUP BY bs.Bus_No, r.CurrentDate</td>
        <td>404</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 bs.Bus_No AS bus_no,
                 32 AS prodTypeID,
                 MAX(bs.MaximumStationCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingStations AS bs
                 INNER JOIN
                 #dateRange AS r
                 ON bs.CaptureDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = bs.Bus_No
                    AND b.Status = 'CURR'
        GROUP BY bs.Bus_No, r.CurrentDate</td>
        <td>425</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 [AuditICCentralUserLogin].Bus_No AS Bus_No,
                 33 AS prodTypeID,
                 COUNT(DISTINCT [AuditICCentralUserLogin].Agent_No) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     [dbo].[AuditICCentralUserLogin]
                 INNER JOIN
                 dbo.Business_Unit
                 ON [AuditICCentralUserLogin].Bus_No = [dbo].[Business_Unit].Bus_No
                 INNER JOIN
                 dbo.Agents
                 ON [AuditICCentralUserLogin].Agent_No = [dbo].[Agents].Agent_No
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = [AuditICCentralUserLogin].Bus_No
                    AND b.Status = 'CURR'
        WHERE    Business_Unit.BusTypeID = 4
                 AND [AuditICCentralUserLogin].LoginDate &gt;= CONVERT (VARCHAR (25), DATEADD(dd, -(DAY(DATEADD(mm, -1, GETUTCDATE())) - 1), DATEADD(mm, -1, GETUTCDATE())), 101)
                 AND [dbo].[Agents].Billable = 1
        GROUP BY [AuditICCentralUserLogin].bus_no</td>
        <td>445</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 b.Bus_No AS bus_no,
                 36 AS prodTypeID,
                 MAX(b.UniqueAgentCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingAgentLogins AS b
                 INNER JOIN
                 #dateRange AS r
                 ON b.CaptureDate = r.CurrentDate
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON b.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
        GROUP BY b.Bus_No, r.CurrentDate</td>
        <td>472</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 b.Bus_No AS bus_no,
                 37 AS prodTypeID,
                 MAX(b.UniqueSupervisorCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingAgentLogins AS b
                 INNER JOIN
                 #dateRange AS r
                 ON b.CaptureDate = r.CurrentDate
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON b.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
        GROUP BY b.Bus_No, r.CurrentDate</td>
        <td>491</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 38 AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (18)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>511</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 39 AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (19)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>537</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 40 AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (17)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>560</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 41 AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (20, 21)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>584</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 42 AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (22, 23)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>607</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 44 AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (24, 25)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>639</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 45 AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (26)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>662</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 47 AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (30, 31)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>686</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 48 AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (32, 33)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>710</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 bu.Bus_No AS bus_no,
                 50 AS prodTypeID,
                 MAX(bu.ConfiguredPersonalConnectionUserCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingUsers AS bu
                 INNER JOIN
                 #dateRange AS r
                 ON bu.CaptureDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = bu.bus_no
                    AND b.Status = 'CURR'
        GROUP BY bu.Bus_No, r.CurrentDate</td>
        <td>734</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (42)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>756</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (43)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>779</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (44)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>803</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT @@ServerName AS ServerName,
               b.Bus_No AS bus_no,
               @prodTypeID AS prodTypeID,
               ISNULL(x.inViewEnabledAgents, 0) AS prodAmt,
               @FileType AS fileType,
               @StorageType AS storageType,
               CONVERT (DATETIME, CONVERT (NVARCHAR, GETUTCDATE(), 101)) AS queryDate
        FROM   dbo.Business_Unit AS b
               INNER JOIN
               dbo.Business_Unit_Products AS p
               ON b.Bus_No = p.BusNo
               LEFT OUTER JOIN
               (SELECT   pta.Bus_No,
                         COUNT(DISTINCT a.Agent_No) AS inViewEnabledAgents
                FROM     dbo.ProductTeamAssignments AS pta
                         INNER JOIN
                         dbo.Team AS t
                         ON pta.Team_No = t.Team_No
                            AND t.Status = 'CURR'
                         INNER JOIN
                         dbo.Agents AS a
                         ON pta.Team_No = a.Team_No
                            AND a.Status = 'CURR'
                WHERE    pta.ProductID IN (45)
                         AND a.Billable = 1
                GROUP BY pta.Bus_No) AS x
               ON p.BusNo = x.Bus_No
        WHERE  b.Status = 'CURR'
               AND p.ProductID IN (45)</td>
        <td>827</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (46)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>858</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (47)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>882</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (48)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>906</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (49)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>930</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID IN (50)
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>954</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 ca.BusNo AS bus_no,
                 @prodTypeID AS prodTypeID,
                 MAX(ca.MaxConcurrentPC) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.ConcurrentAgentSessions AS ca
                 INNER JOIN
                 #dateRange AS r
                 ON ca.UTCQtrHourStartDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = ca.BusNo
                    AND b.Status = 'CURR'
        GROUP BY ca.BusNo, r.CurrentDate</td>
        <td>978</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 cc.BusNo AS bus_no,
                 @prodTypeID AS prodTypeID,
                 MAX(cc.PCMaxConcurrent) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.ConcurrentContacts AS cc
                 INNER JOIN
                 #dateRange AS r
                 ON cc.UTCQtrHourStartDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = cc.BusNo
                    AND b.Status = 'CURR'
        WHERE    cc.MediaType = 4
        GROUP BY cc.busno, r.CurrentDate</td>
        <td>1000</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 62 AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.Agents AS a
                 INNER JOIN
                 dbo.Business_Unit AS bu
                 ON bu.Bus_No = a.Bus_No
                 INNER JOIN
                 dbo.Business_Unit_Products AS bup
                 ON bup.BusNo = a.Bus_No
        WHERE    a.Billable = 1
                 AND bup.ProductID IN (57)
                 AND a.Status = 'CURR'
                 AND bu.Status = 'CURR'
        GROUP BY a.Bus_No</td>
        <td>1022</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 63 AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.Agents AS a
                 INNER JOIN
                 dbo.Business_Unit AS bu
                 ON bu.Bus_No = a.Bus_No
                 INNER JOIN
                 dbo.Business_Unit_Products AS bup
                 ON bup.BusNo = a.Bus_No
        WHERE    a.Billable = 1
                 AND bup.ProductID IN (58)
                 AND a.Status = 'CURR'
                 AND bu.Status = 'CURR'
        GROUP BY a.Bus_No</td>
        <td>1046</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 64 AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.Agents AS a
                 INNER JOIN
                 dbo.Business_Unit AS bu
                 ON bu.Bus_No = a.Bus_No
                 INNER JOIN
                 dbo.Business_Unit_Products AS bup
                 ON bup.BusNo = a.Bus_No
        WHERE    a.Billable = 1
                 AND bup.ProductID IN (59)
                 AND a.Status = 'CURR'
                 AND bu.Status = 'CURR'
        GROUP BY a.Bus_No</td>
        <td>1070</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 bu.Bus_No AS bus_no,
                 65 AS prodTypeID,
                 MAX(bu.ConfiguredLyncUserCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingUsers AS bu
                 INNER JOIN
                 #dateRange AS r
                 ON bu.CaptureDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = bu.bus_no
                    AND b.Status = 'CURR'
        GROUP BY bu.Bus_No, r.CurrentDate</td>
        <td>1094</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 bu.Bus_No AS bus_no,
                 111 AS prodTypeID,
                 MAX(bu.ConfiguredOSCUserCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingUsers AS bu
                 INNER JOIN
                 #dateRange AS r
                 ON bu.CaptureDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = bu.bus_no
                    AND b.Status = 'CURR'
        GROUP BY bu.Bus_No, r.CurrentDate</td>
        <td>1116</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 bu.Bus_No AS bus_no,
                 112 AS prodTypeID,
                 MAX(bu.ConcurrentOSCUserCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingUsers AS bu
                 INNER JOIN
                 #dateRange AS r
                 ON bu.CaptureDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = bu.bus_no
                    AND b.Status = 'CURR'
        GROUP BY bu.Bus_No, r.CurrentDate</td>
        <td>1137</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 bu.Bus_No AS bus_no,
                 66 AS prodTypeID,
                 MAX(bu.ConfiguredEmailUserCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingUsers AS bu
                 INNER JOIN
                 #dateRange AS r
                 ON bu.CaptureDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = bu.bus_no
                    AND b.Status = 'CURR'
        GROUP BY bu.Bus_No, r.CurrentDate</td>
        <td>1158</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 bu.Bus_No AS bus_no,
                 67 AS prodTypeID,
                 MAX(bu.ConfiguredChatUserCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingUsers AS bu
                 INNER JOIN
                 #dateRange AS r
                 ON bu.CaptureDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = bu.bus_no
                    AND b.Status = 'CURR'
        GROUP BY bu.Bus_No, r.CurrentDate</td>
        <td>1180</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 bu.Bus_No AS bus_no,
                 68 AS prodTypeID,
                 MAX(bu.ConfiguredVoiceUserCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingUsers AS bu
                 INNER JOIN
                 #dateRange AS r
                 ON bu.CaptureDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = bu.bus_no
                    AND b.Status = 'CURR'
        GROUP BY bu.Bus_No, r.CurrentDate</td>
        <td>1201</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 bu.Bus_No AS bus_no,
                 69 AS prodTypeID,
                 MAX(bu.ConfiguredVoiceMailUserCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingUsers AS bu
                 INNER JOIN
                 #dateRange AS r
                 ON bu.CaptureDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = bu.bus_no
                    AND b.Status = 'CURR'
        GROUP BY bu.Bus_No, r.CurrentDate</td>
        <td>1222</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 bu.Bus_No AS bus_no,
                 70 AS prodTypeID,
                 MAX(bu.ConfiguredWorkItemUserCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingUsers AS bu
                 INNER JOIN
                 #dateRange AS r
                 ON bu.CaptureDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = bu.bus_no
                    AND b.Status = 'CURR'
        GROUP BY bu.Bus_No, r.CurrentDate</td>
        <td>1243</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 bu.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 MAX(bu.ConfiguredSMSUserCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingUsers AS bu
                 INNER JOIN
                 #dateRange AS r
                 ON bu.CaptureDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = bu.bus_no
                    AND b.Status = 'CURR'
        GROUP BY bu.Bus_No, r.CurrentDate</td>
        <td>1264</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 sru.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 SUM(sru.SegmentsSent) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.SMSRollUP AS sru
                 INNER JOIN
                 #dateRange AS r
                 ON sru.UTCStartDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = sru.bus_no
                    AND b.Status = 'CURR'
        GROUP BY sru.Bus_No, r.CurrentDate</td>
        <td>1285</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 sms.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(sms.TransportCode) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.BusinessSMS AS sms
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = sms.bus_no
                    AND b.Status = 'CURR'
                    AND sms.TransportCodeType = 0
                    AND sms.Active = 1
        GROUP BY sms.Bus_No</td>
        <td>1306</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 sms.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(sms.TransportCode) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.BusinessSMS AS sms
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = sms.bus_no
                    AND b.Status = 'CURR'
                    AND sms.TransportCodeType = 1
                    AND sms.Active = 1
        GROUP BY sms.Bus_No</td>
        <td>1327</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 sms.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(sms.TransportCode) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.BusinessSMS AS sms
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = sms.bus_no
                    AND b.Status = 'CURR'
                    AND sms.TransportCodeType = 2
                    AND sms.Active = 1
        GROUP BY sms.Bus_No</td>
        <td>1348</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 bu.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 MAX(bu.ConfiguredSocialUserCount) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.BillingUsers AS bu
                 INNER JOIN
                 #dateRange AS r
                 ON bu.CaptureDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = bu.bus_no
                    AND b.Status = 'CURR'
        GROUP BY bu.Bus_No, r.CurrentDate</td>
        <td>1369</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT @@ServerName AS ServerName,
               b.bus_no AS bus_no,
               @prodTypeID AS prodTypeID,
               ISNULL(x.StandardPackageAgents, 0) AS prodAmt,
               @FileType AS fileType,
               @StorageType AS storageType,
               CONVERT (DATETIME, CONVERT (NVARCHAR, GETUTCDATE(), 101)) AS queryDate
        FROM   dbo.business_unit AS b
               LEFT OUTER JOIN
               (SELECT   ppa.bus_no,
                         MAX(bu.ConfiguredUserCount) AS StandardPackageAgents
                FROM     dbo.ProductPackageAssignments AS ppa
                         INNER JOIN
                         dbo.ProductComponents AS pc
                         ON pc.ProductComponentID = ppa.ProductComponentID
                            AND pc.Status = 'CURR'
                         INNER JOIN
                         dbo.BillingUsers AS bu
                         ON bu.bus_no = ppa.bus_no
                WHERE    pc.ProdTypeId = @prodTypeID
                GROUP BY ppa.bus_no) AS x
               ON b.bus_no = x.Bus_No
        WHERE  b.Status = 'CURR'</td>
        <td>1390</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT @@ServerName AS ServerName,
               b.bus_no AS bus_no,
               @prodTypeID AS prodTypeID,
               ISNULL(x.PremiumPackageAgents, 0) AS prodAmt,
               @FileType AS fileType,
               @StorageType AS storageType,
               CONVERT (DATETIME, CONVERT (NVARCHAR, GETUTCDATE(), 101)) AS queryDate
        FROM   dbo.business_unit AS b
               LEFT OUTER JOIN
               (SELECT   ppa.bus_no,
                         MAX(bu.ConfiguredUserCount) AS PremiumPackageAgents
                FROM     dbo.ProductPackageAssignments AS ppa
                         INNER JOIN
                         dbo.ProductComponents AS pc
                         ON pc.ProductComponentID = ppa.ProductComponentID
                            AND pc.Status = 'CURR'
                         INNER JOIN
                         dbo.BillingUsers AS bu
                         ON bu.bus_no = ppa.bus_no
                WHERE    pc.ProdTypeId = @prodTypeID
                GROUP BY ppa.bus_no) AS x
               ON b.bus_no = x.Bus_No
        WHERE  b.Status = 'CURR'</td>
        <td>1417</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT @@ServerName AS ServerName,
               b.Bus_No AS bus_no,
               @prodTypeID AS prodTypeID,
               ISNULL(x.inViewTimeClockEnabledAgents, 0) AS prodAmt,
               @FileType AS fileType,
               @StorageType AS storageType,
               CONVERT (DATETIME, CONVERT (NVARCHAR, GETUTCDATE(), 101)) AS queryDate
        FROM   dbo.Business_Unit AS b
               INNER JOIN
               dbo.Business_Unit_Products AS p
               ON b.Bus_No = p.BusNo
               LEFT OUTER JOIN
               (SELECT   pta.Bus_No,
                         COUNT(DISTINCT a.Agent_No) AS inViewTimeClockEnabledAgents
                FROM     dbo.ProductTeamAssignments AS pta
                         INNER JOIN
                         dbo.Team AS t
                         ON pta.Team_No = t.Team_No
                            AND t.Status = 'CURR'
                         INNER JOIN
                         dbo.Agents AS a
                         ON pta.Team_No = a.Team_No
                            AND a.Status = 'CURR'
                WHERE    pta.ProductID IN (107)
                         AND a.Billable = 1
                GROUP BY pta.Bus_No) AS x
               ON p.BusNo = x.Bus_No
        WHERE  b.Status = 'CURR'
               AND p.ProductID IN (107)</td>
        <td>1445</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT @@ServerName AS ServerName,
               b.Bus_No AS bus_no,
               @prodTypeID AS prodTypeID,
               ISNULL(x.inViewGamificationEnabledAgents, 0) AS prodAmt,
               @FileType AS fileType,
               @StorageType AS storageType,
               CONVERT (DATETIME, CONVERT (NVARCHAR, GETUTCDATE(), 101)) AS queryDate
        FROM   dbo.Business_Unit AS b
               INNER JOIN
               dbo.Business_Unit_Products AS p
               ON b.Bus_No = p.BusNo
               LEFT OUTER JOIN
               (SELECT   pta.Bus_No,
                         COUNT(DISTINCT a.Agent_No) AS inViewGamificationEnabledAgents
                FROM     dbo.ProductTeamAssignments AS pta
                         INNER JOIN
                         dbo.Team AS t
                         ON pta.Team_No = t.Team_No
                            AND t.Status = 'CURR'
                         INNER JOIN
                         dbo.Agents AS a
                         ON pta.Team_No = a.Team_No
                            AND a.Status = 'CURR'
                WHERE    pta.ProductID IN (69)
                         AND a.Billable = 1
                GROUP BY pta.Bus_No) AS x
               ON p.BusNo = x.Bus_No
        WHERE  b.Status = 'CURR'
               AND p.ProductID IN (69)</td>
        <td>1476</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT @@ServerName AS ServerName,
               b.Bus_No AS bus_no,
               @prodTypeID AS prodTypeID,
               ISNULL(x.inViewChatMessagingEnabledAgents, 0) AS prodAmt,
               @FileType AS fileType,
               @StorageType AS storageType,
               CONVERT (DATETIME, CONVERT (NVARCHAR, GETUTCDATE(), 101)) AS queryDate
        FROM   dbo.Business_Unit AS b
               INNER JOIN
               dbo.Business_Unit_Products AS p
               ON b.Bus_No = p.BusNo
               LEFT OUTER JOIN
               (SELECT   pta.Bus_No,
                         COUNT(DISTINCT a.Agent_No) AS inViewChatMessagingEnabledAgents
                FROM     dbo.ProductTeamAssignments AS pta
                         INNER JOIN
                         dbo.Team AS t
                         ON pta.Team_No = t.Team_No
                            AND t.Status = 'CURR'
                         INNER JOIN
                         dbo.Agents AS a
                         ON pta.Team_No = a.Team_No
                            AND a.Status = 'CURR'
                WHERE    pta.ProductID IN (70)
                         AND a.Billable = 1
                GROUP BY pta.Bus_No) AS x
               ON p.BusNo = x.Bus_No
        WHERE  b.Status = 'CURR'
               AND p.ProductID IN (70)</td>
        <td>1507</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT @@ServerName AS ServerName,
               b.Bus_No AS bus_no,
               @prodTypeID AS prodTypeID,
               ISNULL(x.inViewCoachingAndLMSEnabledAgents, 0) AS prodAmt,
               @FileType AS fileType,
               @StorageType AS storageType,
               CONVERT (DATETIME, CONVERT (NVARCHAR, GETUTCDATE(), 101)) AS queryDate
        FROM   dbo.Business_Unit AS b
               INNER JOIN
               dbo.Business_Unit_Products AS p
               ON b.Bus_No = p.BusNo
               LEFT OUTER JOIN
               (SELECT   pta.Bus_No,
                         COUNT(DISTINCT a.Agent_No) AS inViewCoachingAndLMSEnabledAgents
                FROM     dbo.ProductTeamAssignments AS pta
                         INNER JOIN
                         dbo.Team AS t
                         ON pta.Team_No = t.Team_No
                            AND t.Status = 'CURR'
                         INNER JOIN
                         dbo.Agents AS a
                         ON pta.Team_No = a.Team_No
                            AND a.Status = 'CURR'
                WHERE    pta.ProductID IN (71)
                         AND a.Billable = 1
                GROUP BY pta.Bus_No) AS x
               ON p.BusNo = x.Bus_No
        WHERE  b.Status = 'CURR'
               AND p.ProductID IN (71)</td>
        <td>1538</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 eru.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 SUM(eru.EmailsSent) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.AutoOutboundEmailRollUp AS eru
                 INNER JOIN
                 #dateRange AS r
                 ON eru.UTCStartDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = eru.bus_no
                    AND b.Status = 'CURR'
        GROUP BY eru.Bus_No, r.CurrentDate</td>
        <td>1569</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT @@ServerName AS ServerName,
               b.Bus_No AS bus_no,
               @prodTypeID AS prodTypeID,
               ISNULL(x.CEAConfiguredAgents, 0) AS prodAmt,
               @FileType AS fileType,
               @StorageType AS storageType,
               CONVERT (DATETIME, CONVERT (NVARCHAR, GETUTCDATE(), 101)) AS queryDate
        FROM   dbo.Business_Unit AS b
               INNER JOIN
               dbo.Business_Unit_Products AS p
               ON b.Bus_No = p.BusNo
               LEFT OUTER JOIN
               (SELECT   pta.Bus_No,
                         COUNT(DISTINCT a.Agent_No) AS CEAConfiguredAgents
                FROM     dbo.ProductTeamAssignments AS pta
                         INNER JOIN
                         dbo.Team AS t
                         ON pta.Team_No = t.Team_No
                            AND t.Status = 'CURR'
                         INNER JOIN
                         dbo.Agents AS a
                         ON pta.Team_No = a.Team_No
                            AND a.Status = 'CURR'
                WHERE    pta.ProductID IN (72)
                         AND a.Billable = 1
                GROUP BY pta.Bus_No) AS x
               ON p.BusNo = x.Bus_No
        WHERE  b.Status = 'CURR'
               AND p.ProductID IN (72)</td>
        <td>1591</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID = 76
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>1654</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID = 80
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>1678</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID = 79
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>1702</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID = 84
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>1726</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID = 81
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>1750</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID = 85
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>1774</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID = 83
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>1798</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID = 86
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>1822</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID = 87
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>1846</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID = 77
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>1870</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID = 88
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>1894</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID = 89
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>1918</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 cc.BusNo AS bus_no,
                 104 AS prodTypeID,
                 MAX(cc.MaxConcurrent) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.ConcurrentContacts AS cc
                 INNER JOIN
                 #dateRange AS r
                 ON cc.UTCQtrHourStartDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON bu.bus_no = cc.BusNo
                    AND bu.Status = 'CURR'
        WHERE    cc.MediaType = 3
        GROUP BY cc.busno, r.CurrentDate</td>
        <td>1942</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 cc.BusNo AS bus_no,
                 106 AS prodTypeID,
                 MAX(cc.MaxConcurrent) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.ConcurrentContacts AS cc
                 INNER JOIN
                 #dateRange AS r
                 ON cc.UTCQtrHourStartDate BETWEEN r.UTCStartCurrentDate AND r.UTCEndCurrentDate
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON bu.bus_no = cc.BusNo
                    AND bu.Status = 'CURR'
        WHERE    cc.MediaType = 1
        GROUP BY cc.busno, r.CurrentDate</td>
        <td>1965</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID = 90
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>1988</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID = 91
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>2012</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID = 94
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>2036</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.Bus_No AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.agent_no) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 GETUTCDATE() AS queryDate
        FROM     dbo.ProductTeamAssignments AS pta
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON pta.Bus_No = bu.bus_no
                    AND bu.Status = 'CURR'
                 INNER JOIN
                 dbo.team AS t
                 ON t.team_no = pta.team_no
                    AND t.Status = 'CURR'
                 INNER JOIN
                 dbo.Agents AS a
                 ON pta.Team_no = a.Team_no
                    AND a.Status = 'CURR'
        WHERE    pta.ProductID = 95
                 AND a.Billable = 1
        GROUP BY a.Bus_No</td>
        <td>2060</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 ab.bus_no AS bus_no,
                 @prodTypeID AS prodTypeID,
                 MAX(CEILING(ab.StorageAmnt / 1073741824.0)) AS prodAmt,
                 ab.FileType AS fileType,
                 ab.StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.AWSBilling AS ab
                 INNER JOIN
                 #dateRange AS r
                 ON dbo.fn_RemoveTime(ab.CaptureDate) = r.CurrentDate
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON bu.bus_no = ab.bus_no
                    AND bu.Status = 'CURR'
        WHERE    ab.StorageType = 'Archive'
        GROUP BY ab.bus_no, r.CurrentDate, ab.FileType, ab.StorageType</td>
        <td>2084</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 ab.bus_no AS bus_no,
                 @prodTypeID AS prodTypeID,
                 CEILING(SUM(ab.StorageAmnt / 1073741824.0)) AS prodAmt,
                 ab.FileType AS fileType,
                 ab.StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     dbo.AWSBilling AS ab
                 INNER JOIN
                 #dateRange AS r
                 ON dbo.fn_RemoveTime(ab.CaptureDate) = r.CurrentDate
                 INNER JOIN
                 dbo.business_unit AS bu
                 ON bu.bus_no = ab.bus_no
                    AND bu.Status = 'CURR'
        WHERE    ab.StorageType = 'Archive Retrieval'
        GROUP BY ab.bus_no, r.CurrentDate, ab.FileType, ab.StorageType</td>
        <td>2107</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.bus_no AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT a.ID1) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 @CurrentDate AS queryDate
        FROM     #tmpAuditHistory AS a
                 INNER JOIN
                 #tmpAgentPrivAudit AS p
                 ON a.ID1 = p.ID1
                 INNER JOIN
                 #dateRange AS r
                 ON r.CurrentDate BETWEEN a.StartDay AND a.EndDay
                    AND r.CurrentDate BETWEEN p.StartDay AND p.EndDay
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = a.bus_no
                    AND b.Status = 'CURR'
        WHERE    a.NewValue = 'CURR'
                 AND p.NewValue LIKE '%SUP%'
        GROUP BY a.bus_no, r.CurrentDate</td>
        <td>2160</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.bus_no AS bus_no,
                 @prodTypeID AS prodTypeID,
                 1 AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     #tmpAuditHistory AS a
                 INNER JOIN
                 #dateRange AS r
                 ON r.CurrentDate BETWEEN a.StartDay AND a.EndDay
                 INNER JOIN
                 dbo.Products AS p
                 ON a.NewValue = CONVERT (NVARCHAR (50), p.ProductID)
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = a.bus_no
                    AND b.Status = 'CURR'
        WHERE    p.ProductID = 35
        GROUP BY a.bus_no, r.CurrentDate</td>
        <td>2182</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.bus_no AS bus_no,
                 @prodTypeID AS prodTypeID,
                 MAX(CONVERT (INT, ISNULL(a.NewValue, '0'))) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     #tmpAuditHistory AS a
                 INNER JOIN
                 #dateRange AS r
                 ON r.CurrentDate BETWEEN a.StartDay AND a.EndDay
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = a.bus_no
                    AND b.Status = 'CURR'
        GROUP BY a.bus_no, r.CurrentDate</td>
        <td>2202</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT   @@ServerName AS ServerName,
                 a.bus_no AS bus_no,
                 @prodTypeID AS prodTypeID,
                 COUNT(DISTINCT ID1) AS prodAmt,
                 @FileType AS fileType,
                 @StorageType AS storageType,
                 r.CurrentDate AS queryDate
        FROM     #tmpAuditHistory AS a
                 INNER JOIN
                 #dateRange AS r
                 ON r.CurrentDate BETWEEN a.StartDay AND a.EndDay
                 INNER JOIN
                 dbo.business_unit AS b
                 ON b.bus_no = a.bus_no
                    AND b.Status = 'CURR'
        WHERE    a.NewValue = @CountValue
        GROUP BY a.bus_no, r.CurrentDate</td>
        <td>2219</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR FAST_FORWARD
    FOR SELECT CurrentDate
        FROM   #dateRange</td>
        <td>2258</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">FETCH CURSOR</td>
        <td colspan="1">FETCH NEXT FROM DateRangeCursor INTO @Date, @BusNo</td>
        <td>190</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM DateRangeCursor INTO @Date, @BusNo</td>
        <td>216</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM product_cur INTO @ServerName, @Bus_No, @ProdTypeID, @ProdAmt, @FileType, @StorageType, @QueryDate</td>
        <td>2238</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM product_cur INTO @ServerName, @Bus_No, @ProdTypeID, @ProdAmt, @FileType, @StorageType, @QueryDate</td>
        <td>2247</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM date_cur INTO @CurrentDate</td>
        <td>2263</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM date_cur INTO @CurrentDate</td>
        <td>2268</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">@@fetch_status</td>
        <td colspan="1">@@Fetch_Status</td>
        <td>192</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@fetch_status</td>
        <td>2241</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@FETCH_STATUS</td>
        <td>2265</td>
      </tr>
      <tr valign="top">
        <td colspan="1">INSERT EXEC</td>
        <td colspan="1">INSERT INTO #TmpConcurrentAgentCount (Date, FairPeak, AgentPeak)
EXECUTE dbo.GetConcurrentAgentCountForRange @BusNo = @BusNo, @TimeZoneStartDate = @Date, @TimeZoneEndDate = @Date, @TimeZone = 'MOUNTAIN'</td>
        <td>202</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">INSERT INTO #tmpAuditHistory (StartDay, EndDay, NewValue, bus_no, ID1)
EXECUTE dbo.Billing_SelectAuditHistory @TableName, @ColumnName, @EndDayRange</td>
        <td>2130</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">INSERT INTO #tmpAgentPrivAudit (StartDay, EndDay, NewValue, bus_no, ID1)
EXECUTE dbo.Billing_SelectAuditHistory @TableName = 'Agent_Priv', @ColumnName = 'Priv', @EndDayRange = @EndDayRange</td>
        <td>2146</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN @prodTypeID = 17 THEN t.FairPeak WHEN @prodTypeID = 46 THEN t.AgentPeak END</td>
        <td>226</td>
      </tr>
      <tr valign="top">
        <td colspan="1">DISTINCT</td>
        <td colspan="1">COUNT(DISTINCT [AuditICCentralUserLogin].Agent_No)</td>
        <td>449</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>515</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>541</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>564</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>588</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>611</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>643</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>666</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>690</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>714</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>759</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>783</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>807</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.Agent_No)</td>
        <td>839</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>862</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>886</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>910</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>934</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>958</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>1025</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>1049</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>1073</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.Agent_No)</td>
        <td>1457</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.Agent_No)</td>
        <td>1488</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.Agent_No)</td>
        <td>1519</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.Agent_No)</td>
        <td>1550</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.Agent_No)</td>
        <td>1603</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>1658</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>1682</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>1706</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>1730</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>1754</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>1778</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>1802</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>1826</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>1850</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>1874</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>1898</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>1922</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>1992</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>2016</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>2040</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.agent_no)</td>
        <td>2064</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT a.ID1)</td>
        <td>2163</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COUNT(DISTINCT ID1)</td>
        <td>2222</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">LIKE</td>
        <td colspan="1">p.NewValue LIKE '%SUP%'</td>
        <td>2173</td>
      </tr>
    </table>
  </body>
</html>