<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [DWCode].[NICE_HistoricalGetQueueData]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [DWCode].[NICE_HistoricalGetQueueData]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 5:10 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT DISTINCT clf.Contact_Id
INTO   #Contacts
FROM   dbo.Contact_Log_Footer AS clf
WHERE  clf.Bus_No = @p_Bus_No
       AND clf.End_Date &gt;= @p_UTCStart_Date
       AND clf.End_Date &lt;= @p_UTCEnd_Date</td>
        <td>32</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT h.Bus_no,
       f.End_Date,
       k.Skill_No,
       m.Media_Type,
       k.Outbound_Skill,
       h.ReskillIndicator,
       s.InQueue_Time,
       s.InQueue_Seconds,
       s.IsShortAbandon,
       k.WFOCountReskills,
       s.Total_Time,
       s.Total_Seconds,
       s.Agent_Time,
       s.Agent_Seconds,
       s.Abandon_Time,
       s.Abandon_Seconds,
       s.ACW_Time,
       s.ACW_Seconds,
       s.PreQueue_Time,
       s.PreQueue_Seconds,
       s.sla,
       k.sla_Seconds,
       f.agent_no,
       h.contact_id,
       CASE WHEN r.Contact_ID IS NOT NULL THEN 1 ELSE 0 END AS Refused
INTO   #ContactStats
FROM   #Contacts AS c
       INNER JOIN
       dbo.Contact_Log_Header AS h
       ON c.Contact_Id = h.Contact_Id
          AND h.reskillindicator NOT IN (3, 4)
       INNER JOIN
       dbo.Contact_Log_Footer AS f
       ON c.Contact_Id = f.Contact_Id
       INNER JOIN
       dbo.Contact_Log_Summary AS s
       ON h.Contact_ID = s.Contact_ID
       INNER JOIN
       dbo.Skills AS k
       ON k.Skill_No = f.Skill_No
          AND COALESCE (k.IsNaturalCalling, 0) = 0
          AND COALESCE (k.IsDialer, 0) = 0
          AND k.Outbound_Skill = 0
       INNER JOIN
       dbo.Media AS m
       ON m.Media_Type = k.Media_Type
       LEFT OUTER JOIN
       (SELECT DISTINCT RCL.Contact_ID
        FROM   dbo.RefusedContactLog AS RCL
        WHERE  bus_no = @p_Bus_No) AS r
       ON h.contact_id = r.Contact_ID
WHERE  h.Bus_No = @p_Bus_no</td>
        <td>39</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">SELECT Bus_No,
       Contact_Id,
       dbo.fn_CalcQtrHourDateTime(start_date) AS StartDate,
       Skill_No,
       Outbound_Skill,
       Media_Type
INTO   #ContactIDs
FROM   (SELECT h.Bus_No,
               h.Contact_Id,
               h.start_date,
               k.Skill_No,
               k.Outbound_Skill,
               k.Media_Type
        FROM   dbo.Contact_Log_Header AS h
               INNER JOIN
               dbo.Contact_Log_Footer AS f
               ON f.contact_id = h.contact_id
               INNER JOIN
               dbo.Skills AS k
               ON f.Skill_No = k.Skill_No
                  AND k.Outbound_Skill = 0
        WHERE  h.Bus_no = @p_Bus_No
               AND h.start_date &gt;= @P_UTCStart_Date
               AND h.start_date &lt;= @p_UTCEnd_Date
               AND h.Media_Type IN (1, 6)
        UNION ALL
        SELECT r.Bus_No,
               r.Contact_Id,
               r.start_date,
               k.Skill_No,
               k.Outbound_Skill,
               k.Media_Type
        FROM   dbo.RT_Contact_Log AS r
               INNER JOIN
               dbo.Skills AS k
               ON r.Skill_No = k.Skill_No
                  AND k.Outbound_Skill = 0
        WHERE  r.Bus_no = @p_Bus_No
               AND r.start_date &gt;= @P_UTCStart_Date
               AND r.start_date &lt;= @p_UTCEnd_Date
               AND r.Media_Type IN (1, 6)
        UNION ALL
        SELECT DISTINCT p.Bus_No,
                        p.Contact_Id,
                        p.start_date,
                        k.Skill_No,
                        k.Outbound_Skill,
                        k.Media_Type
        FROM   dbo.PersistentContactLog AS p
               INNER JOIN
               dbo.Skills AS k
               ON p.Skill_No = k.Skill_No
                  AND k.Outbound_Skill = 0
        WHERE  p.Bus_no = @p_Bus_No
               AND p.start_date &gt;= @P_UTCStart_Date
               AND p.start_date &lt;= @p_UTCEnd_Date
               AND p.Media_Type IN (1, 6)) AS c</td>
        <td>257</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">SELECT   [Date] AS [QtrHour],
         [Skill_No] AS [Skill],
         [CallCount] AS [Received],
         [Handled] AS [Handled],
         [AbandonCount] AS [Abandoned],
         [HandledWithinSL] AS [Handled-GOS],
         [AbandonedWithinSL] AS [Abandoned-GOS],
         TotalAgentTime AS [HandleTime],
         [WrapUpTime] AS [WrapTime],
         [Handled] AS [Distributed],
         [QueueTime] AS [QueueTime],
         [ServiceLevel] AS [ServiceLevel],
         0 AS [BackLog],
         0 AS [BackLogNotExp],
         0 AS [BackLogExp],
         [AverageSpeedOfAnswer] AS [AverageSpeedOfAnswer],
         [AverageHandleTime] AS [AverageHandleTime]
INTO     #Results
FROM     #ContactStatsSummary
ORDER BY DATE</td>
        <td>384</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN r.Contact_ID IS NOT NULL THEN 1 ELSE 0 END</td>
        <td>66</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ReskillIndicator IN (1, 2)) THEN CASE WHEN (ISNULL(InQueue_time, 0) &gt; 0
                                                       AND isShortAbandon = 0
                                                       AND WFOCountReskills = 1) THEN 1 ELSE 0 END ELSE CASE WHEN (ISNULL(InQueue_time, 0) &gt; 0
                                                                                                                   AND isShortAbandon = 0) THEN 1 ELSE 0 END END</td>
        <td>99</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(InQueue_time, 0) &gt; 0
           AND isShortAbandon = 0
           AND WFOCountReskills = 1) THEN 1 ELSE 0 END</td>
        <td>100</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(InQueue_time, 0) &gt; 0
           AND isShortAbandon = 0) THEN 1 ELSE 0 END</td>
        <td>102</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ReskillIndicator IN (1, 2)) THEN CASE WHEN ((ISNULL(Agent_Time, 0) &gt; 0
                                                        AND WFOCountReskills = 1
                                                        AND Agent_No IS NOT NULL
                                                        AND ISNULL(Abandon_Time, 0) = 0)) THEN 1 ELSE 0 END ELSE CASE WHEN ((ISNULL(Agent_Time, 0) &gt; 0
                                                                                                                             AND Agent_No IS NOT NULL
                                                                                                                             AND ISNULL(Abandon_Time, 0) = 0)) THEN 1 ELSE 0 END END</td>
        <td>105</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ((ISNULL(Agent_Time, 0) &gt; 0
            AND WFOCountReskills = 1
            AND Agent_No IS NOT NULL
            AND ISNULL(Abandon_Time, 0) = 0)) THEN 1 ELSE 0 END</td>
        <td>106</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ((ISNULL(Agent_Time, 0) &gt; 0
            AND Agent_No IS NOT NULL
            AND ISNULL(Abandon_Time, 0) = 0)) THEN 1 ELSE 0 END</td>
        <td>108</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ReskillIndicator IN (1, 2)) THEN CASE WHEN (ISNULL(Abandon_Time, 0) &gt; 0
                                                       AND isShortAbandon = 0
                                                       AND WFOCountReskills = 1
                                                       AND (Agent_Time = 0
                                                            OR (Agent_Time &gt; 0
                                                                AND Agent_No IS NULL
                                                                AND WFOCountReskills = 1)
                                                            OR (Agent_Time &gt; 0
                                                                AND Abandon_Time &gt; 0
                                                                AND WFOCountReskills = 1
                                                                AND isShortAbandon = 0))
                                                       OR (Refused = 1
                                                           AND inQueue_Time &gt; 0
                                                           AND Agent_No IS NULL
                                                           AND Agent_Time &gt; 0
                                                           AND Abandon_Time = 0
                                                           AND WFOCountReskills = 1
                                                           AND isShortAbandon = 0)
                                                       OR (inQueue_Time &gt; 0
                                                           AND Agent_Time = 0
                                                           AND Abandon_Time = 0
                                                           AND WFOCountReskills = 1
                                                           AND isShortAbandon = 0)) THEN 1 ELSE 0 END ELSE CASE WHEN (ISNULL(Abandon_Time, 0) &gt; 0
                                                                                                                      AND isShortAbandon = 0
                                                                                                                      AND (Agent_Time = 0
                                                                                                                           OR (Agent_Time &gt; 0
                                                                                                                               AND Agent_No IS NULL)
                                                                                                                           OR (Agent_Time &gt; 0
                                                                                                                               AND Abandon_Time &gt; 0
                                                                                                                               AND isShortAbandon = 0))
                                                                                                                      OR (Refused = 1
                                                                                                                          AND inQueue_Time &gt; 0
                                                                                                                          AND Agent_No IS NULL
                                                                                                                          AND Agent_Time &gt; 0
                                                                                                                          AND Abandon_Time = 0
                                                                                                                          AND isShortAbandon = 0))
                                                                                                                     OR (inQueue_Time &gt; 0
                                                                                                                         AND Agent_Time = 0
                                                                                                                         AND Abandon_Time = 0
                                                                                                                         AND isShortAbandon = 0) THEN 1 ELSE 0 END END</td>
        <td>114</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(Abandon_Time, 0) &gt; 0
           AND isShortAbandon = 0
           AND WFOCountReskills = 1
           AND (Agent_Time = 0
                OR (Agent_Time &gt; 0
                    AND Agent_No IS NULL
                    AND WFOCountReskills = 1)
                OR (Agent_Time &gt; 0
                    AND Abandon_Time &gt; 0
                    AND WFOCountReskills = 1
                    AND isShortAbandon = 0))
           OR (Refused = 1
               AND inQueue_Time &gt; 0
               AND Agent_No IS NULL
               AND Agent_Time &gt; 0
               AND Abandon_Time = 0
               AND WFOCountReskills = 1
               AND isShortAbandon = 0)
           OR (inQueue_Time &gt; 0
               AND Agent_Time = 0
               AND Abandon_Time = 0
               AND WFOCountReskills = 1
               AND isShortAbandon = 0)) THEN 1 ELSE 0 END</td>
        <td>115</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(Abandon_Time, 0) &gt; 0
           AND isShortAbandon = 0
           AND (Agent_Time = 0
                OR (Agent_Time &gt; 0
                    AND Agent_No IS NULL)
                OR (Agent_Time &gt; 0
                    AND Abandon_Time &gt; 0
                    AND isShortAbandon = 0))
           OR (Refused = 1
               AND inQueue_Time &gt; 0
               AND Agent_No IS NULL
               AND Agent_Time &gt; 0
               AND Abandon_Time = 0
               AND isShortAbandon = 0))
          OR (inQueue_Time &gt; 0
              AND Agent_Time = 0
              AND Abandon_Time = 0
              AND isShortAbandon = 0) THEN 1 ELSE 0 END</td>
        <td>127</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ReskillIndicator IN (1, 2)) THEN CASE WHEN ISNULL(Agent_time, 0) &gt; 0
                                                      AND Agent_No IS NOT NULL
                                                      AND WFOCountReskills = 1
                                                      AND sla &lt; 1
                                                      OR (ISNULL(Agent_time, 0) = 0
                                                          AND ISNULL(InQueue_time, 0) &gt; 0
                                                          AND ISNULL(Abandon_time, 0) = 0
                                                          AND isShortAbandon = 0
                                                          AND WFOCountReskills = 1
                                                          AND sla &lt; 1) THEN 1 ELSE 0 END ELSE CASE WHEN ISNULL(Agent_time, 0) &gt; 0
                                                                                                        AND Agent_No IS NOT NULL
                                                                                                        AND sla &lt; 1
                                                                                                        OR (ISNULL(Agent_time, 0) = 0
                                                                                                            AND ISNULL(InQueue_time, 0) &gt; 0
                                                                                                            AND ISNULL(Abandon_time, 0) = 0
                                                                                                            AND isShortAbandon = 0
                                                                                                            AND sla &lt; 1) THEN 1 ELSE 0 END END</td>
        <td>133</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ISNULL(Agent_time, 0) &gt; 0
          AND Agent_No IS NOT NULL
          AND WFOCountReskills = 1
          AND sla &lt; 1
          OR (ISNULL(Agent_time, 0) = 0
              AND ISNULL(InQueue_time, 0) &gt; 0
              AND ISNULL(Abandon_time, 0) = 0
              AND isShortAbandon = 0
              AND WFOCountReskills = 1
              AND sla &lt; 1) THEN 1 ELSE 0 END</td>
        <td>134</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ISNULL(Agent_time, 0) &gt; 0
          AND Agent_No IS NOT NULL
          AND sla &lt; 1
          OR (ISNULL(Agent_time, 0) = 0
              AND ISNULL(InQueue_time, 0) &gt; 0
              AND ISNULL(Abandon_time, 0) = 0
              AND isShortAbandon = 0
              AND sla &lt; 1) THEN 1 ELSE 0 END</td>
        <td>138</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ReskillIndicator IN (1, 2)) THEN CASE WHEN (ISNULL(InQueue_time, 0) &gt; 0
                                                       AND WFOCountReskills = 1) THEN ISNULL(CAST (InQueue_time AS BIGINT), 0) ELSE 0 END ELSE CASE WHEN (ISNULL(InQueue_time, 0) &gt; 0) THEN ISNULL(CAST (InQueue_time AS BIGINT), 0) ELSE 0 END END</td>
        <td>147</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(InQueue_time, 0) &gt; 0
           AND WFOCountReskills = 1) THEN ISNULL(CAST (InQueue_time AS BIGINT), 0) ELSE 0 END</td>
        <td>148</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(InQueue_time, 0) &gt; 0) THEN ISNULL(CAST (InQueue_time AS BIGINT), 0) ELSE 0 END</td>
        <td>151</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ReskillIndicator IN (1, 2)) THEN CASE WHEN WFOCountReskills = 1 THEN ISNULL(CAST (Total_Time AS BIGINT), 0) ELSE 0 END ELSE ISNULL(CAST (Total_Time AS BIGINT), 0) END</td>
        <td>158</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN WFOCountReskills = 1 THEN ISNULL(CAST (Total_Time AS BIGINT), 0) ELSE 0 END</td>
        <td>159</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ReskillIndicator IN (1, 2)) THEN CASE WHEN (((ISNULL(Agent_Time, 0) &gt; 0
                                                         AND Agent_No IS NOT NULL
                                                         AND ISNULL(Abandon_Time, 0) = 0)
                                                        AND WFOCountReskills = 1)
                                                       OR (ISNULL(Agent_time, 0) = 0
                                                           AND ISNULL(InQueue_time, 0) &gt; 0
                                                           AND ISNULL(Abandon_time, 0) = 0
                                                           AND isShortAbandon = 0
                                                           AND WFOCountReskills = 1)) THEN ISNULL(CAST (Agent_time AS BIGINT), 0) ELSE 0 END ELSE CASE WHEN ((ISNULL(Agent_Time, 0) &gt; 0
                                                                                                                                                              AND Agent_No IS NOT NULL
                                                                                                                                                              AND ISNULL(Abandon_Time, 0) = 0)
                                                                                                                                                             OR (ISNULL(Agent_time, 0) = 0
                                                                                                                                                                 AND ISNULL(InQueue_time, 0) &gt; 0
                                                                                                                                                                 AND ISNULL(Abandon_time, 0) = 0
                                                                                                                                                                 AND isShortAbandon = 0)) THEN ISNULL(CAST (Agent_time AS BIGINT), 0) ELSE 0 END END</td>
        <td>164</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (((ISNULL(Agent_Time, 0) &gt; 0
             AND Agent_No IS NOT NULL
             AND ISNULL(Abandon_Time, 0) = 0)
            AND WFOCountReskills = 1)
           OR (ISNULL(Agent_time, 0) = 0
               AND ISNULL(InQueue_time, 0) &gt; 0
               AND ISNULL(Abandon_time, 0) = 0
               AND isShortAbandon = 0
               AND WFOCountReskills = 1)) THEN ISNULL(CAST (Agent_time AS BIGINT), 0) ELSE 0 END</td>
        <td>165</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ((ISNULL(Agent_Time, 0) &gt; 0
            AND Agent_No IS NOT NULL
            AND ISNULL(Abandon_Time, 0) = 0)
           OR (ISNULL(Agent_time, 0) = 0
               AND ISNULL(InQueue_time, 0) &gt; 0
               AND ISNULL(Abandon_time, 0) = 0
               AND isShortAbandon = 0)) THEN ISNULL(CAST (Agent_time AS BIGINT), 0) ELSE 0 END</td>
        <td>167</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ReskillIndicator IN (1, 2)) THEN CASE WHEN ((sla = 0
                                                        AND Agent_time &gt; 0
                                                        AND Agent_No IS NOT NULL)
                                                       AND WFOCountReskills = 1) THEN 1 ELSE 0 END ELSE CASE WHEN ((sla = 0
                                                                                                                    AND Agent_time &gt; 0
                                                                                                                    AND Agent_No IS NOT NULL)) THEN 1 ELSE 0 END END</td>
        <td>171</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ((sla = 0
            AND Agent_time &gt; 0
            AND Agent_No IS NOT NULL)
           AND WFOCountReskills = 1) THEN 1 ELSE 0 END</td>
        <td>172</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ((sla = 0
            AND Agent_time &gt; 0
            AND Agent_No IS NOT NULL)) THEN 1 ELSE 0 END</td>
        <td>174</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ReskillIndicator IN (1, 2)) THEN CASE WHEN (ISNULL(Abandon_time, 0) &lt; CONVERT (DECIMAL (19, 0), (sla_Seconds * 1000.0))
                                                       AND WFOCountReskills = 1
                                                       AND (ISNULL(Abandon_time, 0) &gt; 0
                                                            AND isShortAbandon = 0)) THEN 1 ELSE 0 END ELSE CASE WHEN (ISNULL(Abandon_time, 0) &lt; CONVERT (DECIMAL (19, 0), (sla_Seconds * 1000.0))
                                                                                                                       AND (ISNULL(Abandon_time, 0) &gt; 0
                                                                                                                            AND isShortAbandon = 0)) THEN 1 ELSE 0 END END</td>
        <td>177</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(Abandon_time, 0) &lt; CONVERT (DECIMAL (19, 0), (sla_Seconds * 1000.0))
           AND WFOCountReskills = 1
           AND (ISNULL(Abandon_time, 0) &gt; 0
                AND isShortAbandon = 0)) THEN 1 ELSE 0 END</td>
        <td>178</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(Abandon_time, 0) &lt; CONVERT (DECIMAL (19, 0), (sla_Seconds * 1000.0))
           AND (ISNULL(Abandon_time, 0) &gt; 0
                AND isShortAbandon = 0)) THEN 1 ELSE 0 END</td>
        <td>181</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ReskillIndicator IN (1, 2)) THEN CASE WHEN (ISNULL(ACW_Time, 0) &gt; 0
                                                       AND WFOCountReskills = 1) THEN ISNULL(CAST (ACW_Time AS BIGINT), 0) ELSE 0 END ELSE CASE WHEN (ISNULL(ACW_Time, 0) &gt; 0) THEN ISNULL(CAST (ACW_Time AS BIGINT), 0) ELSE 0 END END</td>
        <td>184</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(ACW_Time, 0) &gt; 0
           AND WFOCountReskills = 1) THEN ISNULL(CAST (ACW_Time AS BIGINT), 0) ELSE 0 END</td>
        <td>185</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(ACW_Time, 0) &gt; 0) THEN ISNULL(CAST (ACW_Time AS BIGINT), 0) ELSE 0 END</td>
        <td>188</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ReskillIndicator IN (1, 2)) THEN CASE WHEN (ISNULL(InQueue_time, 0) &gt; 0
                                                       AND WFOCountReskills = 1) THEN ISNULL(CAST (InQueue_time - Abandon_Time AS BIGINT), 0) ELSE 0 END ELSE CASE WHEN (ISNULL(InQueue_time, 0) &gt; 0) THEN ISNULL(CAST (InQueue_time - Abandon_Time AS BIGINT), 0) ELSE 0 END END</td>
        <td>192</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(InQueue_time, 0) &gt; 0
           AND WFOCountReskills = 1) THEN ISNULL(CAST (InQueue_time - Abandon_Time AS BIGINT), 0) ELSE 0 END</td>
        <td>193</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(InQueue_time, 0) &gt; 0) THEN ISNULL(CAST (InQueue_time - Abandon_Time AS BIGINT), 0) ELSE 0 END</td>
        <td>196</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ReskillIndicator IN (1, 2)) THEN CASE WHEN (ISNULL(InQueue_Time, 0) &gt; 0
                                                       AND isShortAbandon = 0
                                                       AND WFOCountReskills = 1) THEN 1 ELSE 0 END ELSE CASE WHEN (ISNULL(InQueue_Time, 0) &gt; 0
                                                                                                                   AND isShortAbandon = 0) THEN 1 ELSE 0 END END</td>
        <td>212</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(InQueue_Time, 0) &gt; 0
           AND isShortAbandon = 0
           AND WFOCountReskills = 1) THEN 1 ELSE 0 END</td>
        <td>214</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(InQueue_Time, 0) &gt; 0
           AND isShortAbandon = 0) THEN 1 ELSE 0 END</td>
        <td>219</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ISNULL(Handled, 0) &gt; 0 THEN (TotalAgentTime + WrapUpTime) / (Handled * 1000.0) ELSE 0.0 END</td>
        <td>227</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(Handled, 0) &gt; 0
           OR ISNULL(AbandonCount, 0) &gt; 0) THEN (ServiceLevelCount / CallCount) * 100.0 ELSE 100.0 END</td>
        <td>231</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(Handled, 0) &gt; 0
           OR ISNULL(AbandonCount, 0) &gt; 0) THEN QueueTime / 1000.0 ELSE 0 END</td>
        <td>235</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ISNULL(Handled, 0) &gt; 0 THEN AnswerTime / (Handled * 1000.0) ELSE 0.0 END</td>
        <td>238</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ISNULL(Handled, 0) &gt; 0 THEN TotalAgentTime / 1000.0 ELSE 0 END</td>
        <td>242</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ISNULL(Handled, 0) &gt; 0 THEN WrapUpTime / 1000.0 ELSE 0 END</td>
        <td>245</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN (ISNULL(Handled, 0) &gt; 0
           OR ISNULL(AbandonCount, 0) &gt; 0) THEN TotalContactTime / 1000.0 ELSE 0 END</td>
        <td>248</td>
      </tr>
      <tr valign="top">
        <td colspan="1">One-part names</td>
        <td colspan="1">#Contacts AS c</td>
        <td>68</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#ContactStatsSummary</td>
        <td>87</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#ContactStats</td>
        <td>200</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#ContactStatsSummary</td>
        <td>226</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#ContactStatsSummary</td>
        <td>324</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#ContactStatsSummary</td>
        <td>329</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#ContactStatsSummary AS c</td>
        <td>331</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#ContactIds</td>
        <td>336</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#ContactStatsSummary</td>
        <td>342</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#ContactIds AS ids</td>
        <td>365</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#ContactStatsSummary AS css</td>
        <td>366</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#ContactStatsSummary</td>
        <td>402</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#Results AS r</td>
        <td>426</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">COALESCE</td>
        <td colspan="1">COALESCE (k.IsNaturalCalling, 0)</td>
        <td>75</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">COALESCE (k.IsDialer, 0)</td>
        <td>76</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">UPDATE with FROM clause</td>
        <td colspan="1">
FROM #ContactStatsSummary AS c
     INNER JOIN
     (SELECT   COUNT(*) AS CallCount,
               StartDate,
               Skill_No
      FROM     #ContactIds
      GROUP BY StartDate, Skill_No) AS x
     ON c.Date = x.StartDate
        AND c.Skill_No = x.SKill_No</td>
        <td>331</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">
FROM #ContactIds</td>
        <td>336</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Subquery</td>
        <td colspan="1">(SELECT   COUNT(*) AS CallCount,
          StartDate,
          Skill_No
 FROM     #ContactIds
 GROUP BY StartDate, Skill_No) AS x</td>
        <td>332</td>
      </tr>
    </table>
  </body>
</html>