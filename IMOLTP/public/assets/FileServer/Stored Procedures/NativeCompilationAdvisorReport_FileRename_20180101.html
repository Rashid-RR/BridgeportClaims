<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [FileServer].[FileRename]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [FileServer].[FileRename]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 4:58 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>3</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Subquery</td>
        <td colspan="1">(SELECT f.FileNameNoPath,
        f.FilePurposeID
 FROM   dbo.FileEntry AS f WITH (INDEX (IX_FileEntry_FileState_FolderID_FileNameNoPath_INCLUDE_Bus_No_LogicalBytes_FilePurposeID))
 WHERE  f.FileState = 1
        AND f.FolderID = @NewFolderID
        AND f.FileNameNoPath = @NewFileNameNoPath
 UNION ALL
 SELECT f.FileNameNoPath,
        f.FilePurposeID
 FROM   dbo.CloudFileEntry AS f WITH (INDEX (IX_CloudFileEntry_FileState_FolderID_FileNameNoPath_INCLUDE_Bus_No_LogicalBytes_FilePurposeID))
 WHERE  f.FileState IN (1, 4)
        AND f.FolderID = @NewFolderID
        AND f.FileNameNoPath = @NewFileNameNoPath)</td>
        <td>96</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">(SELECT f.FileNameNoPath,
        f.FilePurposeID
 FROM   dbo.FileEntry AS f WITH (INDEX (IX_FileEntry_FileState_FolderID_FileNameNoPath_INCLUDE_Bus_No_LogicalBytes_FilePurposeID))
 WHERE  f.FileState = 2
        AND f.FolderID = @NewFolderID
        AND f.FileNameNoPath = @NewFileNameNoPath
 UNION ALL
 SELECT f.FileNameNoPath,
        f.FilePurposeID
 FROM   dbo.CloudFileEntry AS f WITH (INDEX (IX_CloudFileEntry_FileState_FolderID_FileNameNoPath_INCLUDE_Bus_No_LogicalBytes_FilePurposeID))
 WHERE  f.FileState = 2
        AND f.FolderID = @NewFolderID
        AND f.FileNameNoPath = @NewFileNameNoPath)</td>
        <td>119</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">REPLACE</td>
        <td colspan="1">Replace(Replace(CONVERT (NVARCHAR, GetUTCDate(), 121), ':', '_'), ' ', '_')</td>
        <td>132</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">Replace(CONVERT (NVARCHAR, GetUTCDate(), 121), ':', '_')</td>
        <td>132</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">f</td>
        <td>159</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#UpdatedFileEntryIDs</td>
        <td>164</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">f</td>
        <td>178</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#UpdatedFileEntryIDs</td>
        <td>184</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">f</td>
        <td>192</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#UpdatedCloudFileEntryIDs</td>
        <td>197</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">f</td>
        <td>203</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#UpdatedCloudFileEntryIDs</td>
        <td>209</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">dq</td>
        <td>219</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#UpdatedFileEntryIDs AS fe</td>
        <td>221</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">dq</td>
        <td>228</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#UpdatedCloudFileEntryIDs AS fe</td>
        <td>230</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">UPDATE with FROM clause</td>
        <td colspan="1">
FROM dbo.FileEntry AS f WITH (INDEX (IX_FileEntry_FileState_FolderID_FileNameNoPath_INCLUDE_Bus_No_LogicalBytes_FilePurposeID))</td>
        <td>165</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">
FROM dbo.FileEntry AS f WITH (INDEX (IX_FileEntry_FileState_FolderID_FileNameNoPath_INCLUDE_Bus_No_LogicalBytes_FilePurposeID))</td>
        <td>185</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">
FROM dbo.CloudFileEntry AS f WITH (INDEX (IX_CloudFileEntry_FileState_FolderID_FileNameNoPath_INCLUDE_Bus_No_LogicalBytes_FilePurposeID))</td>
        <td>198</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">
FROM dbo.CloudFileEntry AS f WITH (INDEX (IX_CloudFileEntry_FileState_FolderID_FileNameNoPath_INCLUDE_Bus_No_LogicalBytes_FilePurposeID))</td>
        <td>210</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">
FROM #UpdatedFileEntryIDs AS fe
     INNER JOIN
     dbo.DistributionQueue AS dq
     ON dq.FileEntryID = fe.FileEntryID
     INNER JOIN
     dbo.DistributionTarget AS dt
     ON dt.DistributionTargetID = dq.DistributionTargetID</td>
        <td>221</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">
FROM #UpdatedCloudFileEntryIDs AS fe
     INNER JOIN
     dbo.DistributionQueue AS dq
     ON dq.CloudFileEntryID = fe.CloudFileEntryID
     INNER JOIN
     dbo.DistributionTarget AS dt
     ON dt.DistributionTargetID = dq.DistributionTargetID</td>
        <td>230</td>
      </tr>
    </table>
  </body>
</html>