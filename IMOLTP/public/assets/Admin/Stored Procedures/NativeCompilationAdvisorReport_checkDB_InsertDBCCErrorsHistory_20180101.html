<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [Admin].[checkDB_InsertDBCCErrorsHistory]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [Admin].[checkDB_InsertDBCCErrorsHistory]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 4:59 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>1</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SET OPTION OFF</td>
        <td colspan="1">SET ANSI_WARNINGS OFF</td>
        <td>1</td>
      </tr>
      <tr valign="top">
        <td colspan="1">OBJECT_ID</td>
        <td colspan="1">OBJECT_ID('dbo.DBCCErrorsHistory')</td>
        <td>18</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Cursors</td>
        <td colspan="1">CURSOR
    FOR SELECT   name
        FROM     sys.databases
        WHERE    DATABASEPROPERTYEX(name, 'Status') = 'ONLINE'
                 AND DATABASEPROPERTYEX(name, 'IsInStandBy') = 0
                 AND DATABASEPROPERTYEX(name, 'Updateability') = 'READ_WRITE'
                 AND user_access_desc = 'MULTI_USER'
        ORDER BY name</td>
        <td>85</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR
    FOR SELECT   DatabaseName
        FROM     #dbSizesFinal
        ORDER BY DatabaseName</td>
        <td>128</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">DATABASEPROPERTYEX</td>
        <td colspan="1">DATABASEPROPERTYEX(name, 'Status')</td>
        <td>86</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">DATABASEPROPERTYEX(name, 'IsInStandBy')</td>
        <td>87</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">DATABASEPROPERTYEX(name, 'Updateability')</td>
        <td>88</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">DATABASEPROPERTYEX(DatabaseName, 'Recovery')</td>
        <td>108</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">FETCH CURSOR</td>
        <td colspan="1">FETCH NEXT FROM ACT_CURS_dbSizes INTO @name</td>
        <td>94</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM ACT_CURS_dbSizes INTO @name</td>
        <td>104</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM ACT_CURS INTO @name</td>
        <td>133</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM ACT_CURS INTO @name</td>
        <td>160</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">@@fetch_status</td>
        <td colspan="1">@@fetch_status</td>
        <td>95</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@fetch_status</td>
        <td>134</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">@@servername</td>
        <td colspan="1">@@servername</td>
        <td>97</td>
      </tr>
      <tr valign="top">
        <td colspan="1">EXECUTE string</td>
        <td colspan="1">EXECUTE (@sql)</td>
        <td>103</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SELECT INTO</td>
        <td colspan="1">SELECT   DatabaseName,
         DATABASEPROPERTYEX(DatabaseName, 'Recovery') AS RecoveryModel,
         sum(MBUsed) AS sumMB
INTO     #dbSizesFinal
FROM     #dbSizes
WHERE    filename NOT LIKE '%.ldf'
GROUP BY server, databasename
ORDER BY sum(mbused / 1024.0) DESC</td>
        <td>108</td>
      </tr>
      <tr valign="top">
        <td colspan="1">One-part names</td>
        <td colspan="1">#dbSizes</td>
        <td>111</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dbSizesFinal</td>
        <td>116</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dbSizesFinal</td>
        <td>119</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#dbSizesFinal</td>
        <td>123</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#dbSizesFinal</td>
        <td>129</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#DBCCErrors</td>
        <td>137</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#DBCCErrors</td>
        <td>165</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#DBCCErrors</td>
        <td>208</td>
      </tr>
      <tr valign="top">
        <td colspan="1">LIKE</td>
        <td colspan="1">filename NOT LIKE '%.ldf'</td>
        <td>112</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">INSERT EXEC</td>
        <td colspan="1">INSERT INTO #DBCCErrors ([error], [level], [state], [MessageText], [RepairLevel], [status], [dbid], [id], [IndId], [PartitionID], [AllocUnitID], [file], [page], [slot], [reffile], [refpage], [refslot], [allocation])
EXECUTE ('use [' + @name + '] DBCC CHECKDB WITH TABLERESULTS, NO_INFOMSGS, DATA_PURITY')</td>
        <td>137</td>
      </tr>
      <tr valign="top">
        <td colspan="1">Subquery</td>
        <td colspan="1">(SELECT count(*)
 FROM   #DBCCErrors)</td>
        <td>165</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SERVERPROPERTY</td>
        <td colspan="1">SERVERPROPERTY('MachineName')</td>
        <td>207</td>
      </tr>
    </table>
  </body>
</html>