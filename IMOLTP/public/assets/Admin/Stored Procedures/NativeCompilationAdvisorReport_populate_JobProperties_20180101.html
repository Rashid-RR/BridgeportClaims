<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [Admin].[populate_JobProperties]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [Admin].[populate_JobProperties]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 4:59 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>19</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">@@version</td>
        <td colspan="1">@@VERSION</td>
        <td>21</td>
      </tr>
      <tr valign="top">
        <td colspan="1">EXECUTE string</td>
        <td colspan="1">EXECUTE ('  
  DECLARE @JOB_ID VARCHAR(200),  
        @SCHED_ID VARCHAR(200),  
        @FREQ_TYPE INT,  
        @FREQ_INTERVAL INT,  
        @FREQ_SUBDAY_TYPE INT,  
        @FREQ_SUBDAY_INTERVAL INT,  
        @FREQ_RELATIVE_INTERVAL INT,  
        @FREQ_RECURRENCE_FACTOR INT,  
        @ACTIVE_START_DATE INT,  
        @SCHEDULE VARCHAR(1000),  
        @SCHEDULE_DAY VARCHAR(200),  
        @START_TIME VARCHAR(10),  
        @END_TIME VARCHAR(10)  
  
    IF ( OBJECT_ID(''dbo.JobProperties_temp'') ) IS NULL   
        CREATE TABLE dbo.JobProperties_temp  
            (  
              JOB_ID VARCHAR(200),  
              SCHED_ID VARCHAR(200),  
              JOB_NAME SYSNAME,  
     CategoryName SYSNAME,  
              JobEnabled INT,  
              ScheduleEnabled INT NULL,  
              schedule VARCHAR(1000) NULL,  
              FREQ_TYPE INT NULL,  
              FREQ_INTERVAL INT NULL,  
              FREQ_SUBDAY_TYPE INT NULL,  
              FREQ_SUBDAY_INTERVAL INT NULL,  
              FREQ_RELATIVE_INTERVAL INT NULL,  
              FREQ_RECURRENCE_FACTOR INT NULL,  
              ACTIVE_START_DATE INT NULL,  
              ACTIVE_END_DATE INT NULL,  
              ACTIVE_START_TIME INT NULL,  
              ACTIVE_END_TIME INT NULL,  
              DATE_CREATED DATETIME NULL,  
              JOB_OWNER VARCHAR(200)  
            )  
  
    truncate TABLE JobProperties_temp  
  
  
   INSERT  INTO JobProperties_temp  
                    (  
                      job_id,  
                      sched_id,  
                      job_name,  
       CategoryName,  
                      JobEnabled,  
                      ScheduleEnabled,  
                      schedule,  
                      freq_type,  
                      freq_interval,  
                      freq_subday_type,  
                      freq_subday_interval,  
                      freq_relative_interval,  
                      freq_recurrence_factor,  
                      active_start_date,  
                      active_end_date,  
                      active_start_time,  
                      active_end_time,  
                      date_created,  
                      job_owner  
                    )  
                    SELECT  j.job_id,  
                            sched.schedule_id,  
                            j.name,  
                            c.NAME CatName,  
                            j.enabled,  
                            sched.enabled,  
                            NULL,  
                            sched.freq_type,  
                         sched.freq_interval,  
                            sched.freq_subday_type,  
                            sched.freq_subday_interval,  
                            sched.freq_relative_interval,  
                            sched.freq_recurrence_factor,  
                            sched.active_start_date,  
                            sched.active_end_date,  
                            sched.active_start_time,  
                            sched.active_end_time,  
                            j.date_created,  
                            SUSER_SNAME(j.owner_sid)  
                    FROM    msdb.dbo.sysjobs j JOIN msdb.dbo.syscategories c ON j.category_id=c.category_id  
                            left join msdb.dbo.sysJobSchedules s ON j.job_id = s.job_id  
                            left JOIN msdb.dbo.sysschedules sched ON s.schedule_id = sched.schedule_id  
  
            WHILE 1 = 1  
  
                BEGIN  
  
                    SET @SCHEDULE = ''''  
  
                    IF ( SELECT COUNT(*)  
                         FROM   JobProperties_temp  
                         WHERE  ScheduleEnabled = 1  
                                and schedule is null  
                       ) = 0   
                        BREAK  
  
                    ELSE   
                        BEGIN  
  
        SELECT  @job_id = job_id,  
                                    @sched_id = sched_id,  
                                    @freq_type = freq_type,  
                                    @Freq_Interval = freq_interval,  
                                    @freq_subday_type = freq_subday_type,  
                                    @freq_subday_interval = freq_subday_interval,  
                                    @freq_relative_interval = freq_relative_interval,  
                                    @freq_recurrence_factor = freq_recurrence_factor,  
                                    @active_start_date = active_start_date,  
                                    @start_time = CASE WHEN LEFT(active_start_time, 2) IN (  
                                                            22, 23 )  
                                                            AND len(active_start_time) = 6  
                                                       THEN convert(varchar(2), left(active_start_time, 2)  
                                                            - 12) + '':''  
                                                            + SUBSTRING(CAST(active_start_time AS CHAR), 3, 2)  
                                                            + '' P.M''  
                                                       WHEN left(active_start_time, 2) = ( 12 )  
                                                            AND len(active_start_time) = 6  
                                                       THEN cast(LEFT(active_start_time, 2) as char(2))  
                                                            + '':''  
                                                            + SUBSTRING(CAST(active_start_time AS CHAR), 3, 2)  
                                                            + '' P.M.''  
                                                       WHEN left(active_start_time, 2) BETWEEN 13 AND 24  
                                                            AND len(active_start_time) = 6  
                                                       THEN convert(varchar(2), left(active_start_time, 2)  
                                                            - 12) + '':''  
                                                            + SUBSTRING(CAST(active_start_time AS CHAR), 3, 2)  
                                                            + '' P.M.''  
                                                       WHEN left(active_start_time, 2) IN (  
                                                            10, 11 )  
                         AND len(active_start_time) = 6  
                                                       THEN cast(LEFT(active_start_time, 2) as char(2))  
                                                            + '':''  
                                                            + SUBSTRING(CAST(active_start_time AS CHAR), 3, 2)  
                                                            + '' A.M.''  
                                                       WHEN active_start_time = 0  
                                                       THEN ''12:00 A.M.''  
                       WHEN LEN(active_start_time) = 4  
                                                       THEN ''12:''  
                                                            + convert(varchar(2), left(active_start_time, 2))  
                                                            + '' A.M.''  
                                                       WHEN LEN(active_start_time) = 3  
                                                       THEN ''12:0''  
                                                            + convert(varchar(2), left(active_start_time, 1))  
                                                            + '' A.M.''  
                                                       WHEN LEN(active_start_time) = 2  
                                                       THEN ''12:00:''  
                                             + convert(varchar(2), left(active_start_time, 2))  
                                                            + '' A.M.''  
                                                       WHEN LEN(active_start_time) = 1  
                                                       THEN ''12:00:0''  
                                                            + convert(varchar(2), left(active_start_time, 2))  
                                                            + '' A.M.''  
                                                       ELSE cast(LEFT(active_start_time, 1) as char(1))  
                                                            + '':''  
                                                            + SUBSTRING(CAST(active_start_time AS CHAR), 2, 2)  
                                                            + '' A.M.''  
                                                  END,  
                                    @END_TIME = CASE WHEN left(active_end_time, 2) IN (  
                                                          22, 23 )  
                                                          AND len(active_end_time) = 6  
                                                     THEN convert(varchar(2), left(active_end_time, 2)  
                                                          - 12) + '':''  
                                                          + SUBSTRING(CAST(active_end_time AS CHAR), 3, 2)  
                                                          + '' P.M''  
                                                     WHEN left(active_end_time, 2) = ( 12 )  
                                                          AND len(active_end_time) = 6  
                                                     THEN cast(LEFT(active_end_time, 2) as char(2))  
                                                          + '':''  
                                                          + SUBSTRING(CAST(active_end_time AS CHAR), 3, 2)  
                                                          + '' P.M.''  
                                                     WHEN left(active_end_time, 2) BETWEEN 13 AND 24  
                                                          AND len(active_end_time) = 6  
                                                     THEN convert(varchar(2), left(active_end_time, 2)  
                                                          - 12) + '':''  
                                                          + SUBSTRING(CAST(active_end_time AS CHAR), 3, 2)  
                                                          + '' P.M.''  
                                                     WHEN left(active_end_time, 2) IN (  
                                                          10, 11 )  
                                                          AND len(active_end_time) = 6  
                                                     THEN cast(LEFT(active_end_time, 2) as char(2))  
                                                          + '':''  
                                                          + SUBSTRING(CAST(active_end_time AS CHAR), 3, 2)  
                                                          + '' A.M.''  
                                                     WHEN active_end_time = 0  
                                                     THEN ''12:00 A.M.''  
                                                     WHEN LEN(active_end_time) = 4  
                                                     THEN ''12:''  
                                                          + convert(varchar(2), left(active_end_time, 2))  
                                                          + '' A.M.''  
                                                     WHEN LEN(active_end_time) = 3  
                                                     THEN ''12:0''  
                                                          + convert(varchar(2), left(active_end_time, 1))  
                                                          + '' A.M.''  
                                                     WHEN LEN(active_end_time) = 2  
                                                     THEN ''12:00:''  
                                                          + convert(varchar(2), left(active_end_time, 2))  
                                                          + '' A.M.''  
                                                     WHEN LEN(active_end_time) = 1  
                                                     THEN ''12:00:0''  
                                                          + convert(varchar(2), left(active_end_time, 2))  
                                                          + '' A.M.''  
                                                     ELSE cast(LEFT(active_end_time, 1) as char(1))  
                                                          + '':''  
                                                          + SUBSTRING(CAST(active_end_time AS CHAR), 2, 2)  
                                                          + '' A.M.''  
                                                END  
                            FROM    JobProperties_temp  
                            WHERE   schedule is null  
                                    AND ScheduleEnabled = 1  
  
                            IF EXISTS ( SELECT  @freq_type  
                                        WHERE   @freq_type in ( 1, 64 ) )   
                                BEGIN  
  
                                    SELECT  @SCHEDULE = CASE @freq_type  
                                                          WHEN 1  
                                                          THEN ''Occurs Once, On '' + cast(@active_start_date as varchar(8)) + '', At '' + @start_time  
                                                          WHEN 64  
                                                          THEN ''Occurs When SQL Server Agent Starts''  
                                                        END  
  
                                END  
  
                            ELSE   
                                BEGIN  
  
                                    IF @freq_type = 4   
                                        BEGIN  
  
                                            SELECT  @SCHEDULE = ''Occurs Every ''  
                                                    + cast(@freq_interval as varchar(10))  
                                                    + '' Day(s)''  
  
                                        END  
  
                                    IF @freq_type = 8   
                                        BEGIN  
  
                                            SELECT  @SCHEDULE = ''Occurs Every ''  
                                                    + cast(@freq_recurrence_factor as varchar(3))  
                                                    + '' Week(s)''  
  
                                            SELECT  @schedule_day = ''''  
  
                                            IF ( SELECT ( convert(int, ( @freq_interval / 1 ))  
                                                          % 2 )  
                                               ) = 1   
                                                select  @schedule_day = @schedule_day  
                                                     + ''Sun''  
  
                                            IF ( SELECT ( convert(int, ( @freq_interval / 2 ))  
                                                          % 2 )  
                                               ) = 1   
                                                select  @schedule_day = @schedule_day  
                                                        + ''Mon''  
  
                                            IF ( SELECT ( convert(int, ( @freq_interval / 4 ))  
                                                          % 2 )  
                                               ) = 1   
                                                select  @schedule_day = @schedule_day  
                                                        + ''Tue''  
  
                                           IF ( SELECT ( convert(int, ( @freq_interval / 8 ))  
                                                          % 2 )  
                                               ) = 1   
                                                select  @schedule_day = @schedule_day  
                                                        + ''Wed''  
  
                                            IF ( SELECT ( convert(int, ( @freq_interval / 16 ))  
                                                          % 2 )  
                                               ) = 1   
                                                select  @schedule_day = @schedule_day  
                                                        + ''Thu''  
  
                                            IF ( SELECT ( convert(int, ( @freq_interval / 32 ))  
                                                          % 2 )  
                                               ) = 1   
                                                select  @schedule_day = @schedule_day  
                                                        + ''Fri''  
  
                                            IF ( SELECT ( convert(int, ( @freq_interval / 64 ))  
                                                          % 2 )  
                                               ) = 1   
                                                select  @schedule_day = @schedule_day  
                                                        + ''Sat''  
  
                                            SELECT  @SCHEDULE = @SCHEDULE  
                                                    + '', On '' + @schedule_day  
  
                                        END  
  
                                    IF @freq_type = 16   
                                        BEGIN  
  
                                            SELECT  @SCHEDULE = ''Occurs Every ''  
                                                    + cast(@freq_recurrence_factor as varchar(3))  
                                                    + '' Month(s) on Day ''  
                                                    + cast(@freq_interval as varchar(3))  
                                                    + '' of that Month''  
  
                                        END  
  
                                    IF @freq_type = 32   
                                        BEGIN  
  
                                            SELECT  @SCHEDULE = CASE @freq_relative_interval  
                                                                  WHEN 1 THEN ''First''  
                                                                  WHEN 2 THEN ''Second''  
                                                                  WHEN 4 THEN ''Third''  
                                                                  WHEN 8 THEN ''Fourth''  
                                                                  WHEN 16 THEN ''Last''  
                                                  ELSE ''Not Applicable''  
                                                                END  
  
                                            SELECT  @SCHEDULE = CASE @freq_interval  
                                           WHEN 1 THEN ''Occurs Every '' + @SCHEDULE + '' Sunday of the Month''  
                                                                  WHEN 2 THEN ''Occurs Every '' + @SCHEDULE + '' Monday of the Month''  
                                                                  WHEN 3 THEN ''Occurs Every '' + @SCHEDULE + '' Tueday of the Month''  
                                                                  WHEN 4 THEN ''Occurs Every '' + @SCHEDULE + '' Wednesday of the Month''  
                                                                  WHEN 5 THEN ''Occurs Every '' + @SCHEDULE + '' Thursday of the Month''  
                                                                  WHEN 6 THEN ''Occurs Every '' + @SCHEDULE + '' Friday of the Month''  
                                                      WHEN 7 THEN ''Occurs Every '' + @SCHEDULE + '' Saturday of the Month''  
                                                                  WHEN 8 THEN ''Occurs Every '' + @SCHEDULE + '' Day of the Month''  
                                                                  WHEN 9 THEN ''Occurs Every '' + @SCHEDULE + '' Weekday of the Month''  
                                                                  WHEN 10 THEN ''Occurs Every '' + @SCHEDULE + '' Weekend Day of the Month''  
                                                                END  
  
                                        END  
  
                                    SELECT  @SCHEDULE = CASE @freq_subday_type  
                                                          WHEN 1  
                                                          THEN @SCHEDULE + '', At '' + @start_time  
                                                          WHEN 2  
                                                          THEN @SCHEDULE + '', every '' + cast(@freq_subday_interval as varchar(3)) + '' Second(s) Between '' + @start_time + '' and '' + @END_TIME  
                                                          WHEN 4  
                                                          THEN @SCHEDULE + '', every '' + cast(@freq_subday_interval as varchar(3)) + '' Minute(s) Between '' + @start_time + '' and '' + @END_TIME  
                                                          WHEN 8  
                                                          THEN @SCHEDULE + '', every '' + cast(@freq_subday_interval as varchar(3)) + '' Hour(s) Between '' + @start_time + '' and '' + @END_TIME  
                                                        END  
  
                                END  
  
                        END  
  
                    UPDATE  JobProperties_temp  
                    SET     schedule = @SCHEDULE  
                    WHERE   job_id = @job_id  
                            AND sched_id = @sched_Id  
  
                END')</td>
        <td>29</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">EXECUTE ('  
  
  DECLARE @JOB_ID VARCHAR(200),  
        @SCHED_ID VARCHAR(200),  
        @FREQ_TYPE INT,  
        @FREQ_INTERVAL INT,  
        @FREQ_SUBDAY_TYPE INT,  
        @FREQ_SUBDAY_INTERVAL INT,  
        @FREQ_RELATIVE_INTERVAL INT,  
        @FREQ_RECURRENCE_FACTOR INT,  
        @ACTIVE_START_DATE INT,  
        @SCHEDULE VARCHAR(1000),  
        @SCHEDULE_DAY VARCHAR(200),  
        @START_TIME VARCHAR(10),  
        @END_TIME VARCHAR(10)  
  
    IF ( OBJECT_ID(''JobProperties_temp'') ) IS NULL   
        CREATE TABLE dbo.JobProperties_temp  
            (  
              JOB_ID VARCHAR(200),  
              SCHED_ID VARCHAR(200),  
              JOB_NAME SYSNAME,  
              CategoryName SYSNAME,  
              JobEnabled INT,  
              ScheduleEnabled INT NULL,  
              schedule VARCHAR(1000) NULL,  
              FREQ_TYPE INT NULL,  
              FREQ_INTERVAL INT NULL,  
              FREQ_SUBDAY_TYPE INT NULL,  
              FREQ_SUBDAY_INTERVAL INT NULL,  
              FREQ_RELATIVE_INTERVAL INT NULL,  
              FREQ_RECURRENCE_FACTOR INT NULL,  
              ACTIVE_START_DATE INT NULL,  
              ACTIVE_END_DATE INT NULL,  
              ACTIVE_START_TIME INT NULL,  
              ACTIVE_END_TIME INT NULL,  
              DATE_CREATED DATETIME NULL,  
              JOB_OWNER VARCHAR(200)  
            )  
  
    truncate TABLE JobProperties_temp              
  
  
  
            INSERT  INTO JobProperties_temp  
                    (  
                      job_id,  
                      sched_id,  
                      job_name,  
                      CategoryName,  
                      JobEnabled,  
                      ScheduleEnabled,  
                      schedule,  
                      freq_type,  
                      freq_interval,  
                      freq_subday_type,  
                      freq_subday_interval,  
                      freq_relative_interval,  
                      freq_recurrence_factor,  
                      active_start_date,  
                      active_end_date,  
                      active_start_time,  
                      active_end_time,  
                      date_created,  
                      job_owner  
                    )  
                    SELECT  j.job_id,  
                            sched.schedule_id,  
                            j.name,  
                            c.NAME CatName,  
                            j.enabled,  
                            sched.enabled,  
                            NULL,  
                            sched.freq_type,  
                            sched.freq_interval,  
                            sched.freq_subday_type,  
                            sched.freq_subday_interval,  
                            sched.freq_relative_interval,  
                            sched.freq_recurrence_factor,  
                            sched.active_start_date,  
                            sched.active_end_date,  
                            sched.active_start_time,  
                            sched.active_end_time,  
                            j.date_created,  
                            suser_sname(j.owner_sid)  
                    FROM    msdb.dbo.sysjobs j JOIN msdb.dbo.syscategories c ON j.category_id=c.category_id  
                            left join msdb.dbo.sysJobSchedules s ON j.job_id = s.job_id  
                            left JOIN msdb.dbo.sysJobSchedules sched ON s.schedule_id = sched.schedule_id  
  
            WHILE 1 = 1  
  
                BEGIN  
  
                    SET @SCHEDULE = ''''  
  
            IF ( SELECT COUNT(*)  
                         FROM   JobProperties_temp  
                         WHERE  ScheduleEnabled = 1  
                                and schedule is null  
                       ) = 0   
                        BREAK  
  
                    ELSE   
                        BEGIN  
  
                            SELECT  @job_id = job_id,  
                                    @sched_id = sched_id,  
                                    @freq_type = freq_type,  
                                    @Freq_Interval = freq_interval,  
                                    @freq_subday_type = freq_subday_type,  
                                    @freq_subday_interval = freq_subday_interval,  
                                    @freq_relative_interval = freq_relative_interval,  
                                    @freq_recurrence_factor = freq_recurrence_factor,  
                                    @active_start_date = active_start_date,  
                                    @start_time = CASE WHEN LEFT(active_start_time, 2) IN (  
                                                            22, 23 )  
                                                            AND len(active_start_time) = 6  
                                                       THEN convert(varchar(2), left(active_start_time, 2)  
                                                            - 12) + '':''  
                                                            + SUBSTRING(CAST(active_start_time AS CHAR), 3, 2)  
                                                            + '' P.M''  
                                                       WHEN left(active_start_time, 2) = ( 12 )  
                                                            AND len(active_start_time) = 6  
                                                       THEN cast(LEFT(active_start_time, 2) as char(2))  
                                                            + '':''  
                                                            + SUBSTRING(CAST(active_start_time AS CHAR), 3, 2)  
                                                            + '' P.M.''  
                                                       WHEN left(active_start_time, 2) BETWEEN 13 AND 24  
                        AND len(active_start_time) = 6  
                                                       THEN convert(varchar(2), left(active_start_time, 2)  
                                                            - 12) + '':''  
                                                            + SUBSTRING(CAST(active_start_time AS CHAR), 3, 2)  
                                                            + '' P.M.''  
                                                       WHEN left(active_start_time, 2) IN (  
                                                            10, 11 )  
                                                            AND len(active_start_time) = 6  
                                                       THEN cast(LEFT(active_start_time, 2) as char(2))  
                                                            + '':''  
                                                            + SUBSTRING(CAST(active_start_time AS CHAR), 3, 2)  
                                                            + '' A.M.''  
                                                       WHEN active_start_time = 0  
                                                       THEN ''12:00 A.M.''  
                                                       WHEN LEN(active_start_time) = 4  
                                                       THEN ''12:''  
                                                            + convert(varchar(2), left(active_start_time, 2))  
                                                            + '' A.M.''  
                                                       WHEN LEN(active_start_time) = 3  
                               THEN ''12:0''  
                                                            + convert(varchar(2), left(active_start_time, 1))  
                                                            + '' A.M.''  
                                                       WHEN LEN(active_start_time) = 2  
                                                       THEN ''12:00:''  
                                                            + convert(varchar(2), left(active_start_time, 2))  
                                                            + '' A.M.''  
                                                       WHEN LEN(active_start_time) = 1  
                                                       THEN ''12:00:0''  
                                                            + convert(varchar(2), left(active_start_time, 2))  
                                                            + '' A.M.''  
                                                       ELSE cast(LEFT(active_start_time, 1) as char(1))  
             + '':''  
                                                            + SUBSTRING(CAST(active_start_time AS CHAR), 2, 2)  
                                                            + '' A.M.''  
                                                  END,  
                                    @END_TIME = CASE WHEN left(active_end_time, 2) IN (  
                                                          22, 23 )  
                                         AND len(active_end_time) = 6  
                                                     THEN convert(varchar(2), left(active_end_time, 2)  
                                                          - 12) + '':''  
                                                          + SUBSTRING(CAST(active_end_time AS CHAR), 3, 2)  
                                                          + '' P.M''  
                                                     WHEN left(active_end_time, 2) = ( 12 )  
                                                          AND len(active_end_time) = 6  
                                                     THEN cast(LEFT(active_end_time, 2) as char(2))  
                                                          + '':''  
                                                          + SUBSTRING(CAST(active_end_time AS CHAR), 3, 2)  
                                                          + '' P.M.''  
                                                     WHEN left(active_end_time, 2) BETWEEN 13 AND 24  
                                                          AND len(active_end_time) = 6  
                                                     THEN convert(varchar(2), left(active_end_time, 2)  
                                                          - 12) + '':''  
                                                          + SUBSTRING(CAST(active_end_time AS CHAR), 3, 2)  
                                                          + '' P.M.''  
                                                     WHEN left(active_end_time, 2) IN (  
                                                          10, 11 )  
                                                          AND len(active_end_time) = 6  
                                                     THEN cast(LEFT(active_end_time, 2) as char(2))  
                                                          + '':''  
                                                          + SUBSTRING(CAST(active_end_time AS CHAR), 3, 2)  
                                                          + '' A.M.''  
                                                     WHEN active_end_time = 0  
                                                     THEN ''12:00 A.M.''  
                                                     WHEN LEN(active_end_time) = 4  
                                                     THEN ''12:''  
                                                          + convert(varchar(2), left(active_end_time, 2))  
                                                          + '' A.M.''  
                                                     WHEN LEN(active_end_time) = 3  
                                                     THEN ''12:0''  
                                                          + convert(varchar(2), left(active_end_time, 1))  
                                                          + '' A.M.''  
                                                     WHEN LEN(active_end_time) = 2  
                                                     THEN ''12:00:''  
                                                          + convert(varchar(2), left(active_end_time, 2))  
                                                          + '' A.M.''  
                                                     WHEN LEN(active_end_time) = 1  
                                                     THEN ''12:00:0''  
                                                          + convert(varchar(2), left(active_end_time, 2))  
                                                          + '' A.M.''  
                                          ELSE cast(LEFT(active_end_time, 1) as char(1))  
                                                          + '':''  
                                                          + SUBSTRING(CAST(active_end_time AS CHAR), 2, 2)  
                                                          + '' A.M.''  
                                                END  
                            FROM    JobProperties_temp  
                            WHERE   schedule is null  
                                    AND ScheduleEnabled = 1  
  
                            IF EXISTS ( SELECT  @freq_type  
                                        WHERE   @freq_type in ( 1, 64 ) )   
                                BEGIN  
  
                                    SELECT  @SCHEDULE = CASE @freq_type  
                                                          WHEN 1  
                                                          THEN ''Occurs Once, On '' + cast(@active_start_date as varchar(8)) + '', At '' + @start_time  
                                                          WHEN 64  
                                                          THEN ''Occurs When SQL Server Agent Starts''  
                                                        END  
  
                           END  
  
                            ELSE   
                                BEGIN  
  
                                    IF @freq_type = 4   
                                        BEGIN  
  
                                            SELECT  @SCHEDULE = ''Occurs Every ''  
                                                    + cast(@freq_interval as varchar(10))  
                                                    + '' Day(s)''  
  
                                        END  
  
                                    IF @freq_type = 8   
                                        BEGIN  
  
                                            SELECT  @SCHEDULE = ''Occurs Every ''  
                                                    + cast(@freq_recurrence_factor as varchar(3))  
                                                    + '' Week(s)''  
  
                                            SELECT  @schedule_day = ''''  
  
                                            IF ( SELECT ( convert(int, ( @freq_interval / 1 ))  
                                                          % 2 )  
                                               ) = 1   
                                                select  @schedule_day = @schedule_day  
                                                        + ''Sun''  
  
                                            IF ( SELECT ( convert(int, ( @freq_interval / 2 ))  
                                                          % 2 )  
                 ) = 1   
                                                select  @schedule_day = @schedule_day  
                                                        + ''Mon''  
  
                                            IF ( SELECT ( convert(int, ( @freq_interval / 4 ))  
                                                          % 2 )  
                                               ) = 1   
                                                select  @schedule_day = @schedule_day  
                                                        + ''Tue''  
  
                                            IF ( SELECT ( convert(int, ( @freq_interval / 8 ))  
                                                          % 2 )  
                                               ) = 1   
                                                select  @schedule_day = @schedule_day  
                                                        + ''Wed''  
  
                                            IF ( SELECT ( convert(int, ( @freq_interval / 16 ))  
                                                          % 2 )  
                                               ) = 1   
                                                select  @schedule_day = @schedule_day  
                                                  + ''Thu''  
  
                                            IF ( SELECT ( convert(int, ( @freq_interval / 32 ))  
                                                          % 2 )  
                                               ) = 1   
                                                select  @schedule_day = @schedule_day  
                                                        + ''Fri''  
  
                                            IF ( SELECT ( convert(int, ( @freq_interval / 64 ))  
                                                          % 2 )  
                                               ) = 1   
                                                select  @schedule_day = @schedule_day  
                                                        + ''Sat''  
  
                                            SELECT  @SCHEDULE = @SCHEDULE  
                                                    + '', On '' + @schedule_day  
  
                                        END  
  
                                    IF @freq_type = 16   
                                        BEGIN  
  
                                            SELECT  @SCHEDULE = ''Occurs Every ''  
                                                    + cast(@freq_recurrence_factor as varchar(3))  
                                                    + '' Month(s) on Day ''  
                                                    + cast(@freq_interval as varchar(3))  
                                                    + '' of that Month''  
  
                                        END  
  
                                    IF @freq_type = 32   
                                        BEGIN  
  
                                            SELECT  @SCHEDULE = CASE @freq_relative_interval  
                                                                  WHEN 1 THEN ''First''  
                                                                  WHEN 2 THEN ''Second''  
                                                                  WHEN 4 THEN ''Third''  
                                                                  WHEN 8 THEN ''Fourth''  
                                                                  WHEN 16 THEN ''Last''  
                                                                  ELSE ''Not Applicable''  
                                                                END  
  
                                            SELECT  @SCHEDULE = CASE @freq_interval  
                                                                  WHEN 1 THEN ''Occurs Every '' + @SCHEDULE + '' Sunday of the Month''  
                                             WHEN 2 THEN ''Occurs Every '' + @SCHEDULE + '' Monday of the Month''  
                                                                  WHEN 3 THEN ''Occurs Every '' + @SCHEDULE + '' Tueday of the Month''  
                                                                  WHEN 4 THEN ''Occurs Every '' + @SCHEDULE + '' Wednesday of the Month''  
                                                                  WHEN 5 THEN ''Occurs Every '' + @SCHEDULE + '' Thursday of the Month''  
                                                                  WHEN 6 THEN ''Occurs Every '' + @SCHEDULE + '' Friday of the Month''  
                                                                  WHEN 7 THEN ''Occurs Every '' + @SCHEDULE + '' Saturday of the Month''  
                                                                  WHEN 8 THEN ''Occurs Every '' + @SCHEDULE + '' Day of the Month''  
                                                                  WHEN 9 THEN ''Occurs Every '' + @SCHEDULE + '' Weekday of the Month''  
                                                                  WHEN 10 THEN ''Occurs Every '' + @SCHEDULE + '' Weekend Day of the Month''  
                                                                END  
  
                                        END  
  
           SELECT  @SCHEDULE = CASE @freq_subday_type  
                                                          WHEN 1  
                                                          THEN @SCHEDULE + '', At '' + @start_time  
                                                          WHEN 2  
                                                          THEN @SCHEDULE + '', every '' + cast(@freq_subday_interval as varchar(3)) + '' Second(s) Between '' + @start_time + '' and '' + @END_TIME  
                                                          WHEN 4  
                                                          THEN @SCHEDULE + '', every '' + cast(@freq_subday_interval as varchar(3)) + '' Minute(s) Between '' + @start_time + '' and '' + @END_TIME  
                                                          WHEN 8  
                                                          THEN @SCHEDULE + '', every '' + cast(@freq_subday_interval as varchar(3)) + '' Hour(s) Between '' + @start_time + '' and '' + @END_TIME  
                                                        END  
  
                                END  
  
                        END  
  
                    UPDATE  JobProperties_temp  
                    SET     schedule = @SCHEDULE  
                    WHERE   job_id = @job_id  
                            AND sched_id = @sched_Id  
  
                END')</td>
        <td>396</td>
      </tr>
      <tr valign="top">
        <td colspan="1">One-part names</td>
        <td colspan="1">JobProperties_temp</td>
        <td>759</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">JobProperties_temp</td>
        <td>761</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">JobProperties</td>
        <td>779</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">JobProperties_temp</td>
        <td>789</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">JobProperties</td>
        <td>794</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Subquery</td>
        <td colspan="1">(SELECT job_name
 FROM   JobProperties_temp
 WHERE  schedule IS NOT NULL)</td>
        <td>761</td>
      </tr>
      <tr valign="top">
        <td colspan="1">DELETE with FROM clause</td>
        <td colspan="1">
FROM JobProperties_temp</td>
        <td>761</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">OBJECT_ID</td>
        <td colspan="1">OBJECT_ID('JobProperties')</td>
        <td>766</td>
      </tr>
      <tr valign="top">
        <td colspan="1">@@servername</td>
        <td colspan="1">@@servername</td>
        <td>782</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">*</td>
        <td colspan="1">SELECT *
FROM   JobProperties</td>
        <td>794</td>
      </tr>
    </table>
  </body>
</html>