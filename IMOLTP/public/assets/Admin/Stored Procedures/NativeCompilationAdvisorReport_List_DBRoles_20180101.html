<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [Admin].[List_DBRoles]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [Admin].[List_DBRoles]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 4:58 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">Cursors</td>
        <td colspan="1">CURSOR
    FOR SELECT   name
        FROM     master.dbo.sysdatabases
        WHERE    name NOT IN ('mssecurity', 'tempdb')
        ORDER BY name</td>
        <td>35</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Three-part names</td>
        <td colspan="1">master.dbo.sysdatabases</td>
        <td>37</td>
      </tr>
      <tr valign="top">
        <td colspan="1">FETCH CURSOR</td>
        <td colspan="1">FETCH NEXT FROM DBName_Cursor INTO @dbname</td>
        <td>45</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM DBName_Cursor INTO @dbname</td>
        <td>95</td>
      </tr>
      <tr valign="top">
        <td colspan="1">@@fetch_status</td>
        <td colspan="1">@@FETCH_STATUS</td>
        <td>47</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CHAR</td>
        <td colspan="1">char(13)</td>
        <td>57</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">char(13)</td>
        <td>79</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">char(13)</td>
        <td>81</td>
      </tr>
      <tr valign="top">
        <td colspan="1">EXECUTE string</td>
        <td colspan="1">EXECUTE (@mSql1)</td>
        <td>93</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">*</td>
        <td colspan="1">SELECT *
FROM   #DBRoles
WHERE  ((@database IS NULL)
        OR (DBName LIKE '%' + @database + '%'))
       AND ((@user IS NULL)
            OR (UserName LIKE '%' + @user + '%'))
       AND ((@dbo IS NULL)
            OR (db_owner = 'Yes'))
       AND ((@access IS NULL)
            OR (db_accessadmin = 'Yes'))
       AND ((@security IS NULL)
            OR (db_securityadmin = 'Yes'))
       AND ((@ddl IS NULL)
            OR (db_ddladmin = 'Yes'))
       AND ((@datareader IS NULL)
            OR (db_datareader = 'Yes'))
       AND ((@datawriter IS NULL)
            OR (db_datawriter = 'Yes'))
       AND ((@denyread IS NULL)
            OR (db_denydatareader = 'Yes'))
       AND ((@denywrite IS NULL)
            OR (db_denydatawriter = 'Yes'))</td>
        <td>103</td>
      </tr>
      <tr valign="top">
        <td colspan="1">One-part names</td>
        <td colspan="1">#DBRoles</td>
        <td>103</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">LIKE</td>
        <td colspan="1">DBName LIKE '%' + @database + '%'</td>
        <td>105</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">UserName LIKE '%' + @user + '%'</td>
        <td>107</td>
      </tr>
    </table>
  </body>
</html>