<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [Admin].[CurrentActivity]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [Admin].[CurrentActivity]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 4:59 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>25</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">EXECUTE IsJobRunning2000 '%', 1</td>
        <td>34</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#Inputbuffer</td>
        <td>149</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#Inputbuffer</td>
        <td>150</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#InputBuffer</td>
        <td>154</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#InputBuffer</td>
        <td>162</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>164</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>199</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>204</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">p</td>
        <td>237</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#curr AS p</td>
        <td>238</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">serverprocs AS s</td>
        <td>238</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>283</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#curr AS b</td>
        <td>294</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#curr AS s</td>
        <td>296</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#curr AS c</td>
        <td>321</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#curr AS c</td>
        <td>335</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">OBJECT_ID</td>
        <td colspan="1">OBJECT_ID('tempdb..#curr')</td>
        <td>38</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">OBJECT_ID('tempdb..#Inputbuffer')</td>
        <td>41</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">OBJECT_ID('tempdb..#curr')</td>
        <td>344</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">OBJECT_ID('tempdb..#Inputbuffer')</td>
        <td>346</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Three-part names</td>
        <td colspan="1">master..sysprocesses</td>
        <td>95</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">MASTER.DBO.SYSPROCESSES</td>
        <td>131</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">master..sysprocesses</td>
        <td>211</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">msdb.dbo.sysjobs</td>
        <td>322</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">LIKE</td>
        <td colspan="1">s.cmd NOT LIKE '%BACKUP%'</td>
        <td>97</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">s.cmd NOT LIKE '%RESTORE%'</td>
        <td>98</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">s.cmd NOT LIKE '%BACKUP%'</td>
        <td>213</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">s.cmd NOT LIKE '%RESTORE%'</td>
        <td>214</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">p.procname LIKE '%' + s.obj + '%'</td>
        <td>239</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ISNULL(SQLstatement, 'x') NOT LIKE '%WAITFOR%'</td>
        <td>324</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">procname LIKE '%' + @OneProc + '%'</td>
        <td>327</td>
      </tr>
      <tr valign="top">
        <td colspan="1">DB_NAME</td>
        <td colspan="1">db_name(s.dbid)</td>
        <td>120</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">STR</td>
        <td colspan="1">STR(@spid)</td>
        <td>148</td>
      </tr>
      <tr valign="top">
        <td colspan="1">INSERT EXEC</td>
        <td colspan="1">INSERT #Inputbuffer
EXECUTE (@cmd)</td>
        <td>150</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">fn_get_sql</td>
        <td colspan="1">::fn_get_sql (@sql_handle)</td>
        <td>158</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">::fn_get_sql (@sql_handle)</td>
        <td>201</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">::fn_get_sql (@sql_handle)</td>
        <td>206</td>
      </tr>
      <tr valign="top">
        <td colspan="1">COALESCE</td>
        <td colspan="1">COALESCE (RTRIM(EventInfo), '')</td>
        <td>161</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">UPDATE with FROM clause</td>
        <td colspan="1">
FROM ::fn_get_sql (@sql_handle)</td>
        <td>201</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">
FROM ::fn_get_sql (@sql_handle)</td>
        <td>206</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">
FROM master..sysprocesses AS s</td>
        <td>211</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">
FROM #curr AS p
     INNER JOIN
     serverprocs AS s
     ON p.db = s.dbname
        AND p.procname LIKE '%' + s.obj + '%'</td>
        <td>238</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Subquery</td>
        <td colspan="1">(SELECT MIN(SPID)
 FROM   master..sysprocesses AS s
 WHERE  (s.cmd &lt;&gt; 'AWAITING COMMAND'
         AND s.cmd NOT LIKE '%BACKUP%'
         AND s.cmd NOT LIKE '%RESTORE%')
        AND s.spid &gt; 50
        AND s.spid &lt;&gt; @@spid
        AND SPID &gt; @SPID
        AND lastwaittype NOT IN ('HADR_FILESTREAM_IOMGR_IOCOMPLETI', 'BROKER_EVENTHANDLER', 'BROKER_RECEIVE_WAITFOR', 'BROKER_TASK_STOP', 'BROKER_TO_FLUSH', 'BROKER_TRANSMITTER', 'CHECKPOINT_QUEUE', 'CHKPT', 'CLR_AUTO_EVENT', 'CLR_MANUAL_EVENT', 'CLR_SEMAPHORE', 'DBMIRROR_DBM_EVENT', 'DBMIRROR_EVENTS_QUEUE', 'DBMIRROR_WORKER_QUEUE', 'DBMIRRORING_CMD', 'DIRTY_PAGE_POLL', 'DISPATCHER_QUEUE_SEMAPHORE', 'EXECSYNC', 'FSAGENT', 'FT_IFTS_SCHEDULER_IDLE_WAIT', 'FT_IFTSHC_MUTEX', 'HADR_CLUSAPI_CALL', 'HADR_FILESTREAM_IOMGR_IOCOMPLETION', 'HADR_LOGCAPTURE_WAIT', 'HADR_NOTIFICATION_DEQUEUE', 'HADR_TIMER_TASK', 'HADR_WORK_QUEUE', 'KSOURCE_WAKEUP', 'LAZYWRITER_SLEEP', 'LOGMGR_QUEUE', 'MEMORY_ALLOCATION_EXT', 'ONDEMAND_TASK_QUEUE', 'PREEMPTIVE_XE_GETTARGETSTATE', 'PWAIT_ALL_COMPONENTS_INITIALIZED', 'PWAIT_DIRECTLOGCONSUMER_GETNEXT', 'QDS_PERSIST_TASK_MAIN_LOOP_SLEEP', 'QDS_ASYNC_QUEUE', 'QDS_CLEANUP_STALE_QUERIES_TASK_MAIN_LOOP_SLEEP', 'QDS_SHUTDOWN_QUEUE', 'REDO_THREAD_PENDING_WORK', 'REQUEST_FOR_DEADLOCK_SEARCH', 'RESOURCE_QUEUE', 'SERVER_IDLE_CHECK', 'SLEEP_BPOOL_FLUSH', 'SLEEP_DBSTARTUP', 'SLEEP_DCOMSTARTUP', 'SLEEP_MASTERDBREADY', 'SLEEP_MASTERMDREADY', 'SLEEP_MASTERUPGRADED', 'SLEEP_MSDBSTARTUP', 'SLEEP_SYSTEMTASK', 'SLEEP_TASK', 'SLEEP_TEMPDBSTARTUP', 'SNI_HTTP_ACCEPT', 'SP_SERVER_DIAGNOSTICS_SLEEP', 'SQLTRACE_BUFFER_FLUSH', 'SQLTRACE_INCREMENTAL_FLUSH_SLEEP', 'SQLTRACE_WAIT_ENTRIES', 'WAIT_FOR_RESULTS', 'WAITFOR', 'WAITFOR_TASKSHUTDOWN', 'WAIT_XTP_RECOVERY', 'WAIT_XTP_HOST_WAIT', 'WAIT_XTP_OFFLINE_CKPT_NEW_LOG', 'WAIT_XTP_CKPT_CLOSE', 'XE_DISPATCHER_JOIN', 'XE_DISPATCHER_WAIT', 'XE_TIMER_EVENT'))</td>
        <td>210</td>
      </tr>
      <tr valign="top">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN s.blocked &gt; 0
          AND s.blocked &lt;&gt; s.spid THEN 'n' ELSE 'Y' END</td>
        <td>293</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN last_request_start_time = '1/1/1900' THEN -1 ELSE datediff(ss, last_request_start_time, getdate()) END</td>
        <td>305</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN blocked = spid THEN -1 ELSE blocked END</td>
        <td>308</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN last_request_start_time = '1/1/1900' THEN -1 ELSE datediff(ss, last_request_start_time, getdate()) END</td>
        <td>309</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ProcName = SUBSTRING(SQLstatement, 1, 888) THEN '' ELSE ProcName END</td>
        <td>316</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN last_request_start_time = '1/1/1900' THEN -1 ELSE datediff(ss, last_request_start_time, getdate()) END</td>
        <td>326</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN last_request_start_time = '1/1/1900' THEN -1 ELSE datediff(ss, last_request_start_time, getdate()) END</td>
        <td>333</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN last_request_start_time = '1/1/1900' THEN -1 ELSE datediff(ss, last_request_start_time, getdate()) END</td>
        <td>334</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN last_request_start_time = '1/1/1900' THEN -1 ELSE datediff(ss, last_request_start_time, getdate()) END</td>
        <td>338</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">@@servername</td>
        <td colspan="1">@@servername</td>
        <td>303</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@servername</td>
        <td>325</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@servername</td>
        <td>325</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@servername</td>
        <td>337</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@servername</td>
        <td>337</td>
      </tr>
    </table>
  </body>
</html>