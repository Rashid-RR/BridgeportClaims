<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [Admin].[populate_tbl_CurrentActivity]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [Admin].[populate_tbl_CurrentActivity]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 4:58 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>11</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">OBJECT_ID</td>
        <td colspan="1">OBJECT_ID('tbl_CurrentActivity')</td>
        <td>15</td>
      </tr>
      <tr valign="top">
        <td colspan="1">Three-part names</td>
        <td colspan="1">master..sysprocesses</td>
        <td>85</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">MASTER.DBO.SYSPROCESSES</td>
        <td>108</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">master..sysprocesses</td>
        <td>175</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">msdb.dbo.sysjobs</td>
        <td>257</td>
      </tr>
      <tr valign="top">
        <td colspan="1">LIKE</td>
        <td colspan="1">s.cmd NOT LIKE '%BACKUP%'</td>
        <td>87</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">s.cmd NOT LIKE '%RESTORE%'</td>
        <td>88</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">s.cmd NOT LIKE '%BACKUP%'</td>
        <td>177</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">s.cmd NOT LIKE '%RESTORE%'</td>
        <td>178</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">p.SQLstatement LIKE '%' + s.obj + '%'</td>
        <td>192</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ProcName LIKE '%exec dbo%'</td>
        <td>200</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ProcName LIKE '%' + @OpenVal + '%' + @CloseVal + '%'</td>
        <td>208</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">ProcName LIKE '%' + @CloseVal + '%'</td>
        <td>215</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ProcName LIKE '%' + @CloseVal + '%'</td>
        <td>229</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">procname LIKE '%;1'</td>
        <td>233</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">ISNULL(SQLstatement, 'x') NOT LIKE '%WAITFOR%'</td>
        <td>258</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">DB_NAME</td>
        <td colspan="1">db_name(s.dbid)</td>
        <td>97</td>
      </tr>
      <tr valign="top">
        <td colspan="1">STR</td>
        <td colspan="1">STR(@spid)</td>
        <td>112</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">#Inputbuffer</td>
        <td>113</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#Inputbuffer</td>
        <td>114</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#InputBuffer</td>
        <td>118</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#InputBuffer</td>
        <td>126</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>128</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>163</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>168</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">p</td>
        <td>190</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#curr AS p</td>
        <td>191</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">serverprocs AS s</td>
        <td>191</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>198</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>200</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>206</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>213</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>217</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>218</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>219</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>221</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>222</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>223</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>224</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>227</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>231</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#curr</td>
        <td>235</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">tbl_CurrentActivity</td>
        <td>240</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">#curr AS c</td>
        <td>257</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">INSERT EXEC</td>
        <td colspan="1">INSERT #Inputbuffer
EXECUTE (@cmd)</td>
        <td>114</td>
      </tr>
      <tr valign="top">
        <td colspan="1">fn_get_sql</td>
        <td colspan="1">::fn_get_sql (@sql_handle)</td>
        <td>122</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">::fn_get_sql (@sql_handle)</td>
        <td>165</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">::fn_get_sql (@sql_handle)</td>
        <td>170</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">COALESCE</td>
        <td colspan="1">COALESCE (RTRIM(EventInfo), '')</td>
        <td>125</td>
      </tr>
      <tr valign="top">
        <td colspan="1">UPDATE with FROM clause</td>
        <td colspan="1">
FROM ::fn_get_sql (@sql_handle)</td>
        <td>165</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">
FROM ::fn_get_sql (@sql_handle)</td>
        <td>170</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">
FROM master..sysprocesses AS s</td>
        <td>175</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">
FROM #curr AS p
     INNER JOIN
     serverprocs AS s
     ON p.db = s.dbname
        AND p.SQLstatement LIKE '%' + s.obj + '%'
        AND s.[user] = 'dbo'
        AND p.Procname &lt;&gt; s.obj</td>
        <td>191</td>
      </tr>
      <tr valign="top">
        <td colspan="1">Subquery</td>
        <td colspan="1">(SELECT MIN(SPID)
 FROM   master..sysprocesses AS s
 WHERE  (s.cmd &lt;&gt; 'AWAITING COMMAND'
         AND s.cmd NOT LIKE '%BACKUP%'
         AND s.cmd NOT LIKE '%RESTORE%')
        AND lastwaittype NOT IN ('SLEEP')
        AND s.spid &gt; 50
        AND s.spid &lt;&gt; @@spid
        AND SPID &gt; @SPID)</td>
        <td>174</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">REPLACE</td>
        <td colspan="1">replace(replace(replace(ProcName, '[', ''), ']', ''), db + '.', '')</td>
        <td>198</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">replace(replace(ProcName, '[', ''), ']', '')</td>
        <td>198</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">replace(ProcName, '[', '')</td>
        <td>198</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">replace(ProcName, 'exec dbo.', '')</td>
        <td>200</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">replace(replace(ProcName, '@', ''), '(', '')</td>
        <td>217</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">replace(ProcName, '@', '')</td>
        <td>217</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">replace(ProcName, 'dbo.', '')</td>
        <td>218</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">replace(ProcName, 'exec ', '')</td>
        <td>219</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">replace(procname, CHAR(10), '')</td>
        <td>222</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">replace(procname, CHAR(13), '')</td>
        <td>223</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">replace(procname, CHAR(0), '')</td>
        <td>224</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">replace(procname, '"', '')</td>
        <td>235</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CHARINDEX</td>
        <td colspan="1">CHARINDEX(@OpenVal, ProcName)</td>
        <td>207</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CHARINDEX(@CloseVal, ProcName, CHARINDEX(@OpenVal, ProcName))</td>
        <td>207</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CHARINDEX(@OpenVal, ProcName)</td>
        <td>207</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CHARINDEX(@OpenVal, ProcName)</td>
        <td>207</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CHARINDEX(@CloseVal, ProcName)</td>
        <td>214</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CHARINDEX(@CloseVal, ProcName)</td>
        <td>228</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CHAR</td>
        <td colspan="1">CHAR(10)</td>
        <td>222</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CHAR(13)</td>
        <td>223</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CHAR(0)</td>
        <td>224</td>
      </tr>
      <tr valign="top">
        <td colspan="1">REVERSE</td>
        <td colspan="1">REVERSE(SUBSTRING(REVERSE(procname), 3, 255))</td>
        <td>232</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">REVERSE(procname)</td>
        <td>232</td>
      </tr>
      <tr valign="top">
        <td colspan="1">@@servername</td>
        <td colspan="1">@@servername</td>
        <td>241</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">CASE</td>
        <td colspan="1">CASE WHEN last_request_start_time = '1/1/1900' THEN -1 ELSE datediff(ss, last_request_start_time, getdate()) END</td>
        <td>243</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN blocked = spid THEN -1 ELSE blocked END</td>
        <td>246</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">CASE WHEN ProcName = SUBSTRING(SQLstatement, 1, 255) THEN '' ELSE ProcName END</td>
        <td>252</td>
      </tr>
    </table>
  </body>
</html>