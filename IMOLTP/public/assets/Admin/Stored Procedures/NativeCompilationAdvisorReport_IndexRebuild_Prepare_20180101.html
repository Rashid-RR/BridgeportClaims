<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <title>Native Compilation Advisor evaluation results for [Admin].[IndexRebuild_Prepare]</title>
  </head>
  <body>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 14pt;">
      <b>Native Compilation Advisor evaluation results for [Admin].[IndexRebuild_Prepare]</b>
    </p>
    <p STYLE="font-family: Verdana, Arial, sans-serif; font-size: 10pt;">
      <b>Report Date/Time:</b>1/1/2018 4:58 PM<br /></p>
    <table border="1" cellpadding="5" cellspacing="0" STYLE="font-family: Verdana, Arial, sans-serif; font-size: 9pt;">
      <tr style="background-color:Silver">
        <th colspan="1" align="center">Transact-SQL Element</th>
        <th align="center">Transact-SQL Code</th>
        <th align="center">Line Number</th>
      </tr>
      <tr valign="top">
        <td colspan="1">SET OPTION ON</td>
        <td colspan="1">SET NOCOUNT ON</td>
        <td>2</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">SET OPTION OFF</td>
        <td colspan="1">SET ANSI_WARNINGS OFF</td>
        <td>3</td>
      </tr>
      <tr valign="top">
        <td colspan="1">OBJECT_ID</td>
        <td colspan="1">OBJECT_ID('IndexRebuildConfig')</td>
        <td>42</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">OBJECT_ID('tempdb..##IndexRebuild_CalculateFragmentation')</td>
        <td>241</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">OBJECT_ID('tempdb..##IndexRebuild_CalculateFragmentation')</td>
        <td>388</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">Cursors</td>
        <td colspan="1">CURSOR
    FOR SELECT   name
        FROM     sys.databases
        WHERE    name NOT IN ('tempdb', 'model', 'ignite_repository')
                 AND state_desc = 'ONLINE'
                 AND is_read_only = 0
        ORDER BY name</td>
        <td>76</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">CURSOR
    FOR SELECT   databasename,
                 schemaname,
                 tablename,
                 objectid
        FROM     IndexRebuildConfig
        WHERE    IndexRebuildInclude IS NOT NULL
        ORDER BY databasename, schemaname, tablename</td>
        <td>269</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">FETCH CURSOR</td>
        <td colspan="1">FETCH NEXT FROM ACT_CURS INTO @db</td>
        <td>86</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM ACT_CURS INTO @db</td>
        <td>127</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM ACT_CURS INTO @db, @schemaname, @tablename, @objectid</td>
        <td>275</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">FETCH NEXT FROM ACT_CURS INTO @db, @schemaname, @tablename, @objectid</td>
        <td>327</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">@@fetch_status</td>
        <td colspan="1">@@fetch_status</td>
        <td>87</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@fetch_status</td>
        <td>276</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">EXECUTE string</td>
        <td colspan="1">EXECUTE (@sql)</td>
        <td>123</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">EXECUTE (@SQL)</td>
        <td>324</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">One-part names</td>
        <td colspan="1">IndexRebuildConfig</td>
        <td>138</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig</td>
        <td>148</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig</td>
        <td>157</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig</td>
        <td>166</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">i</td>
        <td>177</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig AS i</td>
        <td>179</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">i</td>
        <td>186</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig AS i</td>
        <td>188</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">i</td>
        <td>195</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig AS i</td>
        <td>197</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfigOverride AS o</td>
        <td>197</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">i</td>
        <td>203</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig AS i</td>
        <td>205</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfigOverride AS o</td>
        <td>205</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig</td>
        <td>210</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">i</td>
        <td>216</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig AS i</td>
        <td>217</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">indexrebuildlog</td>
        <td>219</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig</td>
        <td>228</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig</td>
        <td>270</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildLog</td>
        <td>335</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">##IndexRebuild_CalculateFragmentation AS i</td>
        <td>346</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig AS a</td>
        <td>347</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildLog</td>
        <td>354</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">##IndexRebuild_CalculateFragmentation AS i</td>
        <td>365</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig AS a</td>
        <td>366</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">a</td>
        <td>372</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">indexrebuildlog AS i</td>
        <td>374</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig AS a</td>
        <td>374</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig</td>
        <td>380</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildLog</td>
        <td>400</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig</td>
        <td>411</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildLog</td>
        <td>420</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">[IndexRebuildLog]</td>
        <td>429</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">a</td>
        <td>435</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildLog AS i</td>
        <td>436</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig AS a</td>
        <td>437</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">[IndexRebuildLog]</td>
        <td>445</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">i</td>
        <td>453</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">[IndexRebuildLog] AS i</td>
        <td>454</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildConfig AS a</td>
        <td>454</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">IndexRebuildLog</td>
        <td>463</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">UPDATE with FROM clause</td>
        <td colspan="1">
FROM IndexRebuildConfig AS i</td>
        <td>179</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">
FROM IndexRebuildConfig AS i</td>
        <td>188</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">
FROM IndexRebuildConfig AS i
     INNER JOIN
     IndexRebuildConfigOverride AS o
     ON i.DatabaseName = o.DatabaseName
        AND i.SchemaName = o.SchemaName
        AND i.TableName = o.TableName</td>
        <td>197</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">
FROM IndexRebuildConfig AS i
     INNER JOIN
     IndexRebuildConfigOverride AS o
     ON i.DatabaseName = o.DatabaseName
        AND i.SchemaName = o.SchemaName
        AND i.TableName = o.TableName</td>
        <td>205</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">
FROM IndexRebuildConfig AS i
     INNER JOIN
     (SELECT   databasename,
               schemaname,
               tablename,
               AVG(DATEdiff(ss, startdate, ISNULL(enddate, startdate))) AS AvgSecondsToRebuild
      FROM     indexrebuildlog
      WHERE    ErrorFlag = 0
      GROUP BY databasename, schemaname, tablename) AS x
     ON i.DatabaseName = x.DatabaseName
        AND i.SchemaName = x.SchemaName
        AND i.TableName = x.TableName</td>
        <td>217</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">
FROM indexrebuildlog</td>
        <td>219</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">
FROM indexrebuildlog AS i
     INNER JOIN
     IndexRebuildConfig AS a
     ON i.DatabaseName = a.DatabaseName
        AND i.SchemaName = a.SchemaName
        AND i.TableName = a.tablename</td>
        <td>374</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">
FROM sys.databases AS d
     INNER JOIN
     IndexRebuildLog AS i
     ON d.name = i.databasename
        AND SessionDT = @SessionDT
     INNER JOIN
     IndexRebuildConfig AS a
     ON i.DatabaseName = a.DatabaseName
        AND i.SchemaName = a.SchemaName
        AND i.TableName = a.tablename</td>
        <td>436</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">
FROM [IndexRebuildLog] AS i
     INNER JOIN
     IndexRebuildConfig AS a
     ON i.DatabaseName = a.DatabaseName
        AND i.SchemaName = a.SchemaName
        AND i.TableName = a.tablename</td>
        <td>454</td>
      </tr>
      <tr valign="top">
        <td colspan="1">Subquery</td>
        <td colspan="1">(SELECT   databasename,
          schemaname,
          tablename,
          AVG(DATEdiff(ss, startdate, ISNULL(enddate, startdate))) AS AvgSecondsToRebuild
 FROM     indexrebuildlog
 WHERE    ErrorFlag = 0
 GROUP BY databasename, schemaname, tablename) AS x</td>
        <td>218</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1">DB_ID</td>
        <td colspan="1">DB_ID(@db)</td>
        <td>315</td>
      </tr>
      <tr valign="top">
        <td colspan="1">LIKE</td>
        <td colspan="1">@@VERSION LIKE '%enterprise%'</td>
        <td>426</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@VERSION LIKE '%Developer%'</td>
        <td>426</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@VERSION NOT LIKE '%enterprise%'</td>
        <td>443</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@VERSION NOT LIKE '%Developer%'</td>
        <td>443</td>
      </tr>
      <tr valign="top">
        <td colspan="1">@@version</td>
        <td colspan="1">@@VERSION</td>
        <td>426</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@VERSION</td>
        <td>426</td>
      </tr>
      <tr valign="top">
        <td colspan="1"></td>
        <td colspan="1">@@VERSION</td>
        <td>443</td>
      </tr>
      <tr valign="top" style="background-color:LightYellow">
        <td colspan="1"></td>
        <td colspan="1">@@VERSION</td>
        <td>443</td>
      </tr>
      <tr valign="top">
        <td colspan="1">REPLACE</td>
        <td colspan="1">REPLACE(sql, 'ONLINE = ON', 'ONLINE = off')</td>
        <td>453</td>
      </tr>
    </table>
  </body>
</html>